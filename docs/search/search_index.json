{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Retrospective Analysis: From 5 Monolithic Pipelines to 4-Layer Architecture","text":"What I did Transformed 5 monolithic pipelines (41% duplication) into 4-layer architecture with centralized libraries How it emerged Felt the pain \u2192 organized by domain naturally \u2192 patterns emerged Post-analysis Mapped my solution to industry concepts (Software Smells, DDD patterns, GoF Design Patterns) Documentation Problem analysis, pattern identification, architecture rationale <p>Note on 37% vs 41%: If you came from my resume, you may have seen \"37% duplication.\" That figure was from an earlier baseline (<code>54479b2</code>, 2025-02-21). After detailed commit history analysis, <code>74fc356</code> (2025-03-20) was identified as the accurate \"before refactoring\" state, showing 41% duplication. The increase itself demonstrates the architecture's High Viscosity problem.</p>"},{"location":"#purpose","title":"Purpose","text":"<p>This portfolio is a post-refactoring analysis of intuitive problem-solving done during VARLab Co-op.</p> What I Did What This Document Does Refactored 5 monolithic pipelines into 4-Layer Architecture Classify and define those intuitive fixes using industry conventions Designed 3-Level Logger System Analyze why the design worked and how it integrates with the architecture <p>Goal: Transform experience-based understanding into systematic, reusable knowledge</p> <ul> <li>Learn how problems I \"felt\" are formally named (Software Smells, Anti-patterns)</li> <li>Validate solutions against established principles (SOLID, Design Patterns)</li> <li>Understand integration points that made the Logger System possible</li> </ul>"},{"location":"#if-i-had-this-analysis-then","title":"If I Had This Analysis Then...","text":""},{"location":"#before-during-refactoring","title":"Before (During Refactoring)","text":"<p>When I proposed this refactoring to my supervisor, I could only say:</p> <p>\"The code is messy. There's a lot of copy-paste. It's hard to maintain. I think we should restructure it.\"</p> <p>I knew something was wrong. I felt the pain every time I had to modify multiple files for a single change. But I couldn't articulate why it was problematic or how bad it actually was.</p>"},{"location":"#after-with-this-analysis","title":"After (With This Analysis)","text":"<p>If I had this analysis back then, I could have presented:</p> <p>\"We have 41% code duplication across 5 pipelines. A single change to <code>sendBuildStatus</code> requires modifications in 18 locations across 6 files. We're making 113 external calls to 12 different systems with no abstraction layer, making the code untestable. In the past month alone, duplication increased from 37% to 41%, showing the architecture's High Viscosity is causing duplication to grow naturally.\"</p> <p>Instead of \"it feels messy,\" I could have shown concrete numbers. Instead of \"it's hard to maintain,\" I could have explained Shotgun Surgery with specific examples. Instead of \"we should fix it,\" I could have demonstrated the ROI degradation where 10-minute tasks were taking hours.</p>"},{"location":"#the-difference","title":"The Difference","text":"Aspect Before After Problem Description \"Code is messy\" \"41% duplication, 18-location Shotgun Surgery\" Justification \"I feel it's hard to maintain\" \"Duplication increased 4% in 1 month (High Viscosity)\" Scope \"A lot of copy-paste\" \"113 external calls, 12 types, untestable\" Urgency \"We should fix it sometime\" \"10-20 min tasks \u2192 hours, ROI degradation\" <p>This analysis transforms intuition into evidence. It provides the vocabulary and metrics needed to communicate technical debt to stakeholders who may not see the code daily.</p>"},{"location":"#what-would-you-like-to-know","title":"What Would You Like to Know?","text":""},{"location":"#problem-analysis","title":"\ud83d\udd0d Problem Analysis","text":"<p>Q: Want to see how I analyzed a single file?</p> <p>Example: generalHelper Analysis</p> <ul> <li>SRP Violation Analysis</li> <li>Software Smells Analysis</li> <li>Design Smells Analysis</li> </ul> <p>Analysis flow: Define SRP criteria \u2192 Analyze responsibility per function/module \u2192 Identify Software Smells</p> <p>Q: Want the overall problem analysis summary?</p> <p>\u2192 problem-analysis-overview.md</p> <p>Q: Want the detailed analysis?</p> <ul> <li>detailed-analysis.md - Synthesized findings (Symptoms, Patterns, Duplication)</li> <li>architecture-smells-analysis.md - System-level analysis</li> <li>DRY-violation-analysis.md - Cross-file duplication patterns</li> </ul>"},{"location":"#solution","title":"\ud83d\udee0\ufe0f Solution","text":"<p>Q: Want to see the final architecture and solution overview?</p> <p>\u2192 solution-overview.md</p> <p>Q: Want to know which design principles were applied?</p> <p>\u2192 solution-by-layer.md - 4-Layer Architecture analysis \u2192 solution-by-feature.md - Logger System, Shell Libraries analysis</p> <p>Q: Want the step-by-step implementation process?</p> <p>\u2192 solution-overview.md - Phase 0~4 overview with links \u2192 phase-0~4/ - Detailed changelogs by commit</p>"},{"location":"#supplement","title":"\ud83d\udcc4 Supplement","text":"<p>Q: Want the DDD perspective analysis?</p> <p>\u2192 domain-driven-analysis.md</p> <p>Q: Want to see the Pull Request documentation?</p> <p>\u2192 pull-request-documentation.pdf</p>"},{"location":"#project-overview","title":"Project Overview","text":""},{"location":"#background","title":"Background","text":"<ul> <li>14 months of accumulated Technical Debt</li> <li>5 monolithic pipelines (41% duplication, untestable)</li> <li>Discovered Jenkins Global Trusted Shared Library feature at month 13</li> <li>Performed refactoring over 54 days (Library setup 35 days, Core refactoring ~2 weeks)</li> </ul>"},{"location":"#timeline","title":"Timeline","text":"Milestone Date Commit Repository Initial commit (Windows) 2023-12-17 <code>e9d8028</code> devops-jenkins-windows Migration to Linux 2025-01-07 <code>5a59d45</code> devops-jenkins-linux Baseline (Before refactoring) 2025-03-20 <code>74fc356</code> devops-jenkins-linux Technical Debt Period ~14 months Refactoring complete 2025-05-12 <code>ff74ac8</code> devops-jenkins-linux <p>Repository started in Windows environment and migrated to Linux. Initial commit (2023-12-17) \u2192 Baseline (2025-03-20) = ~14 months of accumulated Technical Debt</p>"},{"location":"#document-structure","title":"Document Structure","text":"<pre><code>retrospective-analysis-from-5-monolithic-pipelines-to-4-layer-architecture/\n\u2502\n\u251c\u2500\u2500 README.md                           # \u2190 This document (entry point)\n\u2502\n\u251c\u2500\u2500 problem-analysis/                   # Problem Analysis\n\u2502   \u251c\u2500\u2500 problem-analysis-overview.md    # Problem summary (\u2605 Start here)\n\u2502   \u251c\u2500\u2500 detailed-analysis.md            # Synthesized findings\n\u2502   \u251c\u2500\u2500 architecture-smells-analysis.md # System-level analysis\n\u2502   \u251c\u2500\u2500 DRY-violation-analysis.md       # Cross-file duplication\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 01-generalHelper/               # Per-file analysis\n\u2502   \u2502   \u251c\u2500\u2500 01-srp-violation-analysis.md\n\u2502   \u2502   \u251c\u2500\u2500 02-software-smells-analysis.md\n\u2502   \u2502   \u2514\u2500\u2500 03-design-smells-symptoms.md\n\u2502   \u251c\u2500\u2500 02-jsHelper/\n\u2502   \u251c\u2500\u2500 03-unityHelper/\n\u2502   \u251c\u2500\u2500 04~08-Jenkinsfiles/\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 pipeline-sequence-diagrams/     # Pipeline flow analysis\n\u2502       \u251c\u2500\u2500 domain-mapping.md\n\u2502       \u2514\u2500\u2500 dlx-ci.md, dlx-cd.md, js-ci.md, js-cd.md, jenkins-ci.md\n\u2502\n\u251c\u2500\u2500 problem-solving/                    # Solution\n\u2502   \u251c\u2500\u2500 solution-overview.md            # Entry point for solution docs\n\u2502   \u251c\u2500\u2500 solution-by-layer.md            # 4-Layer Architecture analysis\n\u2502   \u251c\u2500\u2500 solution-by-feature.md          # Logger System, Shell Libraries\n\u2502   \u251c\u2500\u2500 logger-system-design-integration.md  # Logger design document\n\u2502   \u251c\u2500\u2500 domain-driven-analysis.md       # DDD analysis (supplement)\n\u2502   \u251c\u2500\u2500 pull-request-documentation.pdf  # PR attachment\n\u2502   \u2514\u2500\u2500 phase-0~4/                      # Step-by-step changelogs\n\u2502\n\u2514\u2500\u2500 resources/                          # Images\n    \u2514\u2500\u2500 architecture-overview.png, stage-logger-*.png\n</code></pre>"},{"location":"#reference","title":"Reference","text":"<ul> <li>Jenkins Shared Libraries Documentation</li> </ul>"},{"location":"problem-analysis/DRY-violation-analysis/","title":"DRY Violation Analysis","text":""},{"location":"problem-analysis/DRY-violation-analysis/#table-of-contents","title":"Table of Contents","text":"<ul> <li>DRY Principle Definition</li> <li>Analysis Results</li> <li>All Pipeline Common</li> <li>CI vs CD Comparison</li> <li>CI Pipeline Comparison</li> <li>CD Pipeline Comparison</li> <li>JS CD Internal Duplication</li> <li>Helper File Comparison</li> <li>Related Concepts</li> </ul>"},{"location":"problem-analysis/DRY-violation-analysis/#1-dry-principle-definition","title":"1. DRY Principle Definition","text":"<p>\"Every piece of knowledge must have a single, unambiguous, authoritative representation within a system.\" \u2014 Hunt &amp; Thomas, The Pragmatic Programmer (1999)</p>"},{"location":"problem-analysis/DRY-violation-analysis/#analysis-method","title":"Analysis Method","text":"<p>Duplication patterns are identified using a top-down comparison approach.</p> # Comparison Scope Analysis Purpose 1 All pipelines (5) Patterns commonly used across all pipelines 2 CI vs CD Distinguish CI-only / CD-only / common patterns 3 Between CI pipelines (DLX CI, JS CI, Jenkins CI) Duplication between CI pipelines 4 Between CD pipelines (DLX CD, JS CD) Duplication between CD pipelines 5 Within CD (JS CD) Internal duplication within single pipeline 6 Between Helper files Function/logic duplication between Helper files"},{"location":"problem-analysis/DRY-violation-analysis/#dry-violation-summary","title":"DRY Violation Summary","text":"Type Violation Severity Impact Inter-Helper duplication <code>logMessage()</code> identical function copy Medium Logging changes require 2 modifications Jenkinsfile duplication <code>parameters</code> block 7 identical parameters High Parameter addition/changes require 5 modifications Jenkinsfile duplication <code>triggers.GenericTrigger</code> block High Trigger changes require 5 modifications Jenkinsfile duplication <code>environment</code> block structure Medium Environment variable pattern changes require 5 modifications Jenkinsfile duplication <code>post</code> block structure High Build status handling changes require 5 modifications Jenkinsfile duplication <code>buildResults</code>/<code>stageResults</code> extraction Medium Status value changes require 5 modifications Inter-CI duplication <code>Prepare WORKSPACE</code> stage logic High Initialization logic changes require 3 modifications CI + CD duplication Static Analysis (SonarQube) pattern Medium SonarQube setting changes require 3 modifications Inter-CD duplication <code>mainBranches</code> constant Low Branch policy changes require 2 modifications JS CD internal duplication Server/Client deployment logic High Deployment method changes require 2 modifications"},{"location":"problem-analysis/DRY-violation-analysis/#2-analysis-results","title":"2. Analysis Results","text":""},{"location":"problem-analysis/DRY-violation-analysis/#21-all-pipeline-common-5","title":"2.1. All Pipeline Common (5)","text":"Duplication Pattern Location Separated <code>parameters</code> block (7 identical parameters) 5 Jenkinsfiles \u274c <code>triggers.GenericTrigger</code> block 5 Jenkinsfiles \u274c <code>environment</code> block structure (<code>CI_PIPELINE</code>, <code>PROJECT_TYPE</code>, <code>PROJECT_DIR</code>, <code>REPORT_DIR</code>, etc.) 5 Jenkinsfiles \u274c <code>post</code> block (always/success/failure/aborted) 5 Jenkinsfiles \u274c <code>buildResults</code>/<code>stageResults</code> extraction pattern 5 Jenkinsfiles \u274c <code>generalUtil</code> load pattern 5 Jenkinsfiles \u274c <code>COMMIT_HASH</code> extraction logic 5 Jenkinsfiles \u274c <code>currentBuild.description</code> setting 5 Jenkinsfiles \u274c"},{"location":"problem-analysis/DRY-violation-analysis/#22-ci-vs-cd-comparison","title":"2.2. CI vs CD Comparison","text":"Type CI-only CD-only Common (Not Separated) Trigger <code>regexpFilterExpression: 'OPEN'</code> <code>regexpFilterExpression: 'MERGED'</code> Rest of trigger structure identical Environment Variables <code>CI_PIPELINE = true</code> <code>CI_PIPELINE = false</code> Rest of environment variable pattern identical Stage Linting, Tests, Coverage, Static Analysis Delete Branch, Deploy Build Prepare Workspace, Build Post <code>sendBuildStatus(false)</code> pattern <code>sendBuildStatus(true)</code> pattern Overall structure identical"},{"location":"problem-analysis/DRY-violation-analysis/#23-ci-pipeline-comparison-dlx-ci-vs-js-ci-vs-jenkins-ci","title":"2.3. CI Pipeline Comparison (DLX CI vs JS CI vs Jenkins CI)","text":"Duplication Pattern DLX CI JS CI Jenkins CI Separated <code>Prepare WORKSPACE</code> stage structure \u2713 \u2713 \u2713 \u274c <code>isBranchUpToDateWithRemote</code> check \u2713 \u2713 \u2713 \u274c <code>initializeEnvironment</code> call \u2713 \u2713 \u2713 \u274c <code>cloneOrUpdateRepo</code> call \u2713 \u2713 \u2713 \u274c <code>mergeBranchIfNeeded</code> call \u2713 \u2713 - \u274c Linting stage \u2713 \u2713 \u2713 (Groovy) \u274c Static Analysis (SonarQube) - \u2713 \u2713 \u274c <p>Differences: - DLX CI: Unity-specific (<code>unityUtil</code>), EditMode/PlayMode tests - JS CI: Node.js-specific (<code>jsUtil</code>), npm dependency installation - Jenkins CI: Groovy-specific, Groovydoc generation, Gradle tests</p>"},{"location":"problem-analysis/DRY-violation-analysis/#24-cd-pipeline-comparison-dlx-cd-vs-js-cd","title":"2.4. CD Pipeline Comparison (DLX CD vs JS CD)","text":"Duplication Pattern DLX CD JS CD Separated <code>mainBranches = ['main', 'master']</code> \u2713 \u2713 \u274c <code>Delete Merged Branch</code> stage \u2713 \u2713 \u274c <code>cleanUpPRBranch</code> call \u2713 \u2713 \u2713 (Helper) Static Analysis (SonarQube) pattern - \u2713 \u274c <p>Deployment Method Differences: - DLX CD: SSH/SCP-based WebDAV server deployment - JS CD: Docker \u2192 Azure Container Registry \u2192 Container Apps deployment</p>"},{"location":"problem-analysis/DRY-violation-analysis/#25-js-cd-internal-duplication-serverclient-deployment","title":"2.5. JS CD Internal Duplication (Server/Client Deployment)","text":"<p>Server and Client deployment logic is repeated with almost identical patterns within the JS CD pipeline.</p> Duplication Pattern Server Build (line 242-317) Client Build (line 319-392) Separated <code>az acr repository show-tags</code> call \u2713 \u2713 \u274c <code>jsUtil.getPackageJsonVersion()</code> call line 268 line 343 \u274c <code>jsUtil.versionCompare()</code> check line 277 line 352 \u274c <code>docker build</code> command line 287-291 line 362-366 \u274c <code>docker push</code> command line 295-298 line 370-373 \u274c <code>az containerapp update</code> command line 302-307 line 377-382 \u274c <code>docker rmi</code> cleanup line 311 line 386 \u274c <p>Impact: Deployment logic changes require modifications in both Server/Client locations</p>"},{"location":"problem-analysis/DRY-violation-analysis/#26-helper-file-comparison","title":"2.6. Helper File Comparison","text":"<p>GeneralHelper vs JsHelper</p> Duplicated Function GeneralHelper JsHelper Note <code>logMessage()</code> line 35-44 line 7-16 Identical copy <p>GeneralHelper vs UnityHelper</p> Duplication Pattern GeneralHelper UnityHelper Note Direct duplication - - No function duplication Dependency - <code>generalUtil</code> load UnityHelper depends on GeneralHelper"},{"location":"problem-analysis/DRY-violation-analysis/#related-concepts","title":"Related Concepts","text":"Concept Source Relationship Duplicated Code Fowler (1999) Code Smells Code Smell expression of DRY violation Shotgun Surgery Fowler (1999) Code Smells Result of DRY violation (1 change \u2192 N modifications) Needless Repetition Martin (2000) Design Symptoms Design Symptom expression of DRY violation"},{"location":"problem-analysis/architecture-smells-analysis/","title":"Architecture Smells Analysis","text":"<p>Source: Garcia et al., Lippert &amp; Roock, Sharma</p> <p>Context: System-level structural issues affecting maintainability, evolution, and deployment.</p>"},{"location":"problem-analysis/architecture-smells-analysis/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Considered Architecture Smells</li> <li>Garcia et al. (Connector/Component Perspective)</li> <li>Lippert &amp; Roock (Symptom-Based)</li> <li>Sharma (Dependency Perspective)</li> <li>Applied Architecture Smells Analysis</li> <li>Hub-like Dependency</li> <li>Scattered Functionality</li> <li>Implicit Cross-module Dependency</li> <li>References</li> </ul>"},{"location":"problem-analysis/architecture-smells-analysis/#1-considered-architecture-smells","title":"1. Considered Architecture Smells","text":""},{"location":"problem-analysis/architecture-smells-analysis/#11-garcia-et-al-connectorcomponent-perspective","title":"1.1 Garcia et al. (Connector/Component Perspective)","text":"Type Issue Type Description Applicable Reason Connector Envy Structure Components handle communication logic that should be in a dedicated connector \u2717 No connector concept in Jenkins Pipeline Extraneous Connector Structure Two components communicate through a connector when direct call suffices \u2717 Same as above Ambiguous Interface Structure Interface offers only single, overly general entry point \u2717 Weak interface concept in Helper functions"},{"location":"problem-analysis/architecture-smells-analysis/#12-lippert-roock-symptom-based","title":"1.2 Lippert &amp; Roock (Symptom-Based)","text":"Type Issue Type Description Applicable Reason Cyclic Dependency Dependency Components/Packages form a dependency cycle \u2713 Sequence diagram analysis confirms unidirectional dependencies only Unstable Dependency Dependency Stable component depends on less stable component \u2717 No change frequency data available <p>Cyclic Dependency Analysis Method: Jenkins Pipeline is procedural code, so call flow was traced via sequence diagrams. Analysis confirms <code>Jenkinsfile \u2192 Helper \u2192 External (Python/CLI)</code> unidirectional dependencies only. No inter-Helper dependencies found.</p> <p>See: pipeline-sequence-diagrams/domain-mapping.md</p>"},{"location":"problem-analysis/architecture-smells-analysis/#13-sharma-dependency-perspective","title":"1.3 Sharma (Dependency Perspective)","text":"Type Issue Type Description Applicable Reason Hub-like Dependency Dependency Component with too many incoming/outgoing dependencies \u2713 generalHelper \u2192 all 5 pipelines depend on it Scattered Functionality Structure Single concern implemented across multiple components \u2713 Same functionality scattered across helper and inline Dense Structure Structure Dependency graph is too dense \u2717 Density measurement meaningless with only 8 files Implicit Cross-module Dependency Dependency Hidden dependencies not visible in architecture \u2713 Python scripts, env vars, Jenkins APIs <p>Note: Hub-like Dependency is classified as Design Smell (class level) in Sharma's taxonomy. However, in Jenkins Pipeline context, Helper files serve as core system components, so it is included in Architecture level analysis.</p>"},{"location":"problem-analysis/architecture-smells-analysis/#2-applied-architecture-smells-analysis","title":"2. Applied Architecture Smells Analysis","text":""},{"location":"problem-analysis/architecture-smells-analysis/#21-hub-like-dependency","title":"2.1 Hub-like Dependency","text":"<p>Data Sources:</p> Component Source Extracted Data Pipelines Pipeline Sequence Diagrams Call counts extracted from Delegation Pattern tables generalHelper Software Smells Analysis (Hub-like Modularization) Existing count data used jsHelper jsHelper.groovy source code External calls counted directly unityHelper unityHelper.groovy source code External calls counted directly <p>Incoming Dependencies (Pipeline \u2192 Helper):</p> Pipeline generalHelper jsHelper unityHelper Total DLX CI 5 - 5 10 DLX CD 3 - 4 7 JS CI 6 4 - 10 JS CD 3 6 - 9 Jenkins CI 4 - - 4 Total 21 10 9 40 <p>Outgoing Dependencies (Helper \u2192 External):</p> External Type generalHelper jsHelper unityHelper Git CLI 18 - - Linux CLI 11 3 1 SSH 6 - - SCP 4 - - Python 2 1 4 SonarQube API 2 - - Node.js CLI - 2 - npm CLI - 6 - Unity CLI - - 1 Unity Hub CLI - - 2 Total Calls 43 12 8 Total Types 6 4 4 <p>Dependency Diagram:</p> <p>Numbers on edges represent call counts. Solid lines (\u2192) indicate calls through Helper, dashed lines (\u21e2) indicate direct External calls. <pre><code>flowchart LR\n    subgraph Pipelines\n        DLX_CI[DLX CI]\n        DLX_CD[DLX CD]\n        JS_CI[JS CI]\n        JS_CD[JS CD]\n        Jenkins_CI[Jenkins CI]\n    end\n\n    subgraph Helpers\n        GH[generalHelper&lt;br/&gt;21 calls in]\n        JH[jsHelper&lt;br/&gt;10 calls in]\n        UH[unityHelper&lt;br/&gt;9 calls in]\n    end\n\n    subgraph External\n        Git[Git CLI]\n        Python[Python Scripts]\n        SSH[SSH/SCP]\n        SonarQube[SonarQube]\n        npm[npm CLI]\n        Unity[Unity CLI]\n        Docker[Docker CLI]\n        Azure[Azure CLI]\n    end\n\n    %% Pipeline \u2192 Helper\n    DLX_CI --&gt;|5| GH\n    DLX_CI --&gt;|5| UH\n    DLX_CD --&gt;|3| GH\n    DLX_CD --&gt;|4| UH\n    JS_CI --&gt;|6| GH\n    JS_CI --&gt;|4| JH\n    JS_CD --&gt;|3| GH\n    JS_CD --&gt;|6| JH\n    Jenkins_CI --&gt;|4| GH\n\n    %% Helper \u2192 External\n    GH --&gt;|18| Git\n    GH --&gt;|10| SSH\n    GH --&gt;|2| Python\n    GH --&gt;|2| SonarQube\n    JH --&gt;|6| npm\n    JH --&gt;|1| Python\n    UH --&gt;|4| Python\n    UH --&gt;|3| Unity\n\n    %% Pipeline \u2192 External (Direct)\n    DLX_CD -.-&gt;|4| Git\n    DLX_CD -.-&gt;|8| SSH\n    JS_CD -.-&gt;|4| Git\n    JS_CD -.-&gt;|8| Docker\n    JS_CD -.-&gt;|8| Azure</code></pre></p> <p>Analysis: - <code>generalHelper</code>: All 5 pipelines depend on it (100%), 43 outgoing calls to 6 external types \u2192 Hub - <code>jsHelper</code>, <code>unityHelper</code>: Only 2 pipelines each depend on them, 12/8 outgoing calls to 4 types - Dashed lines: Pipeline \u2192 External direct calls (Helper bypass) \u2192 inconsistent abstraction</p>"},{"location":"problem-analysis/architecture-smells-analysis/#22-scattered-functionality","title":"2.2 Scattered Functionality","text":"<p>Data Sources:</p> Source Extracted Data Pipeline Sequence Diagrams Pipeline Comparison tables <p>Evidence:</p> Concern Implementation Location Issue Git operations generalHelper (CI) vs Jenkinsfile direct calls (CD) Same functionality, different implementation Build status sending Via <code>initializeEnvironment</code> (CI) vs direct <code>sendBuildStatus</code> call (CD) Same functionality, different call pattern Bitbucket reporting unityHelper (<code>sendTestReport</code>), Jenkinsfile direct Python calls Same domain, scattered across multiple locations Web Server deployment generalHelper (CI) vs Jenkinsfile direct SSH/SCP (CD) Same functionality, different implementation <p>Analysis: - Same concern implemented differently depending on CI/CD pipeline type - Changes require modifications in multiple locations \u2192 triggers Shotgun Surgery</p>"},{"location":"problem-analysis/architecture-smells-analysis/#23-implicit-cross-module-dependency","title":"2.3 Implicit Cross-module Dependency","text":"<p>Data Sources:</p> Source Extracted Data 2.1 Hub-like Dependency Dependency Diagram, Outgoing Dependencies table Pipeline Sequence Diagrams Delegation Pattern tables (direct External calls) Helper source code Environment variable usage list <p>Hidden Dependencies via <code>sh</code> calls:</p> <p>All External calls are made through <code>sh</code> command. Dependencies only revealed at runtime without <code>import</code> in Groovy code.</p> Source External Types Total Calls Helpers 10 63 Pipelines (direct) 10 50 Total - 113 <p>Hidden Dependencies via Environment Variables:</p> Environment Variable Used In Set In <code>WORKSPACE</code> jsHelper Jenkins (automatic) <code>COMMIT_HASH</code> jsHelper Jenkinsfile <code>PR_BRANCH</code> unityHelper Jenkinsfile <code>CI_PIPELINE</code> unityHelper Jenkinsfile <code>SSH_KEY</code> generalHelper Jenkins credentials <code>DLX_WEB_HOST_URL</code> generalHelper Jenkins configuration <code>UNITY_EXECUTABLE</code> unityHelper Jenkinsfile <code>PROJECT_DIR</code> unityHelper Jenkinsfile <code>REPORT_DIR</code> unityHelper Jenkinsfile <code>BUILD_URL</code> unityHelper Jenkins (automatic) <p>Analysis: - All 113 external calls are implicit dependencies via <code>sh</code> - Cannot determine required external tools by reading Helper code alone - Tracing environment variable origins requires examining Jenkinsfile</p>"},{"location":"problem-analysis/architecture-smells-analysis/#references","title":"References","text":"<ul> <li>Architecture Smells (T. Sharma Preprint)</li> <li>Does your Architecture Smell? (Designite)</li> </ul>"},{"location":"problem-analysis/detailed-analysis/","title":"Detailed Analysis","text":"<p>Cross-category patterns and system-wide analysis derived from individual component analyses.</p>"},{"location":"problem-analysis/detailed-analysis/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Analysis Methodology</li> <li>Chapter 1: Common Symptoms by Category</li> <li>Helper Common Symptoms</li> <li>Jenkinsfile Common Symptoms</li> <li>Chapter 2: Cross-Category Patterns</li> <li>Abstraction Inconsistency</li> <li>Shotgun Surgery Locations</li> <li>Chapter 3: System-wide Patterns</li> <li>Pipeline Duplication Analysis</li> <li>Chapter 4: Why Untestable?</li> <li>References</li> </ul>"},{"location":"problem-analysis/detailed-analysis/#analysis-methodology","title":"Analysis Methodology","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    DATA COLLECTION                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  pipeline-sequence-diagrams     SRP Analysis      Helper Call   \u2502\n\u2502  (procedural \u2192 domain)          (reasons for     Frequency      \u2502\n\u2502                                  change per                      \u2502\n\u2502                                  function)                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n               \u2502                     \u2502                 \u2502\n               \u25bc                     \u25bc                 \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    INDIVIDUAL FILE ANALYSIS                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Concepts: Fowler's Code Smells + Suryanarayana's Design Smells \u2502\n\u2502  Output: 01-08 individual analyses                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    DESIGN SYMPTOM IDENTIFICATION                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Concept: Martin's 7 Design Symptoms                             \u2502\n\u2502  Output: Per-file symptom evidence                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    SYSTEM-LEVEL ANALYSIS                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Architecture Smells + domain-mapping cross-comparison           \u2502\n\u2502  - Cross-pipeline duplication (by stage, by domain)              \u2502\n\u2502  - Shotgun Surgery locations                                     \u2502\n\u2502  - Abstraction inconsistency patterns                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"problem-analysis/detailed-analysis/#applied-concepts-principles","title":"Applied Concepts &amp; Principles","text":"Analysis Phase Concepts/Principles Data Collection Domain mapping from sequence diagrams, SRP analysis, Call frequency analysis Individual File Fowler's Code Smells, Suryanarayana's Design Smells (OOP-only excluded) Design Symptoms Martin's 7 Design Symptoms System-Level Architecture Smells, Cross-pipeline comparison"},{"location":"problem-analysis/detailed-analysis/#chapter-1-common-symptoms-by-category","title":"Chapter 1: Common Symptoms by Category","text":""},{"location":"problem-analysis/detailed-analysis/#11-helper-common-symptoms","title":"1.1 Helper Common Symptoms","text":"<p>Data Sources:</p> Component Source generalHelper 01-generalHelper/03-design-smells-symptoms.md jsHelper 02-jsHelper/03-design-smells-symptoms.md unityHelper 03-unityHelper/03-design-smells-symptoms.md <p>Summary:</p> Symptom generalHelper jsHelper unityHelper Rigidity High Low High Fragility High Low High Immobility High Medium Medium Viscosity Medium Medium High Needless Complexity - - - Needless Repetition High Medium High Opacity Medium Medium Medium <p>Common Patterns: - All 3 Helpers exhibit Rigidity and Needless Repetition - No Needless Complexity found (no over-engineering) - generalHelper most severe: 7 domains, highest Immobility - unityHelper highest Viscosity: Stage conditionals make proper design harder than copy-paste - jsHelper least severe overall</p>"},{"location":"problem-analysis/detailed-analysis/#12-jenkinsfile-common-symptoms","title":"1.2 Jenkinsfile Common Symptoms","text":"<p>Data Sources:</p> Component Source DLX CI 04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms.md DLX CD 05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms.md JS CI 06-JsJenkins-Jenkinsfile/03-design-smells-symptoms.md JS CD 07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms.md Jenkins CI 08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms.md <p>Summary:</p> Symptom DLX CI DLX CD JS CI JS CD Jenkins CI Rigidity High High High High Medium Fragility High High High High High Immobility High High High High High Needless Complexity - - Low - - Viscosity Medium High High High Medium Needless Repetition High High High High High Opacity Medium Medium High Medium High <p>Common Patterns: - All 5 Jenkinsfiles exhibit Immobility and Needless Repetition (High) - Needless Complexity nearly absent (only JS CI has commented-out code) - CD pipelines (DLX CD, JS CD) have higher Viscosity due to deployment pattern duplication - JS CI has highest Opacity due to undefined variable and 112-line Long Method - Jenkins CI has Opacity issue due to <code>catchError</code> parameter typo (potential bug)</p>"},{"location":"problem-analysis/detailed-analysis/#chapter-2-cross-category-patterns","title":"Chapter 2: Cross-Category Patterns","text":""},{"location":"problem-analysis/detailed-analysis/#21-abstraction-inconsistency","title":"2.1 Abstraction Inconsistency","text":"<p>Data Sources:</p> Source Extracted Data Pipeline Sequence Diagrams Pipeline Comparison tables <p>Evidence:</p> Function Helper Usage Direct Call Pipelines Git operations <code>cloneOrUpdateRepo</code> <code>git clone/checkout/reset/pull</code> CI vs CD Build status init <code>initializeEnvironment</code> <code>sendBuildStatus</code> direct CI vs CD Web Server <code>cleanMergedBranchFromWebServer</code> SSH/SCP direct DLX CD (same file) <p>Analysis: - Same functionality implemented differently between CI and CD pipelines - Even within same file (DLX CD), Web Server operations use both Helper and direct calls</p>"},{"location":"problem-analysis/detailed-analysis/#22-shotgun-surgery-locations","title":"2.2 Shotgun Surgery Locations","text":"<p>Data Sources:</p> Source Extracted Data 01-generalHelper/02-software-smells-analysis.md Cross-file Shotgun Surgery 03-unityHelper/02-software-smells-analysis.md Cross-file + Within-file Shotgun Surgery 04-08 Jenkinsfile analyses Within-file Shotgun Surgery <p>Cross-file (Helper signature change):</p> Change Trigger Affected Files Total Locations <code>sendBuildStatus</code> generalHelper + 5 Jenkinsfiles 18 <code>runUnityStage</code> unityHelper + 2 Jenkinsfiles 9 <code>parseJson</code> generalHelper + 5 Jenkinsfiles 10 <p>Within-file (Pattern duplication):</p> Change Trigger File Locations stageName/errorMsg DLX CI, DLX CD 9 Adding new Unity Stage unityHelper 7 Server/Client report pattern JS CI 6 Server/Client deploy pattern JS CD 4 Groovy/Jenkinsfile lint pattern Jenkins CI 4 <p>Analysis: - <code>sendBuildStatus</code> change requires 18 modifications across 6 files - Pattern duplication within Jenkinsfiles creates additional Shotgun Surgery risk</p>"},{"location":"problem-analysis/detailed-analysis/#chapter-3-system-wide-patterns","title":"Chapter 3: System-wide Patterns","text":""},{"location":"problem-analysis/detailed-analysis/#31-pipeline-duplication-analysis","title":"3.1 Pipeline Duplication Analysis","text":"<p>Data Sources:</p> Source Extracted Data Jenkinsfile source code DLX CI, DLX CD, JS CI, JS CD, Jenkins CI <p>Lines by Section:</p> Section DLX CI DLX CD JS CI JS CD Jenkins CI Total Boilerplate Variables 6 5 4 5 3 23 Tools 3 0 3 1 5 12 Parameters 11 9 10 8 10 48 Triggers 18 17 17 16 16 84 Environment 13 10 16 13 17 69 Post 22 22 22 26 22 114 Boilerplate Subtotal 73 63 72 69 73 350 Stages Delete Merged Branch - 28 - 26 - 54 Prepare WORKSPACE 53 36 35 30 33 187 Install Dependencies - - 16 16 - 32 Linting 43 24 12 12 67 158 EditMode Tests 18 17 - - - 35 PlayMode Tests 14 13 - - - 27 Unit Testing - - 82 14 - 96 Run Unit Tests - - - - 5 5 Publish Test Results - - - - 5 5 Code Coverage 24 - - - - 24 Build Project 30 14 - - - 44 Static Analysis - - 35 33 42 110 Check Build Condition - - - 24 - 24 Deploy Build - 32 - - - 32 Server Build and Deploy - - - 56 - 56 Client Build and Deploy - - - 56 - 56 Generate Groovydoc - - - - 28 28 Stages Subtotal 182 164 180 267 180 973 Total 255 227 252 336 253 1,323 <p>Duplication Analysis:</p> Comparison Common Lines Total Lines Duplication % All 5 Pipelines (Boilerplate + Prepare WORKSPACE) 537 1,323 41% DLX CI vs DLX CD 398 482 83% JS CI vs JS CD 426 588 72% <p>Note: - Includes Stages and Boilerplate that exist across pipelines. - Includes sections that can be abstracted into one, even if not completely identical.</p> <p>Code Duplication Trend:</p> Baseline Commit Date Duplication % Earlier analysis <code>54479b2</code> 2025-02-21 37% Current analysis <code>74fc356</code> 2025-03-20 41% <ul> <li>Duplication increased from 37% to 41% within approximately 1 month</li> <li>Structural issues cause duplication to naturally increase when adding code</li> <li>In the current architecture, copy-paste is the easiest approach for adding new features (High Viscosity)</li> </ul>"},{"location":"problem-analysis/detailed-analysis/#chapter-4-why-untestable","title":"Chapter 4: Why Untestable?","text":"<p>Data Sources:</p> Source Extracted Data architecture-smells-analysis.md Section 2.1 Hub-like Dependency Diagram architecture-smells-analysis.md Section 2.3 External calls (113), Environment variables (10) <p>Evidence:</p> Factor Count Impact External calls via <code>sh</code> 113 Cannot mock in unit tests Hidden environment variables 10 Runtime-only values Hub-like dependencies 5 pipelines \u2192 generalHelper No isolation possible Direct external calls from pipelines 50 Bypasses any abstraction <p>Analysis: - All Helpers and Pipelines directly call external systems via <code>sh</code> - Tight coupling to external systems without Dependency Injection - Testing requires actual Jenkins + Git + Bitbucket + Unity + Docker environment</p>"},{"location":"problem-analysis/detailed-analysis/#references","title":"References","text":"<ul> <li>Individual analyses: 01-08 files</li> <li>DRY-violation-analysis.md</li> <li>pipeline-sequence-diagrams/domain-mapping.md</li> </ul>"},{"location":"problem-analysis/problem-analysis-overview/","title":"Problem Analysis Overview","text":""},{"location":"problem-analysis/problem-analysis-overview/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Background</li> <li>Analysis Target</li> <li>Baseline Statistics</li> <li>Key Findings</li> <li>Quantitative Summary</li> <li>Shotgun Surgery</li> <li>Duplication Trend</li> <li>Design Symptoms Summary</li> <li>Why This Analysis Matters</li> <li>Document Structure</li> <li>Analysis Document Links</li> </ul>"},{"location":"problem-analysis/problem-analysis-overview/#1-background","title":"1. Background","text":"<p>This document is the problem analysis document for the pre-refactoring Baseline codebase.</p> <p>During the VARLab Co-op period, 5 monolithic pipelines (41% duplication, untestable) with 14 months of accumulated Technical Debt were refactored into a 4-Layer Architecture.</p>"},{"location":"problem-analysis/problem-analysis-overview/#11-analysis-purpose","title":"1.1. Analysis Purpose","text":"<p>At the time of refactoring, it was done intuitively without clear criteria. To lead from experience-based understanding to systematic theory acquisition, classification and definition using Industry Convention criteria:</p> <ol> <li>Learn how the problems I felt are classified and named in practice</li> <li>Check if there are any missed problems</li> <li>Understand the analysis methodology itself</li> </ol>"},{"location":"problem-analysis/problem-analysis-overview/#12-applied-industry-convention-criteria","title":"1.2. Applied Industry Convention Criteria","text":"Level Framework Source Function/Method Single Responsibility Principle Martin (2006) Agile Principles, Patterns, and Practices in C# Ch.8 Function/Method Code Smells Fowler (1999) Refactoring Module/File Design Smells Suryanarayana et al. (2014) Refactoring for Software Design Smells Module/File 7 Design Symptoms Martin (2002) Agile Software Development System Architecture Smells Garcia et al. (2009), Sharma"},{"location":"problem-analysis/problem-analysis-overview/#2-analysis-target","title":"2. Analysis Target","text":"<p>Baseline Commit: <code>74fc356</code> (2025-03-20)</p> <p>This is the final state before Global Shared Library introduction. Selected after re-analyzing the entire commit history for precise baseline identification.</p> <p>Note on Resume's 37% Figure: The \"37% duplication\" mentioned in resume was based on earlier baseline <code>54479b2</code> (2025-02-21). After detailed commit history analysis, <code>74fc356</code> was identified as the accurate \"before refactoring\" state. Current analysis shows 41% duplication.</p>"},{"location":"problem-analysis/problem-analysis-overview/#3-baseline-statistics","title":"3. Baseline Statistics","text":"Category Files Purpose Jenkinsfiles 5 Pipeline orchestration Groovy Helpers 3 Shared functions Python Scripts 16 Reporting &amp; API integration Bash/Config 3 Linting &amp; editor settings <p>Analysis Target: Jenkinsfiles + Groovy Helpers (8 files)</p> Type File Jenkinsfile DLXJenkins/Jenkinsfile Jenkinsfile DLXJenkins/JenkinsfileDeployment Jenkinsfile JsJenkins/Jenkinsfile Jenkinsfile JsJenkins/JenkinsfileDeployment Jenkinsfile PipelineForJenkins/Jenkinsfile Helper generalHelper.groovy Helper jsHelper.groovy Helper unityHelper.groovy"},{"location":"problem-analysis/problem-analysis-overview/#31-file-structure","title":"3.1 File Structure","text":"<pre><code>74fc356/\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 build.gradle\n\u251c\u2500\u2500 Builder.cs\n\u2502\n\u251c\u2500\u2500 DLXJenkins/                           # Unity Project Pipeline\n\u2502   \u251c\u2500\u2500 Jenkinsfile                       # CI Pipeline (255 lines)\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment             # CD Pipeline (227 lines)\n\u2502\n\u251c\u2500\u2500 JsJenkins/                            # JavaScript Project Pipeline\n\u2502   \u251c\u2500\u2500 Jenkinsfile                       # CI Pipeline (252 lines)\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment             # CD Pipeline (336 lines)\n\u2502\n\u251c\u2500\u2500 PipelineForJenkins/                   # Jenkins Self Pipeline\n\u2502   \u251c\u2500\u2500 Jenkinsfile                       # CI Pipeline (253 lines)\n\u2502   \u251c\u2500\u2500 .groovylintrc.groovy.json\n\u2502   \u2514\u2500\u2500 .groovylintrc.jenkins.json\n\u2502\n\u251c\u2500\u2500 groovy/                               # Helper Scripts\n\u2502   \u251c\u2500\u2500 generalHelper.groovy              # 656 lines, 7 domains\n\u2502   \u251c\u2500\u2500 unityHelper.groovy                # 357 lines, 3 domains\n\u2502   \u2514\u2500\u2500 jsHelper.groovy                   # 356 lines, 4 domains\n\u2502\n\u251c\u2500\u2500 Bash/\n\u2502   \u251c\u2500\u2500 .editorconfig\n\u2502   \u2514\u2500\u2500 Linting.bash\n\u2502\n\u251c\u2500\u2500 python/\n\u2502   \u251c\u2500\u2500 JsReporting/\n\u2502   \u2502   \u251c\u2500\u2500 extract_coverage_rates.py\n\u2502   \u2502   \u2514\u2500\u2500 extract_test_result.py\n\u2502   \u251c\u2500\u2500 log-template/\n\u2502   \u2502   \u2514\u2500\u2500 logs.html\n\u2502   \u251c\u2500\u2500 create_bitbucket_coverage_report.py\n\u2502   \u251c\u2500\u2500 create_bitbucket_test_report.py\n\u2502   \u251c\u2500\u2500 create_bitbucket_webgl_build_report.py\n\u2502   \u251c\u2500\u2500 create_log_report.py\n\u2502   \u251c\u2500\u2500 extract_build_error_log_messages.py\n\u2502   \u251c\u2500\u2500 get_bitbucket_commit_hash.py\n\u2502   \u251c\u2500\u2500 get_unity_failure.py\n\u2502   \u251c\u2500\u2500 get_unity_version.py\n\u2502   \u251c\u2500\u2500 Lint_groovy_report.py\n\u2502   \u251c\u2500\u2500 linting_error_report.py\n\u2502   \u251c\u2500\u2500 npm_audit.py\n\u2502   \u2514\u2500\u2500 send_bitbucket_build_status.py\n\u2502\n\u2514\u2500\u2500 tests/\n    \u251c\u2500\u2500 GeneralHelperSpec.groovy\n    \u2514\u2500\u2500 JsHelperSpec.groovy\n</code></pre>"},{"location":"problem-analysis/problem-analysis-overview/#4-key-findings","title":"4. Key Findings","text":""},{"location":"problem-analysis/problem-analysis-overview/#41-quantitative-summary","title":"4.1 Quantitative Summary","text":"Metric Value Total Lines Analyzed 1,323 (5 Jenkinsfiles) + 1,369 (3 Helpers) Code Duplication 41% across all pipelines DLX CI/CD Duplication 83% JS CI/CD Duplication 72% External Calls 113 calls to 12 external types Shotgun Surgery Cross-file: 37 locations, Within-file: 30 locations"},{"location":"problem-analysis/problem-analysis-overview/#42-shotgun-surgery","title":"4.2 Shotgun Surgery","text":"<ul> <li>Cross-file (Helper signature change): Changing a Helper function requires modifications across multiple Jenkinsfiles. e.g., <code>sendBuildStatus</code> change requires 18 modifications across generalHelper + 5 Jenkinsfiles.</li> <li>Within-file (Pattern duplication): Same pattern repeated within a single file. e.g., stageName/errorMsg pattern duplicated 9 times in DLX CI/CD.</li> </ul>"},{"location":"problem-analysis/problem-analysis-overview/#43-duplication-trend","title":"4.3 Duplication Trend","text":"Commit Date Duplication <code>54479b2</code> 2025-02-21 37% <code>74fc356</code> 2025-03-20 41% <p>Duplication increased 4% in approximately 1 month. The architecture's High Viscosity makes copy-paste easier than proper abstraction.</p>"},{"location":"problem-analysis/problem-analysis-overview/#44-design-symptoms-summary","title":"4.4 Design Symptoms Summary","text":"<p>Helpers:</p> Symptom generalHelper jsHelper unityHelper Rigidity High Low High Fragility High Low High Immobility High Medium Medium Viscosity Medium Medium High Needless Repetition High Medium High <p>Jenkinsfiles: All 5 exhibit High Immobility and High Needless Repetition.</p>"},{"location":"problem-analysis/problem-analysis-overview/#5-why-this-analysis-matters","title":"5. Why This Analysis Matters","text":""},{"location":"problem-analysis/problem-analysis-overview/#core-problem","title":"Core Problem","text":"<p>The issue is not that Helpers exist (Helpers are intentional reuse). The problem is:</p> <ol> <li>Inline logic in Jenkinsfiles: Orchestration layer should be thin, but pipelines contain 9-29 inline code blocks each</li> <li>5 pipelines with same inline code: Change one, must change all 5 (Shotgun Surgery)</li> <li>This caused 14-month technical debt: \"Fear of touching code\" \u2192 copy-paste \u2192 more duplication</li> </ol>"},{"location":"problem-analysis/problem-analysis-overview/#evidence-chain","title":"Evidence Chain","text":"<pre><code>Inline Code in Jenkinsfiles\n    \u2193\nSame pattern duplicated across 5 pipelines\n    \u2193\nShotgun Surgery (1 change \u2192 18 locations)\n    \u2193\nHigh Viscosity (copy-paste easier than fixing)\n    \u2193\nDuplication naturally increases (37% \u2192 41% in 1 month)\n    \u2193\n14-month Technical Debt accumulation\n</code></pre>"},{"location":"problem-analysis/problem-analysis-overview/#real-world-experience","title":"Real-World Experience","text":"<p>Human Error Prone Structure - Modified INLINE code in CI Jenkinsfile, tested only CI pipeline - Forgot about identical INLINE code in CD Jenkinsfile, deployed \u2192 CD pipeline not applied - Modified Helper function + CI Jenkinsfile, missed CD Jenkinsfile update \u2192 CD pipeline broken</p> <p>Risk of Needing to Consider Everything for One Feature - When changing common functionality like \"Add Warning status to build results\": Must find and modify all 5 pipelines individually - Context switching when interrupted by other ticket work - Need to notify team members before every change</p> <p>Workflow and Teamwork Threatened by Strong Coupling - Multiple responsibilities concentrated in single file + strong coupling - One person's code changes affect other team members' work - Psychologically reluctant to modify/add features \u2192 Teamwork degradation</p> <p>ROI Degradation - Even simple modifications can't focus on just that feature - Must consider 5 pipelines + Jenkins UI settings + Webhook/Third-party APIs - 10-20 minute tasks extend to hours or days</p>"},{"location":"problem-analysis/problem-analysis-overview/#6-document-structure","title":"6. Document Structure","text":"<pre><code>problem-analysis-overview.md (this file)\n    \u2502\n    \u251c\u2500\u2500 Main Analysis\n    \u2502   \u2514\u2500\u2500 detailed-analysis.md \u2190 Synthesized findings (\u2605 Start here)\n    \u2502\n    \u251c\u2500\u2500 Supporting Analysis\n    \u2502   \u251c\u2500\u2500 architecture-smells-analysis.md \u2190 System-level (Hub-like, Scattered)\n    \u2502   \u2514\u2500\u2500 DRY-violation-analysis.md \u2190 Cross-file duplication patterns\n    \u2502\n    \u251c\u2500\u2500 Per-File Analysis (01-08/)\n    \u2502   \u251c\u2500\u2500 01-generalHelper/\n    \u2502   \u2502   \u251c\u2500\u2500 01-srp-violation-analysis.md\n    \u2502   \u2502   \u251c\u2500\u2500 02-software-smells-analysis.md\n    \u2502   \u2502   \u2514\u2500\u2500 03-design-smells-symptoms.md\n    \u2502   \u251c\u2500\u2500 02-jsHelper/\n    \u2502   \u251c\u2500\u2500 03-unityHelper/\n    \u2502   \u251c\u2500\u2500 04-DLXJenkins-Jenkinsfile/\n    \u2502   \u251c\u2500\u2500 05-DLXJenkins-JenkinsfileDeployment/\n    \u2502   \u251c\u2500\u2500 06-JsJenkins-Jenkinsfile/\n    \u2502   \u251c\u2500\u2500 07-JsJenkins-JenkinsfileDeployment/\n    \u2502   \u2514\u2500\u2500 08-PipelineForJenkins-Jenkinsfile/\n    \u2502\n    \u2514\u2500\u2500 Pipeline Flow Analysis\n        \u2514\u2500\u2500 pipeline-sequence-diagrams/ \u2190 Domain mapping, call flow diagrams\n</code></pre>"},{"location":"problem-analysis/problem-analysis-overview/#7-analysis-document-links","title":"7. Analysis Document Links","text":""},{"location":"problem-analysis/problem-analysis-overview/#main-analysis","title":"Main Analysis","text":"Document Description detailed-analysis.md Synthesized findings from all individual analyses"},{"location":"problem-analysis/problem-analysis-overview/#supporting-analysis","title":"Supporting Analysis","text":"Document Description architecture-smells-analysis.md System-level analysis (Hub-like Dependency, Scattered Functionality) DRY-violation-analysis.md Cross-file duplication patterns"},{"location":"problem-analysis/problem-analysis-overview/#pipeline-flow-analysis","title":"Pipeline Flow Analysis","text":"Document Description pipeline-sequence-diagrams/domain-mapping.md Domain summary across all pipelines pipeline-sequence-diagrams/dlx-ci.md DLX CI pipeline call flow pipeline-sequence-diagrams/dlx-cd.md DLX CD pipeline call flow pipeline-sequence-diagrams/js-ci.md JS CI pipeline call flow pipeline-sequence-diagrams/js-cd.md JS CD pipeline call flow pipeline-sequence-diagrams/jenkins-ci.md Jenkins CI pipeline call flow"},{"location":"problem-analysis/problem-analysis-overview/#per-file-analysis","title":"Per-File Analysis","text":"File SRP Analysis Software Smells Design Symptoms generalHelper.groovy 01-srp 02-smells 03-symptoms jsHelper.groovy 01-srp 02-smells 03-symptoms unityHelper.groovy 01-srp 02-smells 03-symptoms DLXJenkins/Jenkinsfile 01-srp 02-smells 03-symptoms DLXJenkins/JenkinsfileDeployment 01-srp 02-smells 03-symptoms JsJenkins/Jenkinsfile 01-srp 02-smells 03-symptoms JsJenkins/JenkinsfileDeployment 01-srp 02-smells 03-symptoms PipelineForJenkins/Jenkinsfile 01-srp 02-smells 03-symptoms"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/","title":"SRP Violation Analysis","text":"<p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#groovygeneralhelpergroovy-srp-violation-analysis","title":"groovy/generalHelper.groovy - SRP Violation Analysis","text":"<p>\"Kitchen Sink\" File - Actual cohesion only 19% compared to design intent (common function collection) (656 lines)</p>"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#1-srp-violation-analysis-criteria","title":"1. SRP Violation Analysis Criteria","text":"<ul> <li>generalHelper Design Intent: Since Unity Helper and JS Helper exist separately, generalHelper is designed to \"collect only functions commonly used across all pipelines\"</li> <li>Cohesion Analysis Criteria: \"Is it actually used in all pipelines?\" = Cohesion aligned with design intent</li> </ul>"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#11-why-this-criteria","title":"1.1. Why This Criteria?","text":"<p>SRP asks \"who requests changes to this code?\" For a shared helper file,  the answer should be \"everyone equally.\" If only specific pipelines use  a function, it belongs in that pipeline's dedicated helper, not here.</p> <p>Call counts (how many times) don't matter for this judgment -  only pipeline coverage (how many pipelines) does.</p>"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#12-solid-principles-references","title":"1.2. SOLID Principles References","text":""},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#sources","title":"Sources","text":"<ol> <li>97 Things Every Programmer Should Know (O'Reilly, 2010)</li> <li> <p>Chapter 76: \"The Single Responsibility Principle\" by Uncle Bob</p> </li> <li> <p>Agile Principles, Patterns, and Practices in C# by Robert C. Martin (2006)</p> </li> <li>Chapter 8: \"The Single-Responsibility Principle (SRP)\"</li> </ol>"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#2-cohesion-and-change-reasons-per-function","title":"2. Cohesion and Change Reasons per Function","text":"# Function Name DLX CI DLX CD JS CI JS CD Pipeline Internal Change Reason 1 <code>parseJson</code> 2 2 2 2 2 When Jenkins build/stage result constants are added/changed 2 <code>logMessage</code> 16 When logging output format/style changes (internal use) 3 <code>cloneOrUpdateRepo</code> 1 1 1 1 When Git CLI commands, repository cleanup policies change 4 <code>getDefaultBranch</code> 1 When Git remote command output format changes (internal use) 5 <code>initializeEnvironment</code> 1 1 1 2 reasons:When Bitbucket status API changesWhen environment variable setup method changes 6 <code>checkoutBranch</code> 1 1 1 1 1 1 When Git checkout/reset/clean workflow changes 7 <code>mergeBranchIfNeeded</code> 1 1 When Git merge strategy/workflow changes 8 <code>isBranchUpToDateWithRemote</code> 1 1 1 When Git fetch/rev-parse commands change 9 <code>isBranchUpToDateWithMain</code> 1 When Git merge-base command changes (internal use) 10 <code>tryMerge</code> 1 When Git merge command/options change (internal use) 11 <code>getFullCommitHash</code> 1 1 1 1 1 When Bitbucket API (Python script) interface changes 12 <code>getCurrentCommitHash</code> When Git rev-parse command changes (Dead Code) 13 <code>sendBuildStatus</code> 3 4 3 5 3 1 When Bitbucket build status API spec changes 14 <code>parseTicketNumber</code> 1 1 When branch naming convention (ticket pattern) changes 15 <code>publishTestResultsHtmlToWebServer</code> 1 2 When web server path/permission policy, SSH settings change 16 <code>publishBuildResultsToWebServer</code> 1 When web server deployment path structure changes 17 <code>cleanMergedBranchFromWebServer</code> 1 When web server cleanup path policy changes 18 <code>cleanUpPRBranch</code> 1 2 reasons:When Linux package management method changesWhen directory cleanup policy changes 19 <code>closeLogfiles</code> When lsof output format, process termination method changes (Dead Code) 20 <code>checkQualityGateStatus</code> 1 1 1 2 reasons:When SonarQube API changesWhen polling/retry strategy changes 21 <code>publishGroovyDocToWebServer</code> 1 When GroovyDoc deployment path/permission policy changes <p>Note on Call Counts:  The numbers indicate how many times each function is called per pipeline.  High call counts (e.g., <code>sendBuildStatus</code>: 4 times in DLX CD) may suggest  insufficient abstraction in the calling side (pipeline files),  not in the helper itself. This is analyzed in the pipeline file analysis (04-08).</p>"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#3-module-level-srp-violation-analysis-cohesion-analysis-results","title":"3. Module Level SRP Violation Analysis - Cohesion Analysis Results","text":"<ul> <li>100% Usage (4): <code>parseJson</code>, <code>checkoutBranch</code>, <code>getFullCommitHash</code>, <code>sendBuildStatus</code></li> <li>60% Usage (4): <code>cloneOrUpdateRepo</code>, <code>initializeEnvironment</code>, <code>isBranchUpToDateWithRemote</code>, <code>checkQualityGateStatus</code></li> <li>40% Usage (2): <code>mergeBranchIfNeeded</code>, <code>publishTestResultsHtmlToWebServer</code></li> <li>20% Usage (5): <code>publishBuildResultsToWebServer</code>, <code>cleanMergedBranchFromWebServer</code>, <code>cleanUpPRBranch</code>, <code>publishGroovyDocToWebServer</code>, <code>parseTicketNumber</code></li> <li>Dead Code (2): <code>getCurrentCommitHash</code>, <code>closeLogfiles</code></li> <li>Internal Use Only (4): <code>logMessage</code>, <code>getDefaultBranch</code>, <code>isBranchUpToDateWithMain</code>, <code>tryMerge</code></li> </ul> <p>SRP Violation: Contrary to the design intent of \"common function collection\", only 4 out of 21 functions (19%) are 100% reused. The remaining 81% are used only in specific pipelines.</p>"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#4-function-level-srp-violation-analysis-functions-with-multiple-change-reasons","title":"4. Function Level SRP Violation Analysis - Functions with Multiple Change Reasons","text":"Multi-responsibility Function: <code>initializeEnvironment()</code> (2 change reasons) <pre><code>void initializeEnvironment(String workspace, String commitHash, String prBranch) {\n    echo \"Sending 'In Progress' status to Bitbucket...\"\n    sendBuildStatus(workspace, 'INPROGRESS', commitHash)  // Change reason 1: Bitbucket status API\n    env.TICKET_NUMBER = parseTicketNumber(prBranch)       // Change reason 2: Environment variable setup\n    env.FOLDER_NAME = \"${JOB_NAME}\".split('/').first()\n}\n</code></pre> <p>Change Reason Analysis: 1. When Bitbucket status API changes (line 137): <code>sendBuildStatus()</code> call method 2. When environment variable setup method changes (lines 138-139): <code>TICKET_NUMBER</code>, <code>FOLDER_NAME</code> setup</p> Multi-responsibility Function: <code>cleanUpPRBranch()</code> (2 change reasons) <pre><code>void cleanUpPRBranch(String prBranch) {\n    // Change reason 1: find tool installation (Linux package management)\n    def findPath = sh(script: 'command -v find', returnStdout: true).trim()\n    if (!findPath) {\n        echo \"'find' directory searching tool is not found...\"\n        echo \"Installing 'find' directory searching tool...\"\n        int installStatus = sh(script: 'sudo apt-get update &amp;&amp; sudo apt-get install -y findutils', returnStatus: true)\n        if (installStatus == 0 ) {\n            echo \"The 'findutils' package was installed successfully.\"\n        } else {\n            echo \"Failed to install 'findutils'. Exit code: ${installStatus}\"\n            error \"Installation failed with exit code: ${installStatus}\"\n        }\n    }\n\n    // Change reason 2: Directory cleanup policy\n    def branchPaths = sh(script: \"${findPath} ../ -type d -name \\\"${prBranch}\\\"\", returnStdout: true).trim()\n    if (!branchPaths.isEmpty()) {\n        def paths = branchPaths.split('\\n')\n        paths.each { branchPath -&gt;\n            echo \"Deleting Branch Path: ${branchPath}\"\n            sh(script: \"rm -r -f \\\"${branchPath}\\\"\", returnStatus: true)\n            // ...\n        }\n    }\n}\n</code></pre> <p>Change Reason Analysis: 1. When Linux package management method changes (lines 403-414): <code>apt-get</code> -&gt; other package manager 2. When directory cleanup policy changes (lines 417-442): Search path, deletion conditions</p> Multi-responsibility Function: <code>checkQualityGateStatus()</code> (2 change reasons) <pre><code>Map checkQualityGateStatus(String projectKey, String adminToken) {\n    // Change reason 1: SonarQube API (URL, auth, response structure)\n    String buildStatusURL = \"http://localhost:9000/sonarqube/api/ce/component?component=${projectKey}\"\n    String qualityGateResultURL = \"http://localhost:9000/sonarqube/api/qualitygates/project_status?projectKey=${projectKey}\"\n\n    // Change reason 2: Polling/retry strategy\n    int maxRetries = 5\n\n    for (int retryCount = 1; retryCount &lt;= maxRetries; retryCount++) {\n        def process = buildStatusAPIcall.execute()\n        process.waitFor()\n\n        def buildStatus = new JsonSlurperClassic().parseText(buildStatusResponse)\n        if (buildStatus?.queue?.size() &gt; 0) {\n            sleep(10)  // Change reason 2: Wait time\n            continue\n        }\n        // ...\n    }\n}\n</code></pre> <p>Change Reason Analysis: 1. When SonarQube API changes: URL, auth method, response structure 2. When polling/retry strategy changes: Retry count, wait time, timeout</p> <p>Additional Code Smell: Long Method (94 lines)</p>"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#conclusion","title":"Conclusion","text":"<p>SRP Violation: - Module Level: Only 19% of functions are 100% reused compared to \"common function collection\" design intent - Function Level: 3 functions have multiple change reasons (<code>initializeEnvironment</code>(2), <code>cleanUpPRBranch</code>(2), <code>checkQualityGateStatus</code>(2)) - 2 Dead Code functions found - \"Kitchen Sink\" Anti-pattern</p>"},{"location":"problem-analysis/01-generalHelper/01-srp-violation-analysis/#next-why-software-smells-analysis","title":"Next: Why Software Smells Analysis?","text":"<p>SRP analysis identified what violates design intent. The next document classifies these violations using industry-standard taxonomy (Fowler, Martin, Suryanarayana) to provide shared vocabulary for discussing the problems.</p> <p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/","title":"Software Smells Analysis","text":"<p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#groovygeneralhelpergroovy-software-smells-analysis","title":"groovy/generalHelper.groovy - Software Smells Analysis","text":"<p>Classification based on industry-standard taxonomy: Code Smells (Fowler) \u2192 Design Smells (Suryanarayana)</p> <p>Domain Classification: 7 domains, 21 functions. See Domain Mapping</p>"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#1-code-smells","title":"1. Code Smells","text":"<p>Source: Fowler, M. (1999). Refactoring: Improving the Design of Existing Code</p> <p>Applicable Categories: Fowler defines 5 categories of Code Smells: Bloaters, Object-Orientation Abusers, Change Preventers, Dispensables, and Couplers. Since Jenkins Pipeline Helper files are procedural scripts (not OOP classes), only the following categories are applicable:</p> Category Applicable Applied Smells Bloaters \u2713 Long Method, Large File, Primitive Obsession, Data Clumps Change Preventers \u2713 Divergent Change, Shotgun Surgery Dispensables \u2713 Dead Code, Duplicated Code Object-Orientation Abusers \u2717 (not applicable - no inheritance/polymorphism) Couplers \u2717 (not applicable - no class relationships)"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#11-change-preventers-with-severity-criteria","title":"1.1 Change Preventers (with Severity Criteria)","text":""},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#severity-criteria","title":"Severity Criteria","text":"Metric Low Medium High Impact Scope 1-2 pipelines 3-4 pipelines 5 pipelines Modification Cost 1-5 locations 6-10 locations 11+ locations"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#divergent-change-scope-file-level","title":"Divergent Change (Scope: File Level)","text":"<p> Click to see details <p>Definition: A single class/file is frequently changed for several different reasons</p> <p>Scope: File Level</p> <p>Divergent Change Cases in generalHelper.groovy:</p> Change Reason Affected Functions Count Git policy change <code>cloneOrUpdateRepo</code>, <code>getDefaultBranch</code>, <code>checkoutBranch</code>, <code>mergeBranchIfNeeded</code>, <code>isBranchUpToDateWithRemote</code>, <code>isBranchUpToDateWithMain</code>, <code>tryMerge</code>, <code>getCurrentCommitHash</code> 8 Bitbucket API change <code>getFullCommitHash</code>, <code>sendBuildStatus</code> 2 Web Server structure change <code>publishTestResultsHtmlToWebServer</code>, <code>publishBuildResultsToWebServer</code>, <code>cleanMergedBranchFromWebServer</code>, <code>publishGroovyDocToWebServer</code> 4 SonarQube settings change <code>checkQualityGateStatus</code> 1 Parsing rule change <code>parseJson</code>, <code>parseTicketNumber</code> 2 File System policy change <code>cleanUpPRBranch</code> 1 Logging policy change <code>logMessage</code>, <code>closeLogfiles</code> 2 <p>Severity Evidence: - Impact Scope: High (5 pipelines depend on this file) - Modification Cost: High (7 different change reasons in single file)</p> <p>Related: Domain mapping identified 7 domains in this file. See Domain Mapping</p>"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#shotgun-surgery-scope-cross-filesystem-level","title":"Shotgun Surgery (Scope: Cross-file/System Level)","text":"<p> Click to see details <p>Definition: A single change requires modifications to multiple files</p> <p>Scope: Cross-file/System Level</p> <p>Shotgun Surgery Cases in generalHelper.groovy:</p> Function DLX CI DLX CD JS CI JS CD Jenkins CI Total Locations <code>sendBuildStatus</code> 3 4 3 5 3 18 <code>parseJson</code> 2 2 2 2 2 10 <code>checkoutBranch</code> 1 1 1 1 1 5 + 1 internal <code>getFullCommitHash</code> 1 1 1 1 1 5 <p>Severity Evidence: - Impact Scope: High (5 pipeline files depend on this helper) - Modification Cost: High (18 locations for <code>sendBuildStatus</code>)</p> <p>Related: Data from SRP Analysis Section 2 (Cohesion Table)</p>"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#12-other-code-smells-evidence-only","title":"1.2 Other Code Smells (Evidence Only)","text":""},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#bloaters","title":"Bloaters","text":"Smell Evidence Long Method <code>checkQualityGateStatus</code> (94 lines), <code>closeLogfiles</code> (45 lines), <code>cloneOrUpdateRepo</code> (42 lines), <code>cleanUpPRBranch</code> (40 lines) Large File 656 lines, 21 functions, 7 domains Primitive Obsession <code>\"/var/www/html\"</code> (11x), <code>env.SSH_KEY</code> (10x), <code>env.DLX_WEB_HOST_URL</code> (10x), <code>\"vconadmin:vconadmin\"</code> (3x) Data Clumps <code>remoteProjectFolderName</code> (14x), <code>ticketNumber</code> (12x), <code>workspace</code> (11x), <code>commitHash</code> (8x)"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#dispensables","title":"Dispensables","text":"Smell Evidence Dead Code <code>getCurrentCommitHash</code>, <code>closeLogfiles</code> (2 functions, 53 lines total) Duplicated Code SSH command pattern (6x), SCP pattern (4x), chmod/chown pattern (4x), <code>git fetch origin</code> (3x)"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#2-design-smells-principle-based","title":"2. Design Smells (Principle-Based)","text":"<p>Source: Suryanarayana, G. et al. (2014). Refactoring for Software Design Smells</p> <p>Applicable Categories: Suryanarayana defines 4 categories based on OO design principles: Abstraction, Encapsulation, Modularization, and Hierarchy. Since Jenkins Pipeline Helper files are procedural scripts (not OOP classes), only the following categories are applicable:</p> Category Applicable Applied Smells Abstraction \u2713 Multifaceted Abstraction, Missing Abstraction, Unutilized Abstraction Encapsulation \u25b3 Missing Encapsulation Modularization \u2713 Insufficient Modularization, Hub-like Modularization Hierarchy \u2717 (not applicable - no inheritance) <p>Note: Incomplete Abstraction is not applied because determining \"expected operations\" requires design specification that does not exist.</p>"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#21-abstraction-smells","title":"2.1 Abstraction Smells","text":""},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#multifaceted-abstraction","title":"Multifaceted Abstraction","text":"<p> Click to see details <p>Definition: \"An abstraction has multiple responsibilities assigned to it\"</p> <p>Evidence: - 7 responsibilities in single file: Git, Bitbucket, Web Server, SonarQube, Parsing, File System, Logging - 21 functions across 7 different responsibilities</p>"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#missing-abstraction","title":"Missing Abstraction","text":"<p> Click to see details <p>Definition: \"Clumps of data or encoded strings are used instead of creating a class or an interface\"</p> <p>Evidence:</p> Concept Current State Occurrences Web server path <code>\"/var/www/html\"</code> hardcoded 11 SSH key <code>env.SSH_KEY</code> scattered 10 Web host URL <code>env.DLX_WEB_HOST_URL</code> scattered 10 User account <code>\"vconadmin:vconadmin\"</code> hardcoded 3 SonarQube URL <code>\"http://localhost:9000/sonarqube\"</code> hardcoded 2"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#unutilized-abstraction","title":"Unutilized Abstraction","text":"<p> Click to see details <p>Definition: \"An abstraction is left unused (either not directly used or not reachable)\"</p> <p>Evidence:</p> Function Lines Status <code>getCurrentCommitHash</code> 8 Declared but never called by any pipeline <code>closeLogfiles</code> 45 Declared but never called by any pipeline"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#22-encapsulation-smells","title":"2.2 Encapsulation Smells","text":""},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#missing-encapsulation","title":"Missing Encapsulation","text":"<p> Click to see details <p>Definition: \"The encapsulation of implementation variations in a type is missing\"</p> <p>Evidence:</p> Pattern Occurrences Affected Functions SSH command execution 6 4 Web Server functions SCP file transfer 4 4 Web Server functions chmod/chown permission 4 4 Web Server functions <code>git fetch origin</code> 3 <code>cloneOrUpdateRepo</code>, <code>mergeBranchIfNeeded</code>, <code>isBranchUpToDateWithRemote</code>"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#23-modularization-smells","title":"2.3 Modularization Smells","text":""},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#insufficient-modularization","title":"Insufficient Modularization","text":"<p> Click to see details <p>Definition: \"An abstraction that has not been completely decomposed, and a further decomposition could reduce its size, implementation complexity, or both.\"</p> <p>Evidence:</p> Metric Value File size 656 lines Function count 21 Domain count 7"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#hub-like-modularization","title":"Hub-like Modularization","text":"<p> Click to see details <p>Definition: \"An abstraction has dependencies (incoming and outgoing) with a large number of other abstractions.\"</p> <p>Evidence:</p> Direction Dependency Count Incoming Pipeline files that <code>load()</code> this helper 5 Outgoing Git CLI calls 18 Outgoing Linux command calls 11 Outgoing SSH calls 6 Outgoing SCP calls 4 Outgoing Python script calls 2 Outgoing SonarQube API calls (curl) 2"},{"location":"problem-analysis/01-generalHelper/02-software-smells-analysis/#conclusion","title":"Conclusion","text":"<p>Software Smells Summary: - Code Level: Divergent Change (7 change reasons), Shotgun Surgery (18+ locations across 5 files) - Design Level: 7 domains not modularized, primitive strings instead of abstractions, 2 unutilized functions</p> <p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/","title":"Design Smells Analysis","text":"<p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#groovygeneralhelpergroovy-design-smells-symptoms-analysis","title":"groovy/generalHelper.groovy - Design Smells Symptoms Analysis","text":"<p>Source: Martin, R.C. (2000). Design Principles and Design Patterns</p> <p>This document analyzes Martin's 7 Design Symptoms using evidence from: - SRP Violation Analysis: Cohesion metrics, multi-responsibility functions - Software Smells Analysis: Code Smells (Fowler), Design Smells (Suryanarayana) - DRY Violation Analysis: Duplicated patterns across files - Direct code review: Readability, naming, complexity issues</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#1-rigidity","title":"1. Rigidity","text":"<p>Definition: Changing one place requires cascading changes to other places</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#contributing-smells","title":"Contributing Smells","text":"Smell Evidence Impact Shotgun Surgery <code>sendBuildStatus</code> change \u2192 18 locations across 5 pipelines High Primitive Obsession <code>\"/var/www/html\"</code> change \u2192 11 locations High Missing Encapsulation SSH pattern change \u2192 6 locations Medium"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#2-fragility","title":"2. Fragility","text":"<p>Definition: Modifying one place breaks conceptually unrelated places</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#contributing-smells_1","title":"Contributing Smells","text":"Smell Evidence Risk Shotgun Surgery Miss one of 18 locations \u2192 build breaks High Missing Encapsulation Update SSH pattern in 3 places, forget 3 others \u2192 runtime failure Medium Primitive Obsession Update path in 8 places, forget 3 others \u2192 deployment failure Medium"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#3-immobility","title":"3. Immobility","text":"<p>Definition: Difficult to extract useful parts for reuse in other systems/modules</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#contributing-smells_2","title":"Contributing Smells","text":"Smell Evidence Impact Hub-like Modularization 5 pipelines depend + 43 outgoing calls (Git 18, Linux 11, SSH 6, SCP 4, Python 2, curl 2) High Insufficient Modularization 656 lines, 21 functions, 7 domains in single file High Multifaceted Abstraction 7 responsibilities mixed \u2192 extracting one brings others High"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#4-viscosity","title":"4. Viscosity","text":"<p>Definition: Doing the right thing (maintaining design) is harder than doing the wrong thing (hacking)</p> <p>Symptom: \"It's faster to just copy-paste than to do it properly\"</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#contributing-smells_3","title":"Contributing Smells","text":"Smell Evidence Impact Missing Encapsulation SSH/SCP/Git patterns not encapsulated \u2192 copy-paste easier than creating helper Medium Primitive Obsession <code>\"/var/www/html\"</code> hardcoded 11x \u2192 copy existing easier than creating constant Medium Duplicated Code SSH (6x), SCP (4x), git fetch (3x) \u2192 duplication pattern already established Medium"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#5-needless-complexity","title":"5. Needless Complexity","text":"<p>Definition: Over-engineering for features not currently needed</p> <p>Symptom: \"I might need this later\" (YAGNI violation)</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#evidence","title":"Evidence","text":"<p>No clear evidence of over-engineering found in generalHelper.groovy.</p> <p>Note: Dead Code (<code>getCurrentCommitHash</code>, <code>closeLogfiles</code>) exists but appears to be legacy code rather than over-engineering.</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#6-needless-repetition","title":"6. Needless Repetition","text":"<p>Definition: Code that could be unified through abstraction is duplicated in multiple places</p> <p>Symptom: \"Same code in multiple places\" (DRY violation)</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#contributing-smells_4","title":"Contributing Smells","text":"Smell Evidence Impact Duplicated Code SSH command pattern (6x), SCP pattern (4x), chmod/chown pattern (4x), <code>git fetch origin</code> (3x) High Missing Encapsulation Same patterns repeated without helper function extraction High"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#7-opacity","title":"7. Opacity","text":"<p>Definition: Code is difficult to understand and intent is unclear</p> <p>Symptom: \"What does this code do?\"</p>"},{"location":"problem-analysis/01-generalHelper/03-design-smells-symptoms/#evidence-code-review","title":"Evidence (Code Review)","text":"Issue Evidence Impact Counter-intuitive variable name <code>projectExists = sh(..., returnStatus: true)</code> - 0 = exists Medium Function name mismatch <code>parseJson()</code> returns fixed data, <code>isBranchUpToDateWithMain(destinationBranch)</code> Medium Complex nesting 3-level <code>if-else</code> nesting (lines 70-107) Medium Complex retry loop <code>for</code> loop + <code>break</code>/<code>continue</code> in <code>checkQualityGateStatus</code> (94 lines) High Magic string <code>/[A-Za-z]+-[0-9]+/</code> regex undocumented Low Complex pipe command <code>git remote show \\| grep \\| awk</code> Low <p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/","title":"SRP Violation Analysis","text":"<p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#groovyjshelpergroovy-srp-violation-analysis","title":"groovy/jsHelper.groovy - SRP Violation Analysis","text":"<p>JS Pipeline Dedicated File - CI/CD dedicated functions mixed (50% cohesion) (356 lines)</p>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#1-srp-violation-analysis-criteria","title":"1. SRP Violation Analysis Criteria","text":"<ul> <li>jsHelper Design Intent: A file that collects functions dedicated to JS pipelines (CI/CD)</li> <li>Cohesion Analysis Criteria: \"Is it used in both JS CI and JS CD?\" = Cohesion aligned with design intent</li> </ul>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#11-why-this-criteria","title":"1.1. Why This Criteria?","text":"<p>SRP asks \"who requests changes to this code?\" For a JS-dedicated helper file, the answer should be \"both JS CI and JS CD equally.\" If only one pipeline uses a function, it should be in that pipeline's code or a CI/CD-specific helper.</p>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#12-solid-principles-references","title":"1.2. SOLID Principles References","text":""},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#sources","title":"Sources","text":"<ol> <li>97 Things Every Programmer Should Know (O'Reilly, 2010)</li> <li> <p>Chapter 76: \"The Single Responsibility Principle\" by Uncle Bob</p> </li> <li> <p>Agile Principles, Patterns, and Practices in C# by Robert C. Martin (2006)</p> </li> <li>Chapter 8: \"The Single-Responsibility Principle (SRP)\"</li> </ol>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#2-cohesion-and-change-reasons-per-function","title":"2. Cohesion and Change Reasons per Function","text":"# Function Name JS CI JS CD Internal Change Reason 1 <code>logMessage</code> 9 When logging output format/style changes 2 <code>findTestingDirs</code> 1 1 When directory scanning logic changes 3 <code>getPackageJsonVersion</code> 2 When package.json version extraction changes 4 <code>installNpmInTestingDirs</code> 1 1 3 reasons:When npm audit policy changesWhen Python script interface changesWhen npm install policy changes 5 <code>runUnitTestsInTestingDirs</code> 1 1 When test execution process changes 6 <code>checkNodeVersion</code> 1 When Node.js version check logic changes 7 <code>runCommandReturnStatus</code> 4 When OS-specific command execution changes 8 <code>executeLintingInTestingDirs</code> 1 1 When linting process changes 9 <code>versionCompare</code> 2 1 When version comparison logic changes 10 <code>retrieveReportSummaryDirs</code> 2 When report file search logic changes <p>Note on Call Counts: Unlike generalHelper where we count cross-pipeline usage, jsHelper serves only 2 pipelines. The key metric is whether a function is used in both CI and CD.</p>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#3-module-level-srp-violation-analysis-cohesion-analysis-results","title":"3. Module Level SRP Violation Analysis - Cohesion Analysis Results","text":"<ul> <li>100% Usage (4): <code>findTestingDirs</code>, <code>installNpmInTestingDirs</code>, <code>runUnitTestsInTestingDirs</code>, <code>executeLintingInTestingDirs</code></li> <li>CD-only (2): <code>getPackageJsonVersion</code>, <code>versionCompare</code></li> <li>CI-only (2): <code>checkNodeVersion</code>, <code>retrieveReportSummaryDirs</code></li> <li>Internal Use (2): <code>logMessage</code>, <code>runCommandReturnStatus</code></li> </ul> <p>SRP Violation: Meets design intent of JS-dedicated file, but 50% of external functions are CI-only or CD-only (4 out of 8 external functions).</p>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#4-function-level-srp-violation-analysis-functions-with-multiple-change-reasons","title":"4. Function Level SRP Violation Analysis - Functions with Multiple Change Reasons","text":"Multi-responsibility Function: <code>installNpmInTestingDirs()</code> (3 change reasons) <pre><code>void installNpmInTestingDirs(String testingDirs) {\n    if (testingDirs == null || testingDirs.isEmpty()) {\n        echo \"Testing directories don't exist.\"\n        return\n    }\n    List&lt;String&gt; testDirs = testingDirs.split(',') as List&lt;String&gt;\n    for (String dirPath : testDirs) {\n        File dir = new File(dirPath)\n        if (!dir.exists() || !dir.isDirectory()) {\n            echo \"Directory does not exist: ${dirPath}. Skipping...\"\n            continue\n        }\n\n        // Change reason 1: npm audit policy\n        String npmAuditCommand = \"cd '${dirPath}' &amp;&amp; npm audit --json &gt; audit-report.json\"\n        echo \"Running command: ${npmAuditCommand}\"\n        int exitCode = runCommandReturnStatus(npmAuditCommand)\n        if (exitCode != 0) {\n            echo \"npm audit failed in directory: ${dirPath} with exit code: ${exitCode}. Proceeding with caution.\"\n        }\n\n        // Change reason 2: Python script interface\n        File reportFile = new File(\"${dirPath}/audit-report.json\")\n        if (reportFile.exists()) {\n            String pythonCommand = \"\"\"python '${WORKSPACE}/python/npm_audit.py'\n            '${COMMIT_HASH}' '${dirPath}/audit-report.json'\n            \"\"\"\n            exitCode = sh(script: pythonCommand, returnStatus: true)\n            // ...\n        }\n\n        // Change reason 3: npm install command\n        String npmCommand = \"cd '${dirPath}' &amp;&amp; npm install\"\n        exitCode = runCommandReturnStatus(npmCommand)\n        // ...\n    }\n}\n</code></pre> <p>Change Reason Analysis: 1. When npm audit policy changes: audit command, options, report format 2. When Python script interface changes: <code>npm_audit.py</code> argument format 3. When npm install command changes: install options, error handling</p>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#conclusion","title":"Conclusion","text":"<p>SRP Violation: - Module Level: JS-dedicated but CI/CD-specific functions mixed (50% cohesion for external functions) - Function Level: 1 function has multiple change reasons (<code>installNpmInTestingDirs</code>(3)) - <code>logMessage()</code> is an exact copy of generalHelper (DRY violation)</p>"},{"location":"problem-analysis/02-jsHelper/01-srp-violation-analysis/#next-why-software-smells-analysis","title":"Next: Why Software Smells Analysis?","text":"<p>SRP analysis identified what violates design intent. The next document classifies these violations using industry-standard taxonomy (Fowler, Suryanarayana) to provide shared vocabulary for discussing the problems.</p> <p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/","title":"Software Smells Analysis","text":"<p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#groovyjshelpergroovy-software-smells-analysis","title":"groovy/jsHelper.groovy - Software Smells Analysis","text":"<p>Classification based on industry-standard taxonomy: Code Smells (Fowler) \u2192 Design Smells (Suryanarayana)</p> <p>Domain Classification: 4 domains, 10 functions. See Domain Mapping</p>"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#1-code-smells","title":"1. Code Smells","text":"<p>Source: Fowler, M. (1999). Refactoring: Improving the Design of Existing Code</p> <p>Applicable Categories: Since Jenkins Pipeline Helper files are procedural scripts, only the following categories are applicable:</p> Category Applicable Applied Smells Bloaters \u2713 Long Method, Switch Statements Change Preventers \u2713 Divergent Change, Shotgun Surgery Dispensables \u2717 (no Dead Code or Duplicated Code found) Object-Orientation Abusers \u2717 (not applicable - no inheritance/polymorphism) Couplers \u2717 (not applicable - no class relationships)"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#11-change-preventers-with-severity-criteria","title":"1.1 Change Preventers (with Severity Criteria)","text":""},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#severity-criteria","title":"Severity Criteria","text":"Metric Low Medium High Impact Scope 1 pipeline 2 pipelines - Modification Cost 1-2 locations 3-5 locations 6+ locations <p>Note: unityHelper serves only 2 pipelines (DLX CI, DLX CD), so Impact Scope is capped at Medium.</p>"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#divergent-change-scope-file-level","title":"Divergent Change (Scope: File Level)","text":"<p> Click to see details <p>Definition: \"A single class/file is frequently changed for several different reasons\"</p> <p>Divergent Change Cases in unityHelper.groovy:</p> Change Reason Affected Functions Count Unity batch mode CLI change <code>runUnityBatchMode</code>, <code>getCodeCoverageArguments</code>, <code>fetCoverageOptionsKeyAndValue</code>, <code>buildCoverageOptions</code> 4 Python script interface change <code>sendTestReport</code>, <code>getUnityExecutable</code> 2 Bitbucket report format change <code>sendTestReport</code> 1 Unity Code Coverage settings change <code>loadPathsToExclude</code>, <code>getCodeCoverageArguments</code> 2 <p>Severity Evidence: - Impact Scope: Medium (2 pipelines depend on this file) - Modification Cost: Medium (4 different change reasons in single file)</p>"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#shotgun-surgery-scope-cross-file","title":"Shotgun Surgery (Scope: Cross-file)","text":"<p> Click to see details <p>Definition: \"A single change requires modifications to multiple files\"</p> <p>Shotgun Surgery Cases in jsHelper.groovy:</p> Function JS CI JS CD Total Locations <code>findTestingDirs</code> 1 1 2 <code>installNpmInTestingDirs</code> 1 1 2 <code>runUnitTestsInTestingDirs</code> 1 1 2 <code>executeLintingInTestingDirs</code> 1 1 2 <p>Severity Evidence: - Impact Scope: Medium (2 pipelines depend on this helper) - Modification Cost: Low (maximum 2 locations per function)</p>"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#12-other-code-smells-evidence-only","title":"1.2 Other Code Smells (Evidence Only)","text":""},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#bloaters","title":"Bloaters","text":"Smell Evidence Long Method <code>installNpmInTestingDirs</code> (52 lines, 3 responsibilities), <code>versionCompare</code> (45 lines) Primitive Obsession <code>\"Testing directories don't exist.\"</code> (3x), <code>\"Directory does not exist: ${dirPath}. Skipping...\"</code> (2x) Data Clumps <code>(String testingDirs, boolean deploymentBuild)</code> parameter pair in 2 functions"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#dispensables","title":"Dispensables","text":"Smell Evidence Duplicated Code <code>logMessage</code> exact copy from generalHelper Duplicated Code <code>testingDirs.split(',') as List&lt;String&gt;</code> pattern (3x) Duplicated Code Directory existence validation pattern (2x)"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#2-design-smells-principle-based","title":"2. Design Smells (Principle-Based)","text":"<p>Source: Suryanarayana, G. et al. (2014). Refactoring for Software Design Smells</p> <p>Applicable Categories: Since Jenkins Pipeline Helper files are procedural scripts, only the following categories are applicable:</p> Category Applicable Applied Smells Abstraction \u2713 Multifaceted Abstraction Encapsulation \u2713 Missing Encapsulation Modularization \u2717 (file size 356 lines is acceptable) Hierarchy \u2717 (no conditional branch patterns like unityHelper)"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#21-abstraction-smells","title":"2.1 Abstraction Smells","text":""},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#multifaceted-abstraction","title":"Multifaceted Abstraction","text":"<p> Click to see details <p>Definition: \"An abstraction has multiple responsibilities assigned to it\"</p> <p>Evidence: - 4 domains in single file: Node.js/npm, File System, Utility, Logging - 10 functions across 4 different domains</p>"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#22-encapsulation-smells","title":"2.2 Encapsulation Smells","text":""},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#missing-encapsulation","title":"Missing Encapsulation","text":"<p> Click to see details <p>Definition: \"The encapsulation of implementation variations in a type is missing\"</p> <p>Evidence:</p> Pattern Occurrences Affected Functions <code>testingDirs.split(',') as List&lt;String&gt;</code> 3 <code>installNpmInTestingDirs</code>, <code>runUnitTestsInTestingDirs</code>, <code>executeLintingInTestingDirs</code> Directory existence validation 2 <code>installNpmInTestingDirs</code>, <code>runUnitTestsInTestingDirs</code>"},{"location":"problem-analysis/02-jsHelper/02-software-smells-analysis/#conclusion","title":"Conclusion","text":"<p>Software Smells Summary: - Code Level: Shotgun Surgery (Low - max 2 locations), Long Method (2 functions), Duplicated Code (<code>logMessage</code> copy, validation patterns) - Design Level: 4 domains mixed, repeated patterns not encapsulated</p> <p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/","title":"Design Smells Analysis","text":"<p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#groovyjshelpergroovy-design-smells-symptoms-analysis","title":"groovy/jsHelper.groovy - Design Smells Symptoms Analysis","text":"<p>Source: Martin, R.C. (2000). Design Principles and Design Patterns</p> <p>This document analyzes Martin's 7 Design Symptoms using evidence from: - SRP Violation Analysis: Cohesion metrics, multi-responsibility functions - Software Smells Analysis: Code Smells (Fowler), Design Smells (Suryanarayana) - Direct code review: Readability, naming, complexity issues</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#1-rigidity","title":"1. Rigidity","text":"<p>Definition: Changing one place requires cascading changes to other places</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#contributing-smells","title":"Contributing Smells","text":"Smell Evidence Impact Shotgun Surgery <code>testingDirs</code> format change \u2192 3 functions Low Primitive Obsession <code>\"Testing directories don't exist.\"</code> (3x) Low Missing Encapsulation <code>testingDirs.split(',')</code> pattern (3x) Low"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#2-fragility","title":"2. Fragility","text":"<p>Definition: Modifying one place breaks conceptually unrelated places</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#contributing-smells_1","title":"Contributing Smells","text":"Smell Evidence Risk Shotgun Surgery Miss one of 3 <code>testingDirs.split()</code> locations \u2192 inconsistent behavior Low Missing Encapsulation Update validation in 2 places, forget 1 \u2192 silent failure Low"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#3-immobility","title":"3. Immobility","text":"<p>Definition: Difficult to extract useful parts for reuse in other systems/modules</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#contributing-smells_2","title":"Contributing Smells","text":"Smell Evidence Impact Multifaceted Abstraction 4 domains mixed (Node.js/npm, File System, Utility, Logging) Medium Duplicated Code <code>logMessage</code> copy from generalHelper \u2192 can't share Low"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#4-viscosity","title":"4. Viscosity","text":"<p>Definition: Doing the right thing (maintaining design) is harder than doing the wrong thing (hacking)</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#contributing-smells_3","title":"Contributing Smells","text":"Smell Evidence Impact Missing Encapsulation <code>testingDirs.split(',')</code> not encapsulated \u2192 copy-paste easier Medium Primitive Obsession Hardcoded strings \u2192 copy existing easier than creating constant Low Duplicated Code Validation pattern (3x) \u2192 duplication pattern already established Medium"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#5-needless-complexity","title":"5. Needless Complexity","text":"<p>Definition: Over-engineering for features not currently needed</p> <p>Symptom: \"I might need this later\" (YAGNI violation)</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#evidence","title":"Evidence","text":"<p>No clear evidence of over-engineering found in jsHelper.groovy.</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#6-needless-repetition","title":"6. Needless Repetition","text":"<p>Definition: Code that could be unified through abstraction is duplicated in multiple places</p> <p>Symptom: \"Same code in multiple places\" (DRY violation)</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#contributing-smells_4","title":"Contributing Smells","text":"Smell Evidence Impact Duplicated Code <code>logMessage</code> exact copy from generalHelper Medium Duplicated Code <code>testingDirs.split(',') as List&lt;String&gt;</code> pattern (3x) Medium Duplicated Code Directory existence validation pattern (2x) Low"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#7-opacity","title":"7. Opacity","text":"<p>Definition: Code is difficult to understand and intent is unclear</p> <p>Symptom: \"What does this code do?\"</p>"},{"location":"problem-analysis/02-jsHelper/03-design-smells-symptoms/#evidence-code-review","title":"Evidence (Code Review)","text":"Issue Evidence Impact Hidden data structure <code>testingDirs: String</code> hides that it's a comma-separated list Medium Counter-intuitive flow npm audit failure continues silently (warning only) Medium Name-message mismatch Message says \"jest\" but calls <code>npm run test</code> Low Incomplete implementation Windows <code>bat()</code> ignores <code>workingDir</code> parameter Medium Counter-intuitive name <code>versionCompare</code> return meaning unclear Low <p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/","title":"SRP Violation Analysis","text":"<p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#groovyunityhelpergroovy-srp-violation-analysis","title":"groovy/unityHelper.groovy - SRP Violation Analysis","text":"<p>DLX Pipeline Dedicated File - CI-only functions mixed (50% cohesion) (357 lines)</p>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#1-srp-violation-analysis-criteria","title":"1. SRP Violation Analysis Criteria","text":"<ul> <li>unityHelper Design Intent: A file that collects functions dedicated to DLX (Unity) pipelines (CI/CD)</li> <li>Cohesion Analysis Criteria: \"Is it used in both DLX CI and DLX CD?\" = Cohesion aligned with design intent</li> </ul>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#11-why-this-criteria","title":"1.1. Why This Criteria?","text":"<p>SRP asks \"who requests changes to this code?\" For a DLX-dedicated helper file, the answer should be \"both DLX CI and DLX CD equally.\" If only one pipeline uses a function (like Code Coverage), it should be in CI-specific code.</p>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#12-solid-principles-references","title":"1.2. SOLID Principles References","text":""},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#sources","title":"Sources","text":"<ol> <li>97 Things Every Programmer Should Know (O'Reilly, 2010)</li> <li> <p>Chapter 76: \"The Single Responsibility Principle\" by Uncle Bob</p> </li> <li> <p>Agile Principles, Patterns, and Practices in C# by Robert C. Martin (2006)</p> </li> <li>Chapter 8: \"The Single-Responsibility Principle (SRP)\"</li> </ol>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#2-cohesion-and-change-reasons-per-function","title":"2. Cohesion and Change Reasons per Function","text":"# Function Name DLX CI DLX CD Internal Change Reason 1 <code>sendTestReport</code> 1 When Bitbucket test report Python script interface changes 2 <code>getUnityExecutable</code> 2 1 2 reasons:When Unity version Python script changesWhen Unity Hub CLI installation changes 3 <code>runUnityStage</code> 5 4 When Unity batch mode error handling policy changes 4 <code>runUnityBatchMode</code> 2 7+ reasons:When log path rules changeWhen test platform options changeWhen coverage options changeWhen Stage-specific args changeWhen Unity CLI options changeWhen xvfb-run settings changeWhen new Stage added 5 <code>getCodeCoverageArguments</code> 2 When Unity Code Coverage package options change 6 <code>fetCoverageOptionsKeyAndValue</code> 2 When Stage-specific coverage option rules change 7 <code>loadPathsToExclude</code> 2 When Unity Code Coverage Settings.json structure changes 8 <code>buildCoverageOptions</code> 2 When coverage options string format changes <p>Note on Call Counts: Unlike generalHelper where we count cross-pipeline usage, unityHelper serves only 2 pipelines (DLX CI, DLX CD). The key metric is whether a function is used in both CI and CD.</p>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#3-module-level-srp-violation-analysis-cohesion-analysis-results","title":"3. Module Level SRP Violation Analysis - Cohesion Analysis Results","text":"<ul> <li>100% Usage (2): <code>getUnityExecutable</code>, <code>runUnityStage</code></li> <li>CI-only (1): <code>sendTestReport</code></li> <li>Internal Use (5): <code>runUnityBatchMode</code>, <code>getCodeCoverageArguments</code>, <code>fetCoverageOptionsKeyAndValue</code>, <code>loadPathsToExclude</code>, <code>buildCoverageOptions</code></li> </ul> <p>SRP Violation: DLX-dedicated but only 2 out of 8 functions (25%) are used in both pipelines. 5 functions are internal-only, 1 is CI-only.</p>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#4-function-level-srp-violation-analysis-functions-with-multiple-change-reasons","title":"4. Function Level SRP Violation Analysis - Functions with Multiple Change Reasons","text":"Multi-responsibility Function: <code>getUnityExecutable()</code> (2 change reasons) <pre><code>String getUnityExecutable(workspace, projectDir) {\n    try {\n        // Change reason 1: Unity version Python script\n        def unityExecutable = sh(script: \"python '${workspace}/python/get_unity_version.py' '${projectDir}' executable-path\",\n        returnStdout: true).trim()\n\n        if (!fileExists(unityExecutable)) {\n            def version = sh(script: \"python '${workspace}/python/get_unity_version.py' '${projectDir}' version\",\n             returnStdout: true).trim()\n            def revision = sh(script: \"python '${workspace}/python/get_unity_version.py' '${projectDir}' revision\",\n             returnStdout: true).trim()\n\n            // Change reason 2: Unity Hub CLI installation command\n            echo \"Unity Editor version ${version} not found. Attempting installation...\"\n            def installCommand = \"\"\"\\\"C:\\\\Program Files\\\\Unity Hub\\\\Unity Hub.exe\\\" \\\\\n            -- --headless install \\\\\n            --version ${version} \\\\\n            --changeset ${revision}\"\"\"\n            def exitCode = sh(script: installCommand, returnStatus: true)\n            // ...\n        }\n        return unityExecutable\n    } catch (Exception e) {\n        error(\"An error occurred while retrieving or installing Unity executable: ${e.getMessage()}\")\n    }\n}\n</code></pre> <p>Change Reason Analysis: 1. When Unity version Python script changes: <code>get_unity_version.py</code> arguments/output format 2. When Unity Hub CLI installation command changes: Unity Hub path, CLI options, module installation</p> Multi-responsibility Function: <code>runUnityBatchMode()</code> (7+ change reasons) <p>This function has 126 lines with 7 distinct responsibilities:</p> # Responsibility Location Change Trigger 1 Log path setup <code>setLogFilePathAndUrl</code> closure Stage-specific log path rules 2 Test arguments <code>getTestRunArgs</code> closure Test platform options 3 Additional arguments <code>getAdditionalArgs</code> closure WebGL/Rider specific args 4 Base command Lines 203-206 Unity CLI options 5 Coverage arguments Lines 209-213 Code Coverage package 6 Graphics options Lines 229-231 xvfb-run settings 7 New Stage support All conditionals Every new Stage type <p>Shotgun Surgery Risk: Adding new Stage \"Android\" requires modifying 7 locations simultaneously.</p>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#conclusion","title":"Conclusion","text":"<p>SRP Violation: - Module Level: DLX-dedicated but only 25% cohesion (2 out of 8 functions used in both pipelines). 5 functions are internal-only, 1 is CI-only. - Function Level: 2 functions have multiple change reasons (<code>getUnityExecutable</code>(2), <code>runUnityBatchMode</code>(7+)) - <code>runUnityBatchMode</code> is a Long Method (126 lines) with Shotgun Surgery risk (7 locations when adding Stage)</p>"},{"location":"problem-analysis/03-unityHelper/01-srp-violation-analysis/#next-why-software-smells-analysis","title":"Next: Why Software Smells Analysis?","text":"<p>SRP analysis identified what violates design intent. The next document classifies these violations using industry-standard taxonomy (Fowler, Suryanarayana) to provide shared vocabulary for discussing the problems.</p> <p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/","title":"Software Smells Analysis","text":"<p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#groovyunityhelpergroovy-software-smells-analysis","title":"groovy/unityHelper.groovy - Software Smells Analysis","text":"<p>Classification based on industry-standard taxonomy: Code Smells (Fowler) \u2192 Design Smells (Suryanarayana)</p> <p>Domain Classification: 3 domains, 8 functions. See Domain Mapping</p>"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#1-code-smells","title":"1. Code Smells","text":"<p>Source: Fowler, M. (1999). Refactoring: Improving the Design of Existing Code</p> <p>Applicable Categories: Since Jenkins Pipeline Helper files are procedural scripts, only the following categories are applicable:</p> Category Applicable Applied Smells Bloaters \u2713 Long Method, Switch Statements Change Preventers \u2713 Divergent Change, Shotgun Surgery Dispensables \u2717 (no Dead Code or Duplicated Code found) Object-Orientation Abusers \u2717 (not applicable - no inheritance/polymorphism) Couplers \u2717 (not applicable - no class relationships)"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#11-change-preventers-with-severity-criteria","title":"1.1 Change Preventers (with Severity Criteria)","text":""},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#severity-criteria","title":"Severity Criteria","text":"Metric Low Medium High Impact Scope 1 pipeline 2 pipelines - Modification Cost 1-2 locations 3-5 locations 6+ locations <p>Note: unityHelper serves only 2 pipelines (DLX CI, DLX CD), so Impact Scope is capped at Medium.</p>"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#divergent-change-scope-file-level","title":"Divergent Change (Scope: File Level)","text":"<p> Click to see details <p>Definition: \"A single class/file is frequently changed for several different reasons\"</p> <p>Divergent Change Cases in unityHelper.groovy:</p> Change Reason Affected Functions Count Unity batch mode CLI change <code>runUnityBatchMode</code>, <code>getCodeCoverageArguments</code>, <code>fetCoverageOptionsKeyAndValue</code>, <code>buildCoverageOptions</code> 4 Python script interface change <code>sendTestReport</code>, <code>getUnityExecutable</code> 2 Bitbucket report format change <code>sendTestReport</code> 1 Unity Code Coverage settings change <code>loadPathsToExclude</code>, <code>getCodeCoverageArguments</code> 2 <p>Severity Evidence: - Impact Scope: Medium (2 pipelines depend on this file) - Modification Cost: Medium (4 different change reasons in single file)</p>"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#shotgun-surgery","title":"Shotgun Surgery","text":"<p> Click to see details <p>Definition: \"A single change requires modifications to multiple locations\"</p> <p>Cross-file (helper function signature change):</p> Function DLX CI DLX CD Total Locations <code>runUnityStage</code> 5 4 9 <code>getUnityExecutable</code> 2 1 3 <p>Within-file (adding new Stage):</p> # Location Change Required 1 Stage constant definition Add <code>this.ANDROID = 'Android'</code> 2 <code>setLogFilePathAndUrl</code> mapping Add <code>(ANDROID): [path: ..., url: ...]</code> 3 <code>getTestRunArgs</code> condition Decide whether to include Android 4 <code>getCodeCoverageArguments</code> condition Decide whether to include Android 5 <code>getAdditionalArgs</code> mapping Add <code>Android: '...'</code> 6 Command assembly branch Add else if 7 Graphics/quit options Add Android condition <p>Severity Evidence: - Impact Scope: Medium (2 pipelines) - Modification Cost: High (9 cross-file + 7 within-file)</p>"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#12-other-code-smells-evidence-only","title":"1.2 Other Code Smells (Evidence Only)","text":""},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#bloaters","title":"Bloaters","text":"Smell Evidence Long Method <code>runUnityBatchMode</code> (126 lines, 7 responsibilities) Switch Statements Stage-specific conditionals repeated in 9 locations <p> Switch Statements 9 locations # Location Code Line 1 Test arguments <code>[EDIT_MODE, PLAY_MODE].contains(stageName)</code> 209 2 Coverage arguments <code>[EDIT_MODE, PLAY_MODE, COVERAGE].contains(stageName)</code> 212 3 Additional arguments <code>[WEBGL, RIDER].contains(stageName)</code> 216 4 Command assembly (EditMode/PlayMode) <code>if ([EDIT_MODE, PLAY_MODE].contains(stageName))</code> 220 5 Command assembly (Coverage) <code>else if (stageName == COVERAGE)</code> 222 6 Command assembly (WebGL/Rider) <code>else if ([WEBGL, RIDER].contains(stageName))</code> 224 7 Graphics options <code>(stageName != WEBGL &amp;&amp; stageName != PLAY_MODE)</code> 229 8 Quit options <code>(stageName != PLAY_MODE &amp;&amp; stageName != EDIT_MODE)</code> 233 9 Coverage options <code>if ([EDIT_MODE, PLAY_MODE].contains(stageName))</code> 303"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#2-design-smells-principle-based","title":"2. Design Smells (Principle-Based)","text":"<p>Source: Suryanarayana, G. et al. (2014). Refactoring for Software Design Smells</p> <p>Applicable Categories: Since Jenkins Pipeline Helper files are procedural scripts, the following categories are applicable:</p> Category Applicable Applied Smells Abstraction \u2713 Multifaceted Abstraction Encapsulation \u2713 Missing Encapsulation Modularization \u2717 (file size 357 lines is acceptable) Hierarchy \u2713 Missing Hierarchy (Strategy pattern applicable)"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#21-abstraction-smells","title":"2.1 Abstraction Smells","text":""},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#multifaceted-abstraction","title":"Multifaceted Abstraction","text":"<p> Click to see details <p>Definition: \"An abstraction has multiple responsibilities assigned to it\"</p> <p>Evidence: - 3 domains in single file: Unity CLI (6), Unity Installation (1), Bitbucket (1) - 8 functions across 3 different domains</p>"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#22-encapsulation-smells","title":"2.2 Encapsulation Smells","text":""},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#missing-encapsulation","title":"Missing Encapsulation","text":"<p> Click to see details <p>Definition: \"The encapsulation of implementation variations in a type is missing\"</p> <p>Evidence: Stage-specific conditional branches scattered:</p> Location Stage Logic Lines Log path mapping <code>Map logConfig = [(EDIT_MODE): [...], ...]</code> 139-160 Test arguments <code>[EDIT_MODE, PLAY_MODE].contains(stageName)</code> 209 Coverage arguments <code>[EDIT_MODE, PLAY_MODE, COVERAGE].contains(stageName)</code> 212 Additional arguments <code>[WEBGL, RIDER].contains(stageName)</code> 216 Command assembly <code>if ([EDIT_MODE, PLAY_MODE].contains(stageName)) {...}</code> 220-226 Graphics options <code>(stageName != WEBGL &amp;&amp; stageName != PLAY_MODE)</code> 229-233 Coverage options <code>if ([EDIT_MODE, PLAY_MODE].contains(stageName)) {...}</code> 303-310 <p>Impact: Adding new Stage \"Android\" requires modifying all 7 locations</p>"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#23-hierarchy-smells","title":"2.3 Hierarchy Smells","text":""},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#missing-hierarchy","title":"Missing Hierarchy","text":"<p> Click to see details <p>Definition: \"Conditional logic is used instead of subclasses or delegation\"</p> <p>Evidence: Stage-specific branches can be replaced with Strategy pattern:</p> Current Branch Pattern Strategy Replacement <code>[EDIT_MODE, PLAY_MODE].contains(stageName)</code> <code>stage.requiresTestRun()</code> <code>[EDIT_MODE, PLAY_MODE, COVERAGE].contains(stageName)</code> <code>stage.requiresCoverage()</code> <code>[WEBGL, RIDER].contains(stageName)</code> <code>stage.getAdditionalArgs()</code> <code>stageName != WEBGL &amp;&amp; stageName != PLAY_MODE</code> <code>stage.requiresNographics()</code> <code>stageName != PLAY_MODE &amp;&amp; stageName != EDIT_MODE</code> <code>stage.requiresQuit()</code>"},{"location":"problem-analysis/03-unityHelper/02-software-smells-analysis/#conclusion","title":"Conclusion","text":"<p>Software Smells Summary: - Code Level: Divergent Change (4 change reasons), Shotgun Surgery (9 cross-file + 7 within-file), Long Method (126 lines, 7 responsibilities), Switch Statements (9 locations) - Design Level: 3 domains mixed, Stage-specific logic not encapsulated, Missing Hierarchy (Strategy pattern applicable)</p> <p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/","title":"Design Smells Analysis","text":"<p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#groovyunityhelpergroovy-design-smells-symptoms-analysis","title":"groovy/unityHelper.groovy - Design Smells Symptoms Analysis","text":"<p>Source: Martin, R.C. (2000). Design Principles and Design Patterns</p> <p>This document analyzes Martin's 7 Design Symptoms using evidence from: - SRP Violation Analysis: Cohesion metrics, multi-responsibility functions - Software Smells Analysis: Code Smells (Fowler), Design Smells (Suryanarayana) - Direct code review: Readability, naming, complexity issues</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#1-rigidity","title":"1. Rigidity","text":"<p>Definition: Changing one place requires cascading changes to other places</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#contributing-smells","title":"Contributing Smells","text":"Smell Evidence Impact Shotgun Surgery (Cross-file) <code>runUnityStage</code> change \u2192 9 locations across 2 pipelines High Shotgun Surgery (Within-file) Adding new Stage \u2192 7 locations High Switch Statements Stage-specific conditionals in 9 locations High"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#2-fragility","title":"2. Fragility","text":"<p>Definition: Modifying one place breaks conceptually unrelated places</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#contributing-smells_1","title":"Contributing Smells","text":"Smell Evidence Risk Shotgun Surgery Miss one of 7 Stage locations \u2192 inconsistent behavior High Missing Encapsulation Update Stage logic in 6 places, forget 1 \u2192 runtime failure Medium Switch Statements Change one conditional pattern, forget others \u2192 silent failure Medium"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#3-immobility","title":"3. Immobility","text":"<p>Definition: Difficult to extract useful parts for reuse in other systems/modules</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#contributing-smells_2","title":"Contributing Smells","text":"Smell Evidence Impact Multifaceted Abstraction 3 domains mixed (Unity CLI 6, Unity Installation 1, Bitbucket 1) Medium Missing Hierarchy Stage conditionals tightly coupled \u2192 extracting one brings all Medium"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#4-viscosity","title":"4. Viscosity","text":"<p>Definition: Doing the right thing (maintaining design) is harder than doing the wrong thing (hacking)</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#contributing-smells_3","title":"Contributing Smells","text":"Smell Evidence Impact Missing Encapsulation Stage conditionals not encapsulated \u2192 copy-paste easier High Missing Hierarchy Strategy pattern proper but complex \u2192 copying conditionals faster High Switch Statements 9 locations already duplicated \u2192 pattern established High"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#5-needless-complexity","title":"5. Needless Complexity","text":"<p>Definition: Over-engineering for features not currently needed</p> <p>Symptom: \"I might need this later\" (YAGNI violation)</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#evidence","title":"Evidence","text":"<p>No clear evidence of over-engineering found in unityHelper.groovy.</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#6-needless-repetition","title":"6. Needless Repetition","text":"<p>Definition: Code that could be unified through abstraction is duplicated in multiple places</p> <p>Symptom: \"Same code in multiple places\" (DRY violation)</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#contributing-smells_4","title":"Contributing Smells","text":"Smell Evidence Impact Switch Statements <code>[EDIT_MODE, PLAY_MODE].contains(stageName)</code> (3x), <code>stageName == COVERAGE</code> (2x), <code>[WEBGL, RIDER].contains(stageName)</code> (2x) High Missing Hierarchy Same Stage logic repeated instead of encapsulated in Stage objects High"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#7-opacity","title":"7. Opacity","text":"<p>Definition: Code is difficult to understand and intent is unclear</p> <p>Symptom: \"What does this code do?\"</p>"},{"location":"problem-analysis/03-unityHelper/03-design-smells-symptoms/#evidence-code-review","title":"Evidence (Code Review)","text":"Issue Evidence Impact Complex nested condition <code>if (exitCode == 0) ... else if (CI_PIPELINE) ...</code> 3-level nesting (lines 98-105) Medium Complex Map structure <code>logConfig</code> Map with Stage-specific settings (lines 139-160) Medium Complex JSON parsing <code>m_Dictionary.m_DictionaryValues</code> path in Settings.json (lines 320-340) Medium <p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/01-srp-violation-analysis/","title":"SRP Violation Analysis","text":"<p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/01-srp-violation-analysis/#dlxjenkinsjenkinsfile-srp-violation-analysis","title":"DLXJenkins/Jenkinsfile - SRP Violation Analysis","text":"<p>Pipeline Role: Orchestration only (sequence/flow control)</p> <p>SRP Violation: If inline code exists in Jenkinsfile, it violates orchestration-only principle</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/01-srp-violation-analysis/#1-srp-violation-analysis-criteria","title":"1. SRP Violation Analysis Criteria","text":"<ul> <li>Jenkinsfile Role: Orchestration (pipeline sequence/flow control)</li> <li>SRP Violation Condition: If actual logic exists in Jenkinsfile (not Helper calls)</li> <li>Analysis Method: Stage-by-Stage inline code detection</li> </ul>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/01-srp-violation-analysis/#2-inline-code-analysis-by-stage","title":"2. Inline Code Analysis by Stage","text":"Stage Inline Code Type Count Prepare WORKSPACE stageName/errorMsg hardcoded 1 Linting File System (<code>mkdir</code>, <code>cp</code>) + Bash script + exitCode branch + Python script 5 EditMode Tests File System (<code>mkdir</code> 2x) + stageName/errorMsg 3 PlayMode Tests stageName/errorMsg 1 Code Coverage stageName/errorMsg 1 Build Project File System (<code>mkdir</code>, <code>cp</code>) + stageName/errorMsg + DEBUG_MODE + Python script 5"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/01-srp-violation-analysis/#3-inline-code-details-by-stage","title":"3. Inline Code Details by Stage","text":"<code>Prepare WORKSPACE</code> stage (1 inline code) <pre><code>script {\n    String stageName = 'Rider'  // Inline: stageName hardcoded\n    String errorMassage = 'Synchronizing Unity and Rider IDE solution files failed'\n    unityUtil.runUnityStage(stageName, errorMassage)\n}\n</code></pre> <code>Linting</code> stage (5 inline codes) - Most Severe <pre><code>dir(\"${REPORT_DIR}\") {\n    sh 'mkdir -p linting_results'  // Inline 1: File System\n}\n\nscript {\n    sh \"cp -f '${env.WORKSPACE}/Bash/.editorconfig' '${PROJECT_DIR}' 2&gt;/dev/null\"  // Inline 2: File System\n\n    def exitCode = sh script: \"\"\" sh '${env.WORKSPACE}/Bash/Linting.bash' \\\\\n        '${PROJECT_DIR}' '${REPORT_DIR}/linting_results'\"\"\", returnStatus: true  // Inline 3: Bash script call\n\n    if (exitCode != 0) {  // Inline 4: exitCode branch logic\n        if (exitCode == 2) {\n            sh script: \"\"\"python '${env.WORKSPACE}/python/linting_error_report.py' \\\\\n                '${REPORT_DIR}/linting_results/format-report.json' \\\\\n                ${COMMIT_HASH} ${fail} '${PROJECT_DIR}'\"\"\"  // Inline 5: Python script call\n        }\n        // ...\n    }\n}\n</code></pre> <code>EditMode Tests</code> stage (3 inline codes) <pre><code>dir(\"${REPORT_DIR}\") {\n    sh 'mkdir -p test_results'      // Inline 1: File System\n    sh 'mkdir -p coverage_results'  // Inline 2: File System\n}\n\nscript {\n    String stageName = 'EditMode'  // Inline 3: stageName hardcoded\n    String errorMassage = 'EditMode tests failed'\n    unityUtil.runUnityStage(stageName, errorMassage)\n}\n</code></pre> <code>PlayMode Tests</code> stage (1 inline code) <pre><code>script {\n    String stageName = 'PlayMode'  // Inline: stageName hardcoded\n    String errorMassage = 'PlayMode tests failed'\n    unityUtil.runUnityStage(stageName, errorMassage)\n}\n</code></pre> <code>Code Coverage</code> stage (1 inline code) <pre><code>script {\n    String stageName = 'Coverage'  // Inline: stageName hardcoded\n    String errorMassage = 'Code Coverage generation failed'\n    unityUtil.runUnityStage(stageName, errorMassage)\n}\n</code></pre> <code>Build Project</code> stage (5 inline codes) <pre><code>script {\n    sh \"mkdir -p \\\"${PROJECT_DIR}/Assets/Editor/\\\"\"  // Inline 1: File System\n    sh \"cp Builder.cs \\\"${PROJECT_DIR}/Assets/Editor/\\\"\"  // Inline 2: File System\n\n    String stageName = 'Webgl'  // Inline 3: stageName hardcoded\n    String errorMassage = 'WebGL Build failed'\n    unityUtil.runUnityStage(stageName, errorMassage)\n\n    if ((params.DEBUG_MODE ?: '').toUpperCase() == 'Y') {  // Inline 4: DEBUG_MODE branch\n        pythonArgs += ' --debug'\n    }\n\n    sh \" python ${env.WORKSPACE}/python/create_bitbucket_webgl_build_report.py ${pythonArgs}\"  // Inline 5: Python script call\n}\n</code></pre>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/01-srp-violation-analysis/#4-inline-code-summary","title":"4. Inline Code Summary","text":"Type Count Stages stageName/errorMsg hardcoded 5 Prepare WORKSPACE, EditMode, PlayMode, Coverage, Build File System (<code>mkdir</code>, <code>cp</code>) 6 Linting, EditMode, Build Bash/Python script direct call 3 Linting (2), Build (1) Branch logic (exitCode, DEBUG_MODE) 2 Linting, Build"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/01-srp-violation-analysis/#conclusion","title":"Conclusion","text":"<p>SRP Violation: - Total 16 inline codes across 6 stages - Linting Stage: Most severe (5 inline codes including exitCode branch logic) - Build Project Stage: Second most severe (5 inline codes) - Common pattern: stageName/errorMsg hardcoded in 5 stages (should be constant or config) - Recommendation: Extract File System operations, Bash/Python script calls, and branch logic to Helper functions</p> <p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/","title":"Software Smells Analysis","text":"<p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#dlxjenkinsjenkinsfile-software-smells-analysis","title":"DLXJenkins/Jenkinsfile - Software Smells Analysis","text":"<p>Classification based on industry-standard taxonomy: Code Smells (Fowler) \u2192 Design Smells (Suryanarayana)</p> <p>Inline Code Analysis: 16 inline codes across 6 stages. See SRP Violation Analysis</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#1-code-smells","title":"1. Code Smells","text":"<p>Source: Fowler, M. (1999). Refactoring: Improving the Design of Existing Code</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, only the following categories are applicable:</p> Category Applicable Applied Smells Bloaters \u2713 Primitive Obsession Object-Orientation Abusers \u2717 (not applicable - no OOP) Change Preventers \u2713 Divergent Change, Shotgun Surgery Dispensables \u2713 Duplicated Code Couplers \u2717 (not applicable - no class relationships)"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#11-change-preventers-with-severity-criteria","title":"1.1 Change Preventers (with Severity Criteria)","text":""},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#severity-criteria","title":"Severity Criteria","text":"Metric Low Medium High Impact Scope 1-2 stages 3-4 stages 5+ stages Modification Cost 1-2 locations 3-5 locations 6+ locations"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#divergent-change-scope-file-level","title":"Divergent Change (Scope: File Level)","text":"<p> Click to see details <p>Definition: \"A single class/file is frequently changed for several different reasons\"</p> <p>Divergent Change Cases in DLXJenkins/Jenkinsfile:</p> Change Reason Affected Stages Count Unity Stage settings change Prepare, EditMode, PlayMode, Coverage, Build 5 File System structure change Linting, EditMode, Build 3 Python script interface change Linting, Build 2 Linting policy change Linting 1 <p>Severity Evidence: - Impact Scope: High (5 stages affected by Unity Stage changes) - Modification Cost: High (4 different change reasons in single file)</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#shotgun-surgery-scope-within-file","title":"Shotgun Surgery (Scope: Within-file)","text":"<p> Click to see details <p>Definition: \"A single change requires modifications to multiple locations\"</p> <p>Shotgun Surgery: stageName/errorMsg change:</p> Stage Lines stageName errorMsg Prepare WORKSPACE 112-114 <code>'Rider'</code> <code>'Synchronizing Unity and Rider IDE solution files failed'</code> EditMode Tests 181-183 <code>'EditMode'</code> <code>'EditMode tests failed'</code> PlayMode Tests 195-197 <code>'PlayMode'</code> <code>'PlayMode tests failed'</code> Code Coverage 209-211 <code>'Coverage'</code> <code>'Code Coverage generation failed'</code> Build Project 237-239 <code>'Webgl'</code> <code>'WebGL Build failed'</code> <p>Severity Evidence: - Impact Scope: High (5 stages) - Modification Cost: Medium (5 locations for single change)</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#12-other-code-smells-evidence-only","title":"1.2 Other Code Smells (Evidence Only)","text":""},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#bloaters","title":"Bloaters","text":"Smell Evidence Primitive Obsession stageName hardcoded (5x), directory names hardcoded (<code>linting_results</code>, <code>test_results</code>, <code>coverage_results</code>)"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#dispensables","title":"Dispensables","text":"Smell Evidence Duplicated Code <code>String stageName = '...'; String errorMassage = '...'; unityUtil.runUnityStage(...)</code> pattern (5x)"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#2-design-smells-principle-based","title":"2. Design Smells (Principle-Based)","text":"<p>Source: Suryanarayana, G. et al. (2014). Refactoring for Software Design Smells</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, the following categories are applicable:</p> Category Applicable Applied Smells Abstraction \u2713 Multifaceted Abstraction, Missing Abstraction Encapsulation \u2713 Missing Encapsulation Modularization \u2717 (single file) Hierarchy \u2717 (no conditional branch patterns)"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#21-abstraction-smells","title":"2.1 Abstraction Smells","text":""},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#multifaceted-abstraction","title":"Multifaceted Abstraction","text":"<p> Click to see details <p>Definition: \"An abstraction has multiple responsibilities assigned to it\"</p> <p>Evidence: - Single Jenkinsfile handles 4 different concerns:   - Unity Stage execution (5 stages)   - File System operations (<code>mkdir</code>, <code>cp</code>)   - Python script calls (Linting report, WebGL report)   - Linting logic (Bash script + exitCode branch)</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#missing-abstraction","title":"Missing Abstraction","text":"<p> Click to see details <p>Definition: \"Clumps of data or encoded strings are used instead of creating a class or an interface\"</p> <p>Evidence:</p> Missing Abstraction Current State Occurrences Unity Stage config <code>stageName</code>, <code>errorMsg</code> hardcoded separately 5 Directory names <code>'linting_results'</code>, <code>'test_results'</code>, <code>'coverage_results'</code> strings 3 Python script paths <code>'${env.WORKSPACE}/python/...'</code> hardcoded 3"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#22-encapsulation-smells","title":"2.2 Encapsulation Smells","text":""},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#missing-encapsulation","title":"Missing Encapsulation","text":"<p> Click to see details <p>Definition: \"The encapsulation of implementation variations in a type is missing\"</p> <p>Evidence: Unity Stage execution pattern not encapsulated:</p> Stage Pattern Prepare WORKSPACE <code>String stageName = 'Rider'; String errorMassage = '...'; unityUtil.runUnityStage(...)</code> EditMode Tests <code>String stageName = 'EditMode'; String errorMassage = '...'; unityUtil.runUnityStage(...)</code> PlayMode Tests <code>String stageName = 'PlayMode'; String errorMassage = '...'; unityUtil.runUnityStage(...)</code> Code Coverage <code>String stageName = 'Coverage'; String errorMassage = '...'; unityUtil.runUnityStage(...)</code> Build Project <code>String stageName = 'Webgl'; String errorMassage = '...'; unityUtil.runUnityStage(...)</code> <p>Impact: Changing error message format requires modifying all 5 locations</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/02-software-smells-analysis/#conclusion","title":"Conclusion","text":"<p>Software Smells Summary: - Code Level: Divergent Change (4 change reasons), Shotgun Surgery (stageName/errorMsg 5 locations), Duplicated Code (Unity Stage pattern 5x) - Design Level: 4 concerns mixed in single file, stageName/errorMsg not abstracted, Unity Stage pattern not encapsulated</p> <p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/","title":"Design Smells Analysis","text":"<p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#dlxjenkinsjenkinsfile-design-smells-symptoms-analysis","title":"DLXJenkins/Jenkinsfile - Design Smells Symptoms Analysis","text":"<p>Source: Martin, R.C. (2000). Design Principles and Design Patterns</p> <p>This document analyzes Martin's 7 Design Symptoms using evidence from: - SRP Violation Analysis: Inline code detection per stage - Software Smells Analysis: Code Smells (Fowler), Design Smells (Suryanarayana) - Direct code review: Readability, naming, complexity issues</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#1-rigidity","title":"1. Rigidity","text":"<p>Definition: Changing one place requires cascading changes to other places</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells","title":"Contributing Smells","text":"Smell Evidence Impact Shotgun Surgery stageName/errorMsg change \u2192 5 locations High Primitive Obsession Directory names hardcoded (3x), Python script paths hardcoded (3x) Medium"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#2-fragility","title":"2. Fragility","text":"<p>Definition: Modifying one place breaks conceptually unrelated places</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_1","title":"Contributing Smells","text":"Smell Evidence Risk Shotgun Surgery Miss one of 5 stageName locations \u2192 Stage failure High Divergent Change 4 change reasons mixed \u2192 unexpected side effects Medium"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#3-immobility","title":"3. Immobility","text":"<p>Definition: Difficult to extract useful parts for reuse in other systems/modules</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_2","title":"Contributing Smells","text":"Smell Evidence Impact Multifaceted Abstraction 4 concerns mixed (Unity Stage, File System, Python scripts, Linting logic) High Missing Abstraction stageName/errorMsg not extracted \u2192 can't reuse Stage config Medium"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#4-viscosity","title":"4. Viscosity","text":"<p>Definition: Doing the right thing (maintaining design) is harder than doing the wrong thing (hacking)</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_3","title":"Contributing Smells","text":"Smell Evidence Impact Missing Encapsulation Unity Stage pattern not encapsulated \u2192 copy-paste easier Medium Duplicated Code stageName/errorMsg pattern 5x \u2192 duplication pattern established Medium"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#5-needless-complexity","title":"5. Needless Complexity","text":"<p>Definition: Over-engineering for features not currently needed</p> <p>Symptom: \"I might need this later\" (YAGNI violation)</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#evidence","title":"Evidence","text":"<p>No clear evidence of over-engineering found in DLXJenkins/Jenkinsfile.</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#6-needless-repetition","title":"6. Needless Repetition","text":"<p>Definition: Code that could be unified through abstraction is duplicated in multiple places</p> <p>Symptom: \"Same code in multiple places\" (DRY violation)</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_4","title":"Contributing Smells","text":"Smell Evidence Impact Duplicated Code stageName/errorMsg pattern (5x) High Duplicated Code <code>sh 'mkdir -p ...'</code> pattern (4x) Medium Missing Encapsulation Same patterns repeated without extraction High"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#7-opacity","title":"7. Opacity","text":"<p>Definition: Code is difficult to understand and intent is unclear</p> <p>Symptom: \"What does this code do?\"</p>"},{"location":"problem-analysis/04-DLXJenkins-Jenkinsfile/03-design-smells-symptoms/#evidence-code-review","title":"Evidence (Code Review)","text":"Issue Evidence Impact Undefined variable usage <code>FOLDER_NAME</code>, <code>TICKET_NUMBER</code> used but definition unclear (set in <code>generalUtil.initializeEnvironment</code>) Medium Complex nesting Linting Stage 4-level if-else nesting (lines 129-166) Medium <p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/01-srp-violation-analysis/","title":"SRP Violation Analysis","text":"<p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#dlxjenkinsjenkinsfiledeployment-srp-violation-analysis","title":"DLXJenkins/JenkinsfileDeployment - SRP Violation Analysis","text":"<p>Pipeline Role: Orchestration only (sequence/flow control)</p> <p>SRP Violation: If inline code exists in Jenkinsfile, it violates orchestration-only principle</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#1-srp-violation-analysis-criteria","title":"1. SRP Violation Analysis Criteria","text":"<ul> <li>Jenkinsfile Role: Orchestration (pipeline sequence/flow control)</li> <li>SRP Violation Condition: If actual logic exists in Jenkinsfile (not Helper calls)</li> <li>Analysis Method: Stage-by-Stage inline code detection</li> </ul>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#2-inline-code-analysis-by-stage","title":"2. Inline Code Analysis by Stage","text":"Stage Inline Code Type Count Delete Merged Branch mainBranches check + folder name extraction 2 Prepare WORKSPACE Git commands (4x) + stageName/errorMsg 5 Linting File System (<code>mkdir</code>, <code>cp</code>) + Bash script + exitCode branch 4 EditMode Tests File System (<code>mkdir</code>) + stageName/errorMsg 2 PlayMode Tests stageName/errorMsg 1 Build Project File System (<code>mkdir</code>, <code>mv</code>) + stageName/errorMsg 3 Deploy Build SSH/SCP commands (6x: LTI 3 + eConestoga 3) 6"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#3-inline-code-details-by-stage","title":"3. Inline Code Details by Stage","text":"<code>Delete Merged Branch</code> stage (2 inline codes) <pre><code>script {\n    if (!mainBranches.contains(DESTINATION_BRANCH)) {  // Inline 1: mainBranches check\n        env.FAILURE_REASON = 'Not merging to the main branch. Exiting the pipeline...'\n        currentBuild.result = buildResults.ABORTED\n        error(env.FAILURE_REASON)\n    }\n\n    env.FOLDER_NAME = \"${JOB_NAME}\".split('/').first()  // Inline 2: folder name extraction\n}\n</code></pre> <code>Prepare WORKSPACE</code> stage (5 inline codes) <pre><code>script {\n    if (!fileExists(\"${PROJECT_DIR}\")) {\n        sh \"git clone ${REPO_SSH} \\\"${PROJECT_DIR}\\\"\"  // Inline 1: Git clone\n    }\n}\n\ndir(\"${PROJECT_DIR}\") {\n    sh \"git checkout ${DESTINATION_BRANCH}\"  // Inline 2: Git checkout\n    sh 'git reset --hard HEAD'  // Inline 3: Git reset\n    sh 'git pull'  // Inline 4: Git pull\n}\n\ndir(\"${PROJECT_DIR}\") {\n    script {\n        String stageName = 'Rider'  // Inline 5: stageName/errorMsg hardcoded\n        String errorMassage = 'Synchronizing Unity and Rider IDE solution files failed'\n        unityUtil.runUnityStage(stageName, errorMassage)\n    }\n}\n</code></pre> <code>Linting</code> stage (4 inline codes) <pre><code>dir(\"${REPORT_DIR}\") {\n    sh 'mkdir -p linting_results'  // Inline 1: File System\n}\n\nscript {\n    sh \"cp -f '${env.WORKSPACE}/Bash/.editorconfig' '${PROJECT_DIR}' 2&gt;/dev/null\"  // Inline 2: File System\n\n    def exitCode = sh script: \"\"\"sh '${env.WORKSPACE}/Bash/Linting.bash' \\\\\n        '${PROJECT_DIR}' '${REPORT_DIR}/linting_results'\"\"\", returnStatus: true  // Inline 3: Bash script\n\n    if (exitCode != 0) {  // Inline 4: exitCode branch\n        catchError(buildResult: buildResults.SUCCESS, stageResult: stageResults.FAILURE) {\n            error(\"Linting failed with exit code: ${exitCode}\")\n        }\n    }\n}\n</code></pre> <code>EditMode Tests</code> stage (2 inline codes) <pre><code>dir(\"${REPORT_DIR}\") {\n    sh 'mkdir -p test_results'  // Inline 1: File System\n}\n\nscript {\n    String stageName = 'EditMode'  // Inline 2: stageName/errorMsg hardcoded\n    String errorMassage = 'EditMode tests failed'\n    unityUtil.runUnityStage(stageName, errorMassage)\n}\n</code></pre> <code>PlayMode Tests</code> stage (1 inline code) <pre><code>script {\n    String stageName = 'PlayMode'  // Inline: stageName/errorMsg hardcoded\n    String errorMassage = 'PlayMode tests failed'\n    unityUtil.runUnityStage(stageName, errorMassage)\n}\n</code></pre> <code>Build Project</code> stage (3 inline codes) <pre><code>sh \"mkdir -p \\\"${PROJECT_DIR}/Assets/Editor/\\\"\"  // Inline 1: File System\nsh \"mv Builder.cs \\\"${PROJECT_DIR}/Assets/Editor/\\\"\"  // Inline 2: File System\n\nscript {\n    String stageName = 'Webgl'  // Inline 3: stageName/errorMsg hardcoded\n    String errorMassage = 'WebGL Build failed'\n    unityUtil.runUnityStage(stageName, errorMassage)\n}\n</code></pre> <code>Deploy Build</code> stage (6 inline codes) - Most Severe <pre><code>// LTI Server (3 inline codes)\nscript {\n    sh \"ssh -i ${env.SSH_KEY} ${env.DLX_WEB_HOST_URL} \\\"sudo mkdir -p /var/www/html/${FOLDER_NAME} \\\n    &amp;&amp; sudo chown vconadmin:vconadmin /var/www/html/${FOLDER_NAME}\\\"\"  // Inline 1: SSH mkdir/chown\n\n    sh \"scp -i ${env.SSH_KEY} -rp ${PROJECT_DIR}/Builds/* \\\"${env.DLX_WEB_HOST_URL}:/var/www/html/${FOLDER_NAME}\\\"\"  // Inline 2: SCP copy\n\n    sh \"ssh -i ${env.SSH_KEY} ${env.DLX_WEB_HOST_URL} 'bash ~/ShellScripts/UpdateBuildURL.sh /var/www/html/${FOLDER_NAME}'\"  // Inline 3: SSH script\n}\n\n// eConestoga Server (3 inline codes - duplicated pattern)\nscript {\n    if (DLX_PROJECT_LIST.contains(PR_REPO_NAME)) {\n        sh script: \"\"\"\n            ssh -i ${env.SSH_KEY} ${env.DLX_ECONESTOGA_URL} \\\\\n            \"sudo mkdir -p /var/www/html/${FOLDER_NAME} &amp;&amp; sudo chown vconadmin:vconadmin /var/www/html/${FOLDER_NAME}\"\n        \"\"\"  // Inline 4: SSH mkdir/chown (duplicate)\n\n        sh script: \"\"\"\n            scp -i ${env.SSH_KEY} -rp ${PROJECT_DIR}/Builds/* \\\\\n            ${env.DLX_ECONESTOGA_URL}:/var/www/html/${FOLDER_NAME}\n        \"\"\"  // Inline 5: SCP copy (duplicate)\n\n        sh script: \"\"\"\n            ssh -i ${env.SSH_KEY} ${env.DLX_ECONESTOGA_URL} \\\\\n            'bash ~/ShellScripts/UpdateBuildURL.sh /var/www/html/${FOLDER_NAME}'\n        \"\"\"  // Inline 6: SSH script (duplicate)\n    }\n}\n</code></pre>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#4-inline-code-summary","title":"4. Inline Code Summary","text":"Type Count Stages stageName/errorMsg hardcoded 4 Prepare, EditMode, PlayMode, Build Git commands (<code>clone</code>, <code>checkout</code>, <code>reset</code>, <code>pull</code>) 4 Prepare WORKSPACE File System (<code>mkdir</code>, <code>cp</code>, <code>mv</code>) 5 Linting, EditMode, Build Bash script direct call 1 Linting SSH/SCP commands 6 Deploy Build (LTI 3 + eConestoga 3) Branch logic 2 Delete Merged Branch, Linting"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#conclusion","title":"Conclusion","text":"<p>SRP Violation: - Total 23 inline codes across 7 stages (DLX CI: 16) - Deploy Build Stage: Most severe (6 inline codes, LTI/eConestoga same pattern duplicated) - Prepare WORKSPACE Stage: Git commands directly in Jenkinsfile (unlike DLX CI which delegates to Helper) - Common pattern with DLX CI: stageName/errorMsg hardcoded (4x), File System operations inline - Recommendation: Extract Git commands, SSH/SCP commands to Helper functions</p> <p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/","title":"Software Smells Analysis","text":"<p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#dlxjenkinsjenkinsfiledeployment-software-smells-analysis","title":"DLXJenkins/JenkinsfileDeployment - Software Smells Analysis","text":"<p>Classification based on industry-standard taxonomy: Code Smells (Fowler) \u2192 Design Smells (Suryanarayana)</p> <p>Inline Code Analysis: 23 inline codes across 7 stages. See SRP Violation Analysis</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#1-code-smells","title":"1. Code Smells","text":"<p>Source: Fowler, M. (1999). Refactoring: Improving the Design of Existing Code</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, only the following categories are applicable:</p> Category Applicable Applied Smells Bloaters \u2713 Primitive Obsession Object-Orientation Abusers \u2717 (not applicable - no OOP) Change Preventers \u2713 Divergent Change, Shotgun Surgery Dispensables \u2713 Duplicated Code Couplers \u2717 (not applicable - no class relationships)"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#11-change-preventers-with-severity-criteria","title":"1.1 Change Preventers (with Severity Criteria)","text":""},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#severity-criteria","title":"Severity Criteria","text":"Metric Low Medium High Impact Scope 1-2 stages 3-4 stages 5+ stages Modification Cost 1-2 locations 3-5 locations 6+ locations"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#divergent-change-scope-file-level","title":"Divergent Change (Scope: File Level)","text":"<p> Click to see details <p>Definition: \"A single class/file is frequently changed for several different reasons\"</p> <p>Divergent Change Cases in JenkinsfileDeployment:</p> Change Reason Affected Stages Count Unity Stage settings change Prepare, EditMode, PlayMode, Build 4 Git workflow change Prepare WORKSPACE 1 File System structure change Linting, EditMode, Build 3 SSH/SCP deployment change Deploy Build 1 Linting policy change Linting 1 <p>Severity Evidence: - Impact Scope: High (4 stages affected by Unity Stage changes) - Modification Cost: High (5 different change reasons in single file)</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#shotgun-surgery-scope-within-file","title":"Shotgun Surgery (Scope: Within-file)","text":"<p> Click to see details <p>Definition: \"A single change requires modifications to multiple locations\"</p> <p>Shotgun Surgery: stageName/errorMsg change:</p> Stage Lines stageName errorMsg Prepare WORKSPACE 120-122 <code>'Rider'</code> <code>'Synchronizing Unity and Rider IDE solution files failed'</code> EditMode Tests 164-166 <code>'EditMode'</code> <code>'EditMode tests failed'</code> PlayMode Tests 178-180 <code>'PlayMode'</code> <code>'PlayMode tests failed'</code> Build Project 193-195 <code>'Webgl'</code> <code>'WebGL Build failed'</code> <p>Shotgun Surgery: SSH/SCP pattern change:</p> Server Lines Pattern LTI 205-209 <code>ssh mkdir</code> + <code>scp</code> + <code>ssh UpdateBuildURL.sh</code> eConestoga 218-233 Same pattern (duplicated) <p>Severity Evidence: - Impact Scope: High (4 stages for Unity, 2 servers for Deploy) - Modification Cost: Medium (4 locations for Unity, 6 locations for SSH/SCP)</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#12-other-code-smells-evidence-only","title":"1.2 Other Code Smells (Evidence Only)","text":""},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#bloaters","title":"Bloaters","text":"Smell Evidence Primitive Obsession stageName hardcoded (4x), server paths hardcoded (<code>/var/www/html/${FOLDER_NAME}</code> 4x), directory names hardcoded"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#dispensables","title":"Dispensables","text":"Smell Evidence Duplicated Code stageName/errorMsg pattern (4x) Duplicated Code SSH/SCP deployment pattern (LTI + eConestoga = 2x, 6 commands each)"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#2-design-smells-principle-based","title":"2. Design Smells (Principle-Based)","text":"<p>Source: Suryanarayana, G. et al. (2014). Refactoring for Software Design Smells</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, the following categories are applicable:</p> Category Applicable Applied Smells Abstraction \u2713 Multifaceted Abstraction, Missing Abstraction Encapsulation \u2713 Missing Encapsulation Modularization \u2717 (single file) Hierarchy \u2717 (no conditional branch patterns)"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#21-abstraction-smells","title":"2.1 Abstraction Smells","text":""},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#multifaceted-abstraction","title":"Multifaceted Abstraction","text":"<p> Click to see details <p>Definition: \"An abstraction has multiple responsibilities assigned to it\"</p> <p>Evidence: - Single Jenkinsfile handles 5 different concerns:   - Unity Stage execution (4 stages)   - Git commands (<code>clone</code>, <code>checkout</code>, <code>reset</code>, <code>pull</code>)   - File System operations (<code>mkdir</code>, <code>cp</code>, <code>mv</code>)   - SSH/SCP deployment (2 servers)   - Linting logic (Bash script + exitCode branch)</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#missing-abstraction","title":"Missing Abstraction","text":"<p> Click to see details <p>Definition: \"Clumps of data or encoded strings are used instead of creating a class or an interface\"</p> <p>Evidence:</p> Missing Abstraction Current State Occurrences Unity Stage config <code>stageName</code>, <code>errorMsg</code> hardcoded separately 4 Server config <code>env.DLX_WEB_HOST_URL</code>, <code>env.DLX_ECONESTOGA_URL</code> scattered 6 Server path <code>'/var/www/html/${FOLDER_NAME}'</code> repeated 4 Directory names <code>'linting_results'</code>, <code>'test_results'</code> strings 2"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#22-encapsulation-smells","title":"2.2 Encapsulation Smells","text":""},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#missing-encapsulation","title":"Missing Encapsulation","text":"<p> Click to see details <p>Definition: \"The encapsulation of implementation variations in a type is missing\"</p> <p>Evidence: Deployment pattern not encapsulated:</p> Server Pattern LTI <code>ssh mkdir/chown</code> \u2192 <code>scp copy</code> \u2192 <code>ssh UpdateBuildURL.sh</code> eConestoga Same 3-step pattern (duplicated) <p>Evidence: Unity Stage execution pattern not encapsulated:</p> Stage Pattern Prepare WORKSPACE <code>String stageName = 'Rider'; String errorMassage = '...'; unityUtil.runUnityStage(...)</code> EditMode Tests <code>String stageName = 'EditMode'; ...</code> PlayMode Tests <code>String stageName = 'PlayMode'; ...</code> Build Project <code>String stageName = 'Webgl'; ...</code> <p>Impact: Adding new server requires copy-paste of 3 SSH/SCP commands</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/02-software-smells-analysis/#conclusion","title":"Conclusion","text":"<p>Software Smells Summary: - Code Level: Divergent Change (5 change reasons), Shotgun Surgery (stageName 4 locations + SSH/SCP 6 locations), Duplicated Code (Unity pattern 4x + Deploy pattern 2x) - Design Level: 5 concerns mixed in single file, server config not abstracted, deployment pattern not encapsulated</p> <p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/","title":"Design Smells Analysis","text":"<p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#dlxjenkinsjenkinsfiledeployment-design-smells-symptoms-analysis","title":"DLXJenkins/JenkinsfileDeployment - Design Smells Symptoms Analysis","text":"<p>Source: Martin, R.C. (2000). Design Principles and Design Patterns</p> <p>This document analyzes Martin's 7 Design Symptoms using evidence from: - SRP Violation Analysis: Inline code detection per stage - Software Smells Analysis: Code Smells (Fowler), Design Smells (Suryanarayana) - Direct code review: Readability, naming, complexity issues</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#1-rigidity","title":"1. Rigidity","text":"<p>Definition: Changing one place requires cascading changes to other places</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells","title":"Contributing Smells","text":"Smell Evidence Impact Shotgun Surgery stageName/errorMsg change \u2192 4 locations High Shotgun Surgery SSH/SCP pattern change \u2192 6 locations (2 servers \u00d7 3 commands) High Primitive Obsession Server path hardcoded (<code>/var/www/html/${FOLDER_NAME}</code> 4x) Medium"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#2-fragility","title":"2. Fragility","text":"<p>Definition: Modifying one place breaks conceptually unrelated places</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells_1","title":"Contributing Smells","text":"Smell Evidence Risk Shotgun Surgery Miss one of 4 stageName locations \u2192 Stage failure High Shotgun Surgery Update SSH option in LTI only, forget eConestoga \u2192 inconsistent deployment High Divergent Change 5 change reasons mixed \u2192 unexpected side effects Medium"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#3-immobility","title":"3. Immobility","text":"<p>Definition: Difficult to extract useful parts for reuse in other systems/modules</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells_2","title":"Contributing Smells","text":"Smell Evidence Impact Multifaceted Abstraction 5 concerns mixed (Unity Stage, Git, File System, SSH/SCP, Linting) High Missing Abstraction Server config scattered \u2192 can't reuse deployment logic High"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#4-viscosity","title":"4. Viscosity","text":"<p>Definition: Doing the right thing (maintaining design) is harder than doing the wrong thing (hacking)</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells_3","title":"Contributing Smells","text":"Smell Evidence Impact Missing Encapsulation Deployment pattern not encapsulated \u2192 copy-paste for new server easier High Missing Encapsulation Unity Stage pattern not encapsulated \u2192 copy-paste easier Medium Duplicated Code SSH/SCP pattern 2x, stageName 4x \u2192 duplication pattern established High"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#5-needless-complexity","title":"5. Needless Complexity","text":"<p>Definition: Over-engineering for features not currently needed</p> <p>Symptom: \"I might need this later\" (YAGNI violation)</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#evidence","title":"Evidence","text":"<p>No clear evidence of over-engineering found in JenkinsfileDeployment.</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#6-needless-repetition","title":"6. Needless Repetition","text":"<p>Definition: Code that could be unified through abstraction is duplicated in multiple places</p> <p>Symptom: \"Same code in multiple places\" (DRY violation)</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells_4","title":"Contributing Smells","text":"Smell Evidence Impact Duplicated Code SSH/SCP deployment pattern (LTI + eConestoga = 2x, 3 commands each) High Duplicated Code stageName/errorMsg pattern (4x) Medium Missing Encapsulation Same patterns repeated without extraction High"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#7-opacity","title":"7. Opacity","text":"<p>Definition: Code is difficult to understand and intent is unclear</p> <p>Symptom: \"What does this code do?\"</p>"},{"location":"problem-analysis/05-DLXJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#evidence-code-review","title":"Evidence (Code Review)","text":"Issue Evidence Impact Undocumented environment variables <code>env.SSH_KEY</code>, <code>env.DLX_WEB_HOST_URL</code>, <code>env.DLX_ECONESTOGA_URL</code> used without documentation Medium Inline Git commands <code>git clone</code>, <code>checkout</code>, <code>reset</code>, <code>pull</code> sequence without explanation Low Inline shell commands <code>sh</code> calls scattered across 7 stages (16 total) Medium <p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/01-srp-violation-analysis/","title":"SRP Violation Analysis","text":"<p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/01-srp-violation-analysis/#jsjenkinsjenkinsfile-srp-violation-analysis","title":"JsJenkins/Jenkinsfile - SRP Violation Analysis","text":"<p>Pipeline Role: Orchestration only (sequence/flow control)</p> <p>SRP Violation: If inline code exists in Jenkinsfile, it violates orchestration-only principle</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/01-srp-violation-analysis/#1-srp-violation-analysis-criteria","title":"1. SRP Violation Analysis Criteria","text":"<ul> <li>Jenkinsfile Role: Orchestration (pipeline sequence/flow control)</li> <li>SRP Violation Condition: If actual logic exists in Jenkinsfile (not Helper calls)</li> <li>Analysis Method: Stage-by-Stage inline code detection</li> </ul>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/01-srp-violation-analysis/#2-inline-code-analysis-by-stage","title":"2. Inline Code Analysis by Stage","text":"Stage Inline Code Type Count Prepare WORKSPACE (none significant) 0 Install Dependencies (none significant) 0 Linting File System (<code>mkdir</code>) 1 Unit Testing Python script (2x) + DEBUG_MODE branch (2x) + server/client branch (2x) 6 Static Analysis SonarQube scanner config + Quality Gate logic 2"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/01-srp-violation-analysis/#3-inline-code-details-by-stage","title":"3. Inline Code Details by Stage","text":"<code>Linting</code> stage (1 inline code) <pre><code>dir(\"${REPORT_DIR}\") {\n    sh 'mkdir -p linting_results'  // Inline: File System\n}\n</code></pre> <code>Unit Testing</code> stage (6 inline codes) - Most Severe <pre><code>// Server-side report (3 inline codes)\nif (params.SERVER_SOURCE_FOLDER?.trim()) {  // Inline 1: server branching logic\n    Map serverTestSummaryDirs = jsUtil.retrieveReportSummaryDirs(...)\n\n    if (!serverTestSummaryDirs.isEmpty()) {\n        String cmdArgs = \" ${COMMIT_HASH} ${serverTestSummaryDirs['coverageSummaryDir']} ... --server\"\n\n        if ((params.DEBUG_MODE ?: '').toUpperCase() == 'Y') {  // Inline 2: DEBUG_MODE branch\n            cmdArgs += ' --debug'\n        }\n\n        sh \" python python/create_bitbucket_coverage_report.py ${cmdArgs}\"  // Inline 3: Python script\n    }\n}\n\n// Client-side report (3 inline codes - duplicated pattern)\nif (params.CLIENT_SOURCE_FOLDER?.trim()) {  // Inline 4: client branching logic (duplicate)\n    Map clientTestSummaryDirs = jsUtil.retrieveReportSummaryDirs(...)\n\n    if (!clientTestSummaryDirs.isEmpty()) {\n        String cmdArgs = \" ${COMMIT_HASH} ${clientTestSummaryDirs['coverageSummaryDir']} ... --client\"\n\n        if ((params.DEBUG_MODE ?: '').toUpperCase() == 'Y') {  // Inline 5: DEBUG_MODE branch (duplicate)\n            cmdArgs += ' --debug'\n        }\n\n        sh \" python python/create_bitbucket_coverage_report.py ${cmdArgs}\"  // Inline 6: Python script (duplicate)\n    }\n}\n</code></pre> <code>Static Analysis</code> stage (2 inline codes) <pre><code>// SonarQube scanner config (Inline 1)\nscript {\n    String scannerHome = tool SONARQUBE_SCANNER\n    withSonarQubeEnv(SONARQUBE_SERVER) {\n        String sonarCommand = \"\\\"${scannerHome}/bin/sonar-scanner\\\" \" +\n                            \"\\\"-Dsonar.projectKey=${env.SONAR_PROJECT_KEY}\\\" \" +\n                            '\\\"-Dsonar.host.url=http://localhost:9000/sonarqube\\\" ' +\n                            '\\\"-Dsonar.sources=.\\\" '  +\n                            '\\\"-Dsonar.python.version=3.10\\\"'\n        sh sonarCommand\n    }\n}\n\n// Quality Gate check logic (Inline 2)\nscript {\n    Map status = generalUtil.checkQualityGateStatus(SONAR_PROJECT_KEY, env.SONAR_QUBE_AUTH_TOKEN)\n\n    catchError(buildResult: buildResults.SUCCESS, stageResult: stageResults.FAILURE) {\n        final String STATUS_OK = 'OK'\n\n        if ((status.entireCodeStatus != STATUS_OK) || (status.newCodeStatus != STATUS_OK)) {\n            error('Quality gate failed!')\n        }\n    }\n}\n</code></pre>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/01-srp-violation-analysis/#4-inline-code-summary","title":"4. Inline Code Summary","text":"Type Count Stages File System (<code>mkdir</code>) 1 Linting Python script direct call 2 Unit Testing (server + client) DEBUG_MODE branch 2 Unit Testing (server + client) Server/Client branching logic 2 Unit Testing SonarQube scanner config 1 Static Analysis Quality Gate logic 1 Static Analysis"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/01-srp-violation-analysis/#conclusion","title":"Conclusion","text":"<p>SRP Violation: - Total 9 inline codes across 3 stages (DLX CI: 16, DLX CD: 23) - Unit Testing Stage: Most severe (6 inline codes, server/client same pattern duplicated) - Static Analysis Stage: SonarQube scanner config directly in Jenkinsfile - Key difference from DLX: No stageName/errorMsg hardcoding, but has server/client code duplication - Recommendation: Extract server/client report logic to Helper function, extract SonarQube config</p> <p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/","title":"Software Smells Analysis","text":"<p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#jsjenkinsjenkinsfile-software-smells-analysis","title":"JsJenkins/Jenkinsfile - Software Smells Analysis","text":"<p>Classification based on industry-standard taxonomy: Code Smells (Fowler) \u2192 Design Smells (Suryanarayana)</p> <p>Inline Code Analysis: 9 inline codes across 3 stages. See SRP Violation Analysis</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#1-code-smells","title":"1. Code Smells","text":"<p>Source: Fowler, M. (1999). Refactoring: Improving the Design of Existing Code</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, only the following categories are applicable:</p> Category Applicable Applied Smells Bloaters \u2713 Long Method, Primitive Obsession Object-Orientation Abusers \u2717 (not applicable - no OOP) Change Preventers \u2713 Divergent Change, Shotgun Surgery Dispensables \u2713 Duplicated Code Couplers \u2717 (not applicable - no class relationships)"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#11-change-preventers-with-severity-criteria","title":"1.1 Change Preventers (with Severity Criteria)","text":""},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#severity-criteria","title":"Severity Criteria","text":"Metric Low Medium High Impact Scope 1-2 stages 3-4 stages 5+ stages Modification Cost 1-2 locations 3-5 locations 6+ locations"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#divergent-change-scope-file-level","title":"Divergent Change (Scope: File Level)","text":"<p> Click to see details <p>Definition: \"A single class/file is frequently changed for several different reasons\"</p> <p>Divergent Change Cases in JsJenkins/Jenkinsfile:</p> Change Reason Affected Stages Count Server/Client report change Unit Testing 1 Python script interface change Unit Testing 1 SonarQube config change Static Analysis 1 File System structure change Linting 1 <p>Severity Evidence: - Impact Scope: Medium (Unit Testing most affected) - Modification Cost: Medium (4 different change reasons in single file)</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#shotgun-surgery-scope-within-file","title":"Shotgun Surgery (Scope: Within-file)","text":"<p> Click to see details <p>Definition: \"A single change requires modifications to multiple locations\"</p> <p>Shotgun Surgery: Server/Client pattern change:</p> Type Pattern Server <code>params check</code> \u2192 <code>retrieveReportSummaryDirs</code> \u2192 <code>DEBUG_MODE check</code> \u2192 <code>Python call --server</code> Client Same pattern with <code>--client</code> (duplicated) <p>Shotgun Surgery: Adding new report type (e.g., 'admin'):</p> Location Change Required <code>publishTestResultsHtmlToWebServer</code> Add new call with <code>'admin'</code> <code>params.ADMIN_SOURCE_FOLDER</code> check Add new condition block <code>retrieveReportSummaryDirs</code> call Add new path Python script call Add <code>--admin</code> flag <p>Severity Evidence: - Impact Scope: High (Unit Testing stage 112 lines) - Modification Cost: High (6+ locations for new report type)</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#12-other-code-smells-evidence-only","title":"1.2 Other Code Smells (Evidence Only)","text":""},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#bloaters","title":"Bloaters","text":"Smell Evidence Long Method Unit Testing stage (112 lines, 7 responsibilities) Primitive Obsession Report types hardcoded (<code>'server'</code>, <code>'client'</code> 4x), SonarQube URL hardcoded, directory names hardcoded"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#dispensables","title":"Dispensables","text":"Smell Evidence Duplicated Code Server/Client report handling pattern (40+ lines \u00d7 2) Duplicated Code <code>publishTestResultsHtmlToWebServer</code> calls (2x) Duplicated Code DEBUG_MODE branch (2x)"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#2-design-smells-principle-based","title":"2. Design Smells (Principle-Based)","text":"<p>Source: Suryanarayana, G. et al. (2014). Refactoring for Software Design Smells</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, the following categories are applicable:</p> Category Applicable Applied Smells Abstraction \u2713 Multifaceted Abstraction, Missing Abstraction Encapsulation \u2713 Missing Encapsulation Modularization \u2713 Insufficient Modularization Hierarchy \u2717 (no conditional branch patterns)"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#21-abstraction-smells","title":"2.1 Abstraction Smells","text":""},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#multifaceted-abstraction","title":"Multifaceted Abstraction","text":"<p> Click to see details <p>Definition: \"An abstraction has multiple responsibilities assigned to it\"</p> <p>Evidence: - Single Jenkinsfile handles 4 different concerns:   - Test execution and coverage   - Web server deployment (server + client)   - Python Bitbucket reports (server + client)   - SonarQube analysis + Quality Gate</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#missing-abstraction","title":"Missing Abstraction","text":"<p> Click to see details <p>Definition: \"Clumps of data or encoded strings are used instead of creating a class or an interface\"</p> <p>Evidence:</p> Missing Abstraction Current State Occurrences Report type config <code>'server'</code>, <code>'client'</code> hardcoded separately 4 Filename constants <code>'coverage-summary.json'</code>, <code>'test-results.json'</code> inside stage 2 SonarQube URL <code>'http://localhost:9000/sonarqube'</code> hardcoded 1 Quality Gate status <code>'OK'</code> hardcoded 1"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#22-encapsulation-smells","title":"2.2 Encapsulation Smells","text":""},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#missing-encapsulation","title":"Missing Encapsulation","text":"<p> Click to see details <p>Definition: \"The encapsulation of implementation variations in a type is missing\"</p> <p>Evidence: Server/Client report handling not encapsulated:</p> Type Pattern (40+ lines each) Server <code>params.SERVER_SOURCE_FOLDER</code> check \u2192 <code>retrieveReportSummaryDirs</code> \u2192 <code>DEBUG_MODE</code> \u2192 <code>python --server</code> Client Same pattern with <code>CLIENT_SOURCE_FOLDER</code> and <code>--client</code> <p>Impact: Adding new report type requires copy-paste of 40+ lines</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#23-modularization-smells","title":"2.3 Modularization Smells","text":""},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#insufficient-modularization","title":"Insufficient Modularization","text":"<p> Click to see details <p>Definition: \"An abstraction has not been completely decomposed, and remains too large\"</p> <p>Evidence: Unit Testing stage:</p> Metric Value Threshold Lines 112 ~30 Responsibilities 7 1-2 Nesting depth 3 levels 2 levels <p>7 Responsibilities: 1. Test execution 2. Web server deployment (server) 3. Web server deployment (client) 4. Server report path lookup 5. Server report sending 6. Client report path lookup 7. Client report sending</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/02-software-smells-analysis/#conclusion","title":"Conclusion","text":"<p>Software Smells Summary: - Code Level: Divergent Change (4 change reasons), Shotgun Surgery (6+ locations for new report type), Duplicated Code (server/client pattern 40+ lines \u00d7 2), Long Method (112 lines) - Design Level: 4 concerns mixed, report types not abstracted, server/client pattern not encapsulated, Unit Testing stage insufficiently modularized</p> <p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/","title":"Design Smells Analysis","text":"<p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#jsjenkinsjenkinsfile-design-smells-symptoms-analysis","title":"JsJenkins/Jenkinsfile - Design Smells Symptoms Analysis","text":"<p>Source: Martin, R.C. (2000). Design Principles and Design Patterns</p> <p>This document analyzes Martin's 7 Design Symptoms using evidence from: - SRP Violation Analysis: Inline code detection per stage - Software Smells Analysis: Code Smells (Fowler), Design Smells (Suryanarayana) - Direct code review: Readability, naming, complexity issues</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#1-rigidity","title":"1. Rigidity","text":"<p>Definition: Changing one place requires cascading changes to other places</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells","title":"Contributing Smells","text":"Smell Evidence Impact Shotgun Surgery Adding new report type \u2192 6+ locations High Duplicated Code Server/Client pattern change \u2192 2 locations (40 lines each) High Primitive Obsession Report types hardcoded (<code>'server'</code>, <code>'client'</code> 4x) Medium"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#2-fragility","title":"2. Fragility","text":"<p>Definition: Modifying one place breaks conceptually unrelated places</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_1","title":"Contributing Smells","text":"Smell Evidence Risk Shotgun Surgery Miss one of 6 report locations \u2192 incomplete report High Duplicated Code Update Server pattern, forget Client \u2192 inconsistent behavior High Divergent Change 4 change reasons mixed \u2192 unexpected side effects Medium"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#3-immobility","title":"3. Immobility","text":"<p>Definition: Difficult to extract useful parts for reuse in other systems/modules</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_2","title":"Contributing Smells","text":"Smell Evidence Impact Multifaceted Abstraction 4 concerns mixed (test, web server, Bitbucket, SonarQube) High Insufficient Modularization Unit Testing stage 112 lines, 7 responsibilities High Missing Abstraction Report config scattered \u2192 can't reuse report logic Medium"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#4-viscosity","title":"4. Viscosity","text":"<p>Definition: Doing the right thing (maintaining design) is harder than doing the wrong thing (hacking)</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_3","title":"Contributing Smells","text":"Smell Evidence Impact Missing Encapsulation Server/Client pattern not encapsulated \u2192 copy-paste for new type easier High Duplicated Code Server/Client 40 lines \u00d7 2 \u2192 duplication pattern established High Long Method Unit Testing 112 lines \u2192 adding to existing easier than refactoring Medium"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#5-needless-complexity","title":"5. Needless Complexity","text":"<p>Definition: Over-engineering for features not currently needed</p> <p>Symptom: \"I might need this later\" (YAGNI violation)</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#evidence-code-review","title":"Evidence (Code Review)","text":"Issue Evidence Impact Commented-out code <code>// JENKINS_API_KEY = credentials('jenkins-api-key')</code> (line 52) Low Incorrect comment <code>// Unity Setup</code> in JS project (lines 63-64) Low"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#6-needless-repetition","title":"6. Needless Repetition","text":"<p>Definition: Code that could be unified through abstraction is duplicated in multiple places</p> <p>Symptom: \"Same code in multiple places\" (DRY violation)</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_4","title":"Contributing Smells","text":"Smell Evidence Impact Duplicated Code Server/Client report handling pattern (40 lines \u00d7 2 = 80 lines) High Duplicated Code <code>publishTestResultsHtmlToWebServer</code> calls (2x) Medium Duplicated Code DEBUG_MODE branch (2x) Medium Missing Encapsulation Same patterns repeated without extraction High"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#7-opacity","title":"7. Opacity","text":"<p>Definition: Code is difficult to understand and intent is unclear</p> <p>Symptom: \"What does this code do?\"</p>"},{"location":"problem-analysis/06-JsJenkins-Jenkinsfile/03-design-smells-symptoms/#evidence-code-review_1","title":"Evidence (Code Review)","text":"Issue Evidence Impact Undefined variable <code>destinationBranch</code> used but not defined (line 80), should be <code>DESTINATION_BRANCH</code> High Complex nesting Unit Testing stage 3-level if nesting (lines 164-244) Medium Long Method Unit Testing 112 lines with 7 responsibilities mixed Medium <p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/01-srp-violation-analysis/","title":"SRP Violation Analysis","text":"<p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#jsjenkinsjenkinsfiledeployment-srp-violation-analysis","title":"JsJenkins/JenkinsfileDeployment - SRP Violation Analysis","text":"<p>Pipeline Role: Orchestration only (sequence/flow control)</p> <p>SRP Violation: If inline code exists in Jenkinsfile, it violates orchestration-only principle</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#1-srp-violation-analysis-criteria","title":"1. SRP Violation Analysis Criteria","text":"<ul> <li>Jenkinsfile Role: Orchestration (pipeline sequence/flow control)</li> <li>SRP Violation Condition: If actual logic exists in Jenkinsfile (not Helper calls)</li> <li>Analysis Method: Stage-by-Stage inline code detection</li> </ul>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#2-inline-code-analysis-by-stage","title":"2. Inline Code Analysis by Stage","text":"Stage Inline Code Type Count Delete Merged Branch mainBranches check + <code>find</code>/<code>rm</code> commands + folder name extraction 4 Prepare WORKSPACE Git commands (4x) 4 Install Dependencies Node/npm version checks (3x) + <code>cd</code> 4 Linting File System (<code>mkdir</code>) 1 Unit Testing <code>cd</code> command 1 Static Analysis SonarQube scanner config + Quality Gate logic 2 Check Build and Deploy Condition Docker info + az login (2x) 3 Server Build and Deploy az acr + docker build/push + az containerapp + docker rmi 5 Client Build and Deploy Same pattern (duplicated) 5"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#3-inline-code-details-by-stage","title":"3. Inline Code Details by Stage","text":"<code>Delete Merged Branch</code> stage (4 inline codes) <pre><code>script {\n    if (!mainBranches.contains(DESTINATION_BRANCH)) {  // Inline 1: mainBranches check\n        env.FAILURE_REASON = 'Not merging to the main branch. Exiting the pipeline...'\n        currentBuild.result = 'ABORTED'\n        error(env.FAILURE_REASON)\n    }\n\n    def branch_path = sh(script: \"/usr/bin/find ../ -type d -name \\\"${PR_BRANCH}\\\"\", returnStdout: true)  // Inline 2: find command\n    branch_path = branch_path.trim()\n    if (!branch_path.isEmpty()) {\n        sh \"rm -r -f \\\"${branch_path}\\\"\"  // Inline 3: rm command\n        sh \"rm -r -f \\\"${branch_path}@tmp\\\"\"\n    }\n\n    env.FOLDER_NAME = \"${JOB_NAME}\".split('/').first()  // Inline 4: folder name extraction\n}\n</code></pre> <code>Prepare WORKSPACE</code> stage (4 inline codes) <pre><code>script {\n    if (!fileExists(\"${PROJECT_DIR}\")) {\n        sh \"git clone ${REPO_SSH} \\\"${PROJECT_DIR}\\\"\"  // Inline 1: Git clone\n    }\n}\n\ndir(\"${PROJECT_DIR}\") {\n    sh \"git checkout ${DESTINATION_BRANCH}\"  // Inline 2: Git checkout\n    sh 'git reset --hard HEAD'  // Inline 3: Git reset\n    sh 'git pull'  // Inline 4: Git pull\n}\n</code></pre> <code>Install Dependencies</code> stage (4 inline codes) <pre><code>script {\n    sh 'node -v'  // Inline 1: Node version check\n    sh 'npm -v'  // Inline 2: npm version check\n    sh 'npm config ls'  // Inline 3: npm config check\n\n    jsUtil.installNpmInTestingDirs(env.TEST_DIRECTORIES)\n\n    sh(script: 'cd \"' + env.WORKSPACE + '\"')  // Inline 4: cd command\n}\n</code></pre> <code>Static Analysis</code> stage (2 inline codes) <pre><code>// SonarQube scanner config (Inline 1)\nscript {\n    String scannerHome = tool SONARQUBE_SCANNER\n    withSonarQubeEnv(SONARQUBE_SERVER) {\n        String sonarCommand = \"\\\"${scannerHome}/bin/sonar-scanner\\\" \" +\n                            \"\\\"-Dsonar.projectKey=${env.SONAR_PROJECT_KEY}\\\" \" +\n                            '\\\"-Dsonar.host.url=http://localhost:9000/sonarqube\\\" ' +\n                            '\\\"-Dsonar.sources=.\\\" ' +\n                            '\\\"-Dsonar.python.version=3.10\\\"'\n        sh sonarCommand\n    }\n}\n\n// Quality Gate check logic (Inline 2)\nscript {\n    Map status = generalUtil.checkQualityGateStatus(SONAR_PROJECT_KEY, env.SONAR_QUBE_AUTH_TOKEN)\n    if ((status.entireCodeStatus != 'OK') || (status.newCodeStatus != 'OK')) {\n        error('Quality gate failed!')\n    }\n}\n</code></pre> <code>Check Build and Deploy Condition</code> stage (3 inline codes) <pre><code>script {\n    int isDockerRunning = sh(script: 'sudo docker info &gt; /dev/null 2&gt;&amp;1', returnStatus: true)  // Inline 1: Docker info\n    if (isDockerRunning != 0) {\n        error('Docker is not available. Please start Docker and try again.')\n    }\n}\n\nscript {\n    sh 'sudo az login --identity --username 0ca5eb7b-0dfc-4449-8c1e-c9dae95c7a97'  // Inline 2: az login\n\n    try {\n        sh 'sudo az acr login --name webbuilds'  // Inline 3: az acr login\n    } catch (Exception e) {\n        error('Pipeline terminated: Azure Container Registry login failed.')\n    }\n}\n</code></pre> <code>Server Build and Deploy</code> stage (5 inline codes) - Most Severe <pre><code>script {\n    def server_latest_version = sh(\n        script: \"\"\"\n            sudo az acr repository show-tags --name webbuilds \\\\\n            --repository ${params.SERVER_CONTAINER_NAME} \\\\\n            --output tsv | grep -v \"latest\" | sort -V | tail -n 1\n        \"\"\",\n        returnStdout: true\n    ).trim()  // Inline 1: az acr show-tags\n\n    // Docker build\n    sh \"\"\"\n        sudo docker build -t \\\\\n        ${env.AZ_CONTAINER_REGISTRY_NAME}/${params.SERVER_CONTAINER_NAME}:${project_server_version} \\\\\n        ${projectDir}/${params.SERVER_SOURCE_FOLDER}/.\n    \"\"\"  // Inline 2: docker build\n\n    // Docker push\n    sh \"\"\"\n        sudo docker push \\\\\n        ${env.AZ_CONTAINER_REGISTRY_NAME}/${params.SERVER_CONTAINER_NAME}:${project_server_version}\n    \"\"\"  // Inline 3: docker push\n\n    // Azure Container Apps update\n    sh \"\"\"\n        sudo az containerapp update \\\\\n        --name ${params.SERVER_CONTAINER_NAME} \\\\\n        --resource-group ${params.AZ_RESOURCE_GROUP} \\\\\n        --image ${env.AZ_CONTAINER_REGISTRY_NAME}/${params.SERVER_CONTAINER_NAME}:${project_server_version}\n    \"\"\"  // Inline 4: az containerapp update\n\n    // Docker image cleanup\n    sh \"sudo docker rmi ${env.AZ_CONTAINER_REGISTRY_NAME}/${params.SERVER_CONTAINER_NAME}:${project_server_version}\"  // Inline 5: docker rmi\n}\n</code></pre> <code>Client Build and Deploy</code> stage (5 inline codes) - Duplicated Pattern <pre><code>// Same 5-step pattern as Server Build and Deploy:\n// 1. az acr repository show-tags\n// 2. docker build\n// 3. docker push\n// 4. az containerapp update\n// 5. docker rmi\n\n// Only variable names differ: SERVER_CONTAINER_NAME \u2192 CLIENT_CONTAINER_NAME\n</code></pre>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#4-inline-code-summary","title":"4. Inline Code Summary","text":"Type Count Stages Git commands (<code>clone</code>, <code>checkout</code>, <code>reset</code>, <code>pull</code>) 4 Prepare WORKSPACE File System (<code>find</code>, <code>rm</code>, <code>mkdir</code>, <code>cd</code>) 6 Delete Merged Branch, Linting, Install, Unit Testing Node/npm version checks 3 Install Dependencies Docker commands (<code>info</code>, <code>build</code>, <code>push</code>, <code>rmi</code>) 7 Check Condition, Server Deploy, Client Deploy Azure commands (<code>az login</code>, <code>az acr</code>, <code>az containerapp</code>) 6 Check Condition, Server Deploy, Client Deploy SonarQube config + Quality Gate 2 Static Analysis Branch logic 1 Delete Merged Branch"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/01-srp-violation-analysis/#conclusion","title":"Conclusion","text":"<p>SRP Violation: - Total 29 inline codes across 9 stages (DLX CI: 16, DLX CD: 23, JS CI: 9) - Server/Client Build and Deploy: Most severe (5 inline codes each, same pattern duplicated = 75+ lines) - Prepare WORKSPACE: Git commands directly in Jenkinsfile - Key difference from JS CI: Docker/Azure commands inline, Server/Client deploy code duplicated - Recommendation: Extract Docker/Azure commands to Helper functions, abstract Server/Client pattern</p> <p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/","title":"Software Smells Analysis","text":"<p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#jsjenkinsjenkinsfiledeployment-software-smells-analysis","title":"JsJenkins/JenkinsfileDeployment - Software Smells Analysis","text":"<p>Classification based on industry-standard taxonomy: Code Smells (Fowler) \u2192 Design Smells (Suryanarayana)</p> <p>Inline Code Analysis: 29 inline codes across 9 stages. See SRP Violation Analysis</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#1-code-smells","title":"1. Code Smells","text":"<p>Source: Fowler, M. (1999). Refactoring: Improving the Design of Existing Code</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, only the following categories are applicable:</p> Category Applicable Applied Smells Bloaters \u2713 Long Method, Primitive Obsession Object-Orientation Abusers \u2717 (not applicable - no OOP) Change Preventers \u2713 Divergent Change, Shotgun Surgery Dispensables \u2713 Duplicated Code Couplers \u2717 (not applicable - no class relationships)"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#11-change-preventers-with-severity-criteria","title":"1.1 Change Preventers (with Severity Criteria)","text":""},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#severity-criteria","title":"Severity Criteria","text":"Metric Low Medium High Impact Scope 1-2 stages 3-4 stages 5+ stages Modification Cost 1-2 locations 3-5 locations 6+ locations"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#divergent-change-scope-file-level","title":"Divergent Change (Scope: File Level)","text":"<p> Click to see details <p>Definition: \"A single class/file is frequently changed for several different reasons\"</p> <p>Divergent Change Cases in JenkinsfileDeployment:</p> Change Reason Affected Stages Count Git workflow change Prepare WORKSPACE 1 Docker config change Check Condition, Server Deploy, Client Deploy 3 Azure config change Check Condition, Server Deploy, Client Deploy 3 SonarQube config change Static Analysis 1 npm/Node config change Install Dependencies, Linting, Unit Testing 3 <p>Severity Evidence: - Impact Scope: High (Docker/Azure affects 3 stages) - Modification Cost: High (5 different change reasons in single file)</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#shotgun-surgery-scope-within-file","title":"Shotgun Surgery (Scope: Within-file)","text":"<p> Click to see details <p>Definition: \"A single change requires modifications to multiple locations\"</p> <p>Shotgun Surgery: Server/Client deploy pattern change:</p> Target Pattern Server <code>az acr show-tags</code> \u2192 <code>docker build</code> \u2192 <code>docker push</code> \u2192 <code>az containerapp update</code> \u2192 <code>docker rmi</code> Client Same 5-step pattern (duplicated) <p>Shotgun Surgery: Adding new deployment target (e.g., 'admin'):</p> Location Change Required Parameters Add <code>params.ADMIN_*</code> (3 params) Check Condition Add admin version check (20+ lines) New Stage Copy 75 lines for Admin Deploy Environment variables Add <code>env.ADMIN_SKIP_BUILD</code> <p>Severity Evidence: - Impact Scope: High (entire Deploy section) - Modification Cost: High (4+ locations, 75+ lines copy for new target)</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#12-other-code-smells-evidence-only","title":"1.2 Other Code Smells (Evidence Only)","text":""},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#bloaters","title":"Bloaters","text":"Smell Evidence Long Method Server Deploy (75 lines, 5 responsibilities), Client Deploy (73 lines, same) Primitive Obsession Deployment config scattered (<code>params.SERVER_*</code>, <code>params.CLIENT_*</code>), SonarQube URL hardcoded, directory names hardcoded"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#dispensables","title":"Dispensables","text":"Smell Evidence Duplicated Code Server/Client Deploy pattern (75 lines \u00d7 2 = 150 lines) Duplicated Code Server/Client version check pattern (20 lines \u00d7 2)"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#2-design-smells-principle-based","title":"2. Design Smells (Principle-Based)","text":"<p>Source: Suryanarayana, G. et al. (2014). Refactoring for Software Design Smells</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, the following categories are applicable:</p> Category Applicable Applied Smells Abstraction \u2713 Multifaceted Abstraction, Missing Abstraction Encapsulation \u2713 Missing Encapsulation Modularization \u2713 Insufficient Modularization Hierarchy \u2717 (no conditional branch patterns)"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#21-abstraction-smells","title":"2.1 Abstraction Smells","text":""},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#multifaceted-abstraction","title":"Multifaceted Abstraction","text":"<p> Click to see details <p>Definition: \"An abstraction has multiple responsibilities assigned to it\"</p> <p>Evidence: - Single Jenkinsfile handles 5 different concerns:   - Git commands (<code>clone</code>, <code>checkout</code>, <code>reset</code>, <code>pull</code>)   - npm/Node (version check, install, linting, testing)   - Docker (build, push, rmi)   - Azure (az login, az acr, az containerapp)   - SonarQube (scanner config, Quality Gate)</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#missing-abstraction","title":"Missing Abstraction","text":"<p> Click to see details <p>Definition: \"Clumps of data or encoded strings are used instead of creating a class or an interface\"</p> <p>Evidence:</p> Missing Abstraction Current State Occurrences Deployment target config <code>params.SERVER_*</code>, <code>params.CLIENT_*</code> scattered 6+ Azure registry config <code>env.AZ_CONTAINER_REGISTRY_NAME</code> scattered 4 Docker command options hardcoded in <code>sh</code> calls 8 SonarQube URL <code>'http://localhost:9000/sonarqube'</code> hardcoded 1"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#22-encapsulation-smells","title":"2.2 Encapsulation Smells","text":""},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#missing-encapsulation","title":"Missing Encapsulation","text":"<p> Click to see details <p>Definition: \"The encapsulation of implementation variations in a type is missing\"</p> <p>Evidence: Server/Client deploy pattern not encapsulated:</p> Target Pattern (75 lines each) Server <code>az acr show-tags</code> \u2192 <code>getPackageJsonVersion</code> \u2192 <code>versionCompare</code> \u2192 <code>docker build</code> \u2192 <code>docker push</code> \u2192 <code>az containerapp update</code> \u2192 <code>docker rmi</code> Client Same 7-step pattern <p>Impact: Adding new deployment target requires copy-paste of 75+ lines</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#23-modularization-smells","title":"2.3 Modularization Smells","text":""},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#insufficient-modularization","title":"Insufficient Modularization","text":"<p> Click to see details <p>Definition: \"An abstraction has not been completely decomposed, and remains too large\"</p> <p>Evidence: Server/Client Deploy stages:</p> Metric Value Threshold Lines (each) 75 ~30 Responsibilities 5 1-2 Duplication 150 lines total 0 <p>5 Responsibilities (duplicated): 1. Version lookup from ACR 2. Version comparison 3. Docker build 4. Docker push + Azure update 5. Docker cleanup</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/02-software-smells-analysis/#conclusion","title":"Conclusion","text":"<p>Software Smells Summary: - Code Level: Divergent Change (5 change reasons), Shotgun Surgery (4+ locations for new target), Duplicated Code (Server/Client 150 lines), Long Method (75 lines \u00d7 2) - Design Level: 5 concerns mixed, deployment config not abstracted, Server/Client pattern not encapsulated, Deploy stages insufficiently modularized</p> <p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/","title":"Design Smells Analysis","text":"<p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#jsjenkinsjenkinsfiledeployment-design-smells-symptoms-analysis","title":"JsJenkins/JenkinsfileDeployment - Design Smells Symptoms Analysis","text":"<p>Source: Martin, R.C. (2000). Design Principles and Design Patterns</p> <p>This document analyzes Martin's 7 Design Symptoms using evidence from: - SRP Violation Analysis: Inline code detection per stage - Software Smells Analysis: Code Smells (Fowler), Design Smells (Suryanarayana) - Direct code review: Readability, naming, complexity issues</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#1-rigidity","title":"1. Rigidity","text":"<p>Definition: Changing one place requires cascading changes to other places</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells","title":"Contributing Smells","text":"Smell Evidence Impact Shotgun Surgery Adding new deployment target \u2192 4+ locations (params, Check Condition, new Stage, env var) High Duplicated Code Server/Client deploy pattern change \u2192 2 locations High Primitive Obsession Deployment config scattered (<code>params.SERVER_*</code>, <code>params.CLIENT_*</code>) Medium"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#2-fragility","title":"2. Fragility","text":"<p>Definition: Modifying one place breaks conceptually unrelated places</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells_1","title":"Contributing Smells","text":"Smell Evidence Risk Shotgun Surgery Change Docker option in Server only, forget Client \u2192 inconsistent deployment High Duplicated Code Update az containerapp in Server, forget Client \u2192 partial deployment High Divergent Change 5 change reasons mixed \u2192 unexpected side effects Medium"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#3-immobility","title":"3. Immobility","text":"<p>Definition: Difficult to extract useful parts for reuse in other systems/modules</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells_2","title":"Contributing Smells","text":"Smell Evidence Impact Multifaceted Abstraction 5 concerns mixed (Git, npm, Docker, Azure, SonarQube) High Insufficient Modularization Server/Client Deploy stages with 5 responsibilities each High Missing Abstraction Deployment config scattered \u2192 can't reuse deploy logic High"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#4-viscosity","title":"4. Viscosity","text":"<p>Definition: Doing the right thing (maintaining design) is harder than doing the wrong thing (hacking)</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells_3","title":"Contributing Smells","text":"Smell Evidence Impact Missing Encapsulation Server/Client pattern not encapsulated \u2192 copy-paste for new target easier High Duplicated Code Server/Client same pattern \u2192 duplication pattern established High Long Method Deploy stages with 5 responsibilities \u2192 adding to existing easier than refactoring Medium"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#5-needless-complexity","title":"5. Needless Complexity","text":"<p>Definition: Over-engineering for features not currently needed</p> <p>Symptom: \"I might need this later\" (YAGNI violation)</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#evidence","title":"Evidence","text":"<p>No clear evidence of over-engineering found in JenkinsfileDeployment.</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#6-needless-repetition","title":"6. Needless Repetition","text":"<p>Definition: Code that could be unified through abstraction is duplicated in multiple places</p> <p>Symptom: \"Same code in multiple places\" (DRY violation)</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#contributing-smells_4","title":"Contributing Smells","text":"Smell Evidence Impact Duplicated Code Server/Client Deploy pattern (5 steps \u00d7 2) High Duplicated Code Server/Client version check pattern Medium Missing Encapsulation Same 5-step deploy pattern repeated without extraction High"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#7-opacity","title":"7. Opacity","text":"<p>Definition: Code is difficult to understand and intent is unclear</p> <p>Symptom: \"What does this code do?\"</p>"},{"location":"problem-analysis/07-JsJenkins-JenkinsfileDeployment/03-design-smells-symptoms/#evidence-code-review","title":"Evidence (Code Review)","text":"Issue Evidence Impact Duplicate nested script <code>script { script { COMMIT_HASH = ... } }</code> (lines 96-100) Medium Complex nesting Server/Client Deploy stages with <code>catchError</code> + <code>warnError</code> + <code>return</code> Medium Inline shell commands <code>sh</code> calls scattered across 9 stages (29 total) Medium <p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/01-srp-violation-analysis/","title":"SRP Violation Analysis","text":"<p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/01-srp-violation-analysis/#pipelineforjenkinsjenkinsfile-srp-violation-analysis","title":"PipelineForJenkins/Jenkinsfile - SRP Violation Analysis","text":"<p>Pipeline Role: Orchestration only (sequence/flow control)</p> <p>SRP Violation: If inline code exists in Jenkinsfile, it violates orchestration-only principle</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/01-srp-violation-analysis/#1-srp-violation-analysis-criteria","title":"1. SRP Violation Analysis Criteria","text":"<ul> <li>Jenkinsfile Role: Orchestration (pipeline sequence/flow control)</li> <li>SRP Violation Condition: If actual logic exists in Jenkinsfile (not Helper calls)</li> <li>Analysis Method: Stage-by-Stage inline code detection</li> </ul>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/01-srp-violation-analysis/#2-inline-code-analysis-by-stage","title":"2. Inline Code Analysis by Stage","text":"Stage Inline Code Type Count Prepare Workspace try-catch error handling 1 Lint Groovy Code docker info + Groovy lint + Python script + Jenkinsfile lint + Python script (2x) 6 Generate Groovydoc <code>find</code> command + <code>mkdir</code> + <code>groovydoc</code> 3 Run Unit Tests <code>gradle test</code> 1 Publish Test Results <code>junit</code> 1 Static Analysis SonarQube scanner config + Quality Gate logic 2"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/01-srp-violation-analysis/#3-inline-code-details-by-stage","title":"3. Inline Code Details by Stage","text":"<code>Prepare Workspace</code> stage (1 inline code) <pre><code>script {\n    dir(\"${PROJECT_DIR}\") {\n        try {\n            // Helper calls...\n        } catch (Exception e) {  // Inline: try-catch error handling\n            echo \"Error in Prepare Workspace stage: ${e.getMessage()}\"\n            currentBuild.result = buildResults.FAILURE\n            error(\"Workspace preparation failed: ${e.getMessage()}\")\n        }\n    }\n}\n</code></pre> <code>Lint Groovy Code</code> stage (6 inline codes) - Most Severe <pre><code>script {\n    sh 'docker info'  // Inline 1: Docker info\n\n    def imageStr = 'nvuillam/npm-groovy-lint'\n    def entrypointStr = '--entrypoint=\"\"'\n\n    // Groovy lint (Inline 2)\n    def exitCodeGroovy = docker.image(imageStr).inside(entrypointStr) {\n        return sh(\n            returnStatus: true,\n            script: \"\"\"\n                npm-groovy-lint \\\\\n                    --failon error \\\\\n                    --output groovy-lint-report.json \\\\\n                    --config ${PROJECT_DIR}/.groovylintrc.groovy.json \\\\\n                    ${PROJECT_DIR}/groovy\n            \"\"\"\n        )\n    }\n\n    if (exitCodeGroovy != 0) {\n        // Inline 3: Python script call\n        sh script: \"\"\"\\\n            python '${env.WORKSPACE}/python/Lint_groovy_report.py' ...\n        \"\"\".stripIndent()\n    }\n\n    // Jenkinsfile lint (Inline 4) - Same pattern as Groovy\n    def exitCodeJenkins = docker.image(imageStr).inside(entrypointStr) {\n        return sh(\n            returnStatus: true,\n            script: \"\"\"\n                npm-groovy-lint \\\\\n                    --failon error \\\\\n                    --output jenkins-lint-report.json \\\\\n                    --config ${PROJECT_DIR}/.groovylintrc.jenkins.json \\\\\n                    ${PROJECT_DIR}/DLXJenkins \\\\\n                    ${PROJECT_DIR}/JsJenkins \\\\\n                    ${PROJECT_DIR}/PipelineForJenkins\n            \"\"\"\n        )\n    }\n\n    if (exitCodeJenkins != 0 || exitCodeGroovy != 0) {\n        // Inline 5: Python script call (Fail)\n        sh script: \"\"\"...\"\"\".stripIndent()\n    } else {\n        // Inline 6: Python script call (Pass)\n        sh script: \"\"\"...\"\"\".stripIndent()\n    }\n}\n</code></pre> <code>Generate Groovydoc</code> stage (3 inline codes) <pre><code>script {\n    dir(PROJECT_DIR) {\n        def fileList = sh(\n            script: \"find ${PROJECT_DIR}/groovy -type f -name '*.groovy'\",  // Inline 1: find command\n            returnStdout: true).trim()\n\n        sh \"\"\"\n        mkdir -p ${REPORT_DIR}  // Inline 2: mkdir\n        groovydoc -verbose -d ${REPORT_DIR} ${fileList.replaceAll('\\\\s+', ' ')}  // Inline 3: groovydoc\n        \"\"\"\n    }\n}\n</code></pre> <code>Run Unit Tests</code> stage (1 inline code) <pre><code>script {\n    sh 'gradle test'  // Inline: gradle test\n}\n</code></pre> <code>Publish Test Results</code> stage (1 inline code) <pre><code>script {\n    junit 'build/test-results/test/*.xml'  // Inline: junit\n}\n</code></pre> <code>Static Analysis</code> stage (2 inline codes) <pre><code>// SonarQube scanner config (Inline 1)\nscript {\n    catchError(buildResults: buildResults.SUCCESS, stageResults: stageResults.FAILURE) {  // Note: typo in parameter names\n        String scannerHome = tool SONARQUBE_SCANNER\n        withSonarQubeEnv(SONARQUBE_SERVER) {\n            String sonarCommand = \"\\\"${scannerHome}/bin/sonar-scanner\\\" \" +\n                \"\\\"-Dsonar.projectKey=${env.SONAR_PROJECT_KEY}\\\" \" +\n                '\\\"-Dsonar.host.url=http://localhost:9000/sonarqube\\\" ' +\n                // ... more options\n            sh sonarCommand\n        }\n    }\n}\n\n// Quality Gate check logic (Inline 2)\nscript {\n    catchError(buildResults: buildResults.SUCCESS, stageResults: stageResults.FAILURE) {\n        Map status = generalUtil.checkQualityGateStatus(SONAR_PROJECT_KEY, env.SONAR_QUBE_AUTH_TOKEN)\n        if ((status.entireCodeStatus != STATUS_OK) || (status.newCodeStatus != STATUS_OK)) {\n            error('Quality gate failed!')\n        }\n    }\n}\n</code></pre>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/01-srp-violation-analysis/#4-inline-code-summary","title":"4. Inline Code Summary","text":"Type Count Stages Docker container execution 2 Lint Groovy Code (Groovy + Jenkinsfile) Python script direct call 3 Lint Groovy Code File System (<code>find</code>, <code>mkdir</code>) 2 Generate Groovydoc Gradle command 1 Run Unit Tests Groovydoc command 1 Generate Groovydoc SonarQube config + Quality Gate 2 Static Analysis try-catch error handling 1 Prepare Workspace"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/01-srp-violation-analysis/#conclusion","title":"Conclusion","text":"<p>SRP Violation: - Total 14 inline codes across 6 stages - Lint Groovy Code Stage: Most severe (6 inline codes, Groovy/Jenkinsfile same pattern duplicated) - Static Analysis Stage: SonarQube scanner config directly in Jenkinsfile - Key difference from other pipelines: Docker container for linting, Gradle/Groovydoc commands - Bug: <code>catchError</code> parameter typo (<code>buildResults</code> \u2192 <code>buildResult</code>, <code>stageResults</code> \u2192 <code>stageResult</code>) - Recommendation: Extract lint logic to Helper function, fix catchError typo</p> <p>\u2190 Overview | Software Smells \u2192</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/","title":"Software Smells Analysis","text":"<p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#pipelineforjenkinsjenkinsfile-software-smells-analysis","title":"PipelineForJenkins/Jenkinsfile - Software Smells Analysis","text":"<p>Classification based on industry-standard taxonomy: Code Smells (Fowler) \u2192 Design Smells (Suryanarayana)</p> <p>Inline Code Analysis: 14 inline codes across 6 stages. See SRP Violation Analysis</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#1-code-smells","title":"1. Code Smells","text":"<p>Source: Fowler, M. (1999). Refactoring: Improving the Design of Existing Code</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, only the following categories are applicable:</p> Category Applicable Applied Smells Bloaters \u2713 Primitive Obsession Object-Orientation Abusers \u2717 (not applicable - no OOP) Change Preventers \u2713 Divergent Change, Shotgun Surgery Dispensables \u2713 Duplicated Code Couplers \u2717 (not applicable - no class relationships)"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#11-change-preventers-with-severity-criteria","title":"1.1 Change Preventers (with Severity Criteria)","text":""},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#severity-criteria","title":"Severity Criteria","text":"Metric Low Medium High Impact Scope 1-2 stages 3-4 stages 5+ stages Modification Cost 1-2 locations 3-5 locations 6+ locations"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#divergent-change-scope-file-level","title":"Divergent Change (Scope: File Level)","text":"<p> Click to see details <p>Definition: \"A single class/file is frequently changed for several different reasons\"</p> <p>Divergent Change Cases in PipelineForJenkins/Jenkinsfile:</p> Change Reason Affected Stages Count Groovy/Jenkinsfile lint config change Lint Groovy Code 1 Groovydoc config change Generate Groovydoc 1 Gradle config change Run Unit Tests 1 SonarQube config change Static Analysis 1 <p>Severity Evidence: - Impact Scope: Medium (4 different concerns) - Modification Cost: Medium (4 different change reasons in single file)</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#shotgun-surgery-scope-within-file","title":"Shotgun Surgery (Scope: Within-file)","text":"<p> Click to see details <p>Definition: \"A single change requires modifications to multiple locations\"</p> <p>Shotgun Surgery: Groovy/Jenkinsfile lint pattern change:</p> Type Pattern Groovy <code>docker.image().inside()</code> \u2192 <code>npm-groovy-lint</code> \u2192 <code>if (exitCode != 0)</code> \u2192 Python report Jenkinsfile Same pattern (duplicated) <p>Shotgun Surgery: Adding new lint type (e.g., 'Python'):</p> Location Change Required Docker image variable Add new image if needed Lint execution block Add 15+ lines Result handling block Add 15+ lines Final condition Add <code>|| exitCodePython != 0</code> <p>Severity Evidence: - Impact Scope: Medium (Lint Groovy Code stage) - Modification Cost: Medium (4 locations, 30+ lines for new type)</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#12-other-code-smells-evidence-only","title":"1.2 Other Code Smells (Evidence Only)","text":""},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#bloaters","title":"Bloaters","text":"Smell Evidence Primitive Obsession Docker image hardcoded (<code>'nvuillam/npm-groovy-lint'</code>), lint config files hardcoded, SonarQube URL hardcoded, lint target folders hardcoded"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#dispensables","title":"Dispensables","text":"Smell Evidence Duplicated Code Groovy/Jenkinsfile lint execution pattern (15 lines \u00d7 2) Duplicated Code Groovy/Jenkinsfile lint result handling pattern (15 lines \u00d7 2)"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#2-design-smells-principle-based","title":"2. Design Smells (Principle-Based)","text":"<p>Source: Suryanarayana, G. et al. (2014). Refactoring for Software Design Smells</p> <p>Applicable Categories: Since Jenkinsfile is an orchestration script, the following categories are applicable:</p> Category Applicable Applied Smells Abstraction \u2713 Multifaceted Abstraction, Missing Abstraction Encapsulation \u2713 Missing Encapsulation Modularization \u2717 (single file) Hierarchy \u2717 (no conditional branch patterns)"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#21-abstraction-smells","title":"2.1 Abstraction Smells","text":""},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#multifaceted-abstraction","title":"Multifaceted Abstraction","text":"<p> Click to see details <p>Definition: \"An abstraction has multiple responsibilities assigned to it\"</p> <p>Evidence: - Single Jenkinsfile handles 4 different concerns:   - Docker-based linting (Groovy + Jenkinsfile)   - Groovydoc generation   - Gradle unit tests   - SonarQube analysis + Quality Gate</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#missing-abstraction","title":"Missing Abstraction","text":"<p> Click to see details <p>Definition: \"Clumps of data or encoded strings are used instead of creating a class or an interface\"</p> <p>Evidence:</p> Missing Abstraction Current State Occurrences Lint config config file, targets, report file hardcoded separately 2 Docker image <code>'nvuillam/npm-groovy-lint'</code> hardcoded 1 SonarQube URL <code>'http://localhost:9000/sonarqube'</code> hardcoded 1 Lint target folders <code>'DLXJenkins'</code>, <code>'JsJenkins'</code>, <code>'PipelineForJenkins'</code> hardcoded 1"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#22-encapsulation-smells","title":"2.2 Encapsulation Smells","text":""},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#missing-encapsulation","title":"Missing Encapsulation","text":"<p> Click to see details <p>Definition: \"The encapsulation of implementation variations in a type is missing\"</p> <p>Evidence: Groovy/Jenkinsfile lint pattern not encapsulated:</p> Type Pattern (30 lines each) Groovy <code>docker.image().inside()</code> \u2192 <code>npm-groovy-lint --config .groovylintrc.groovy.json</code> \u2192 Python report Jenkinsfile Same pattern with <code>.groovylintrc.jenkins.json</code> <p>Impact: Adding new lint type requires copy-paste of 30+ lines</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#3-implementation-issues-code-review","title":"3. Implementation Issues (Code Review)","text":""},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#catcherror-parameter-typo","title":"catchError Parameter Typo","text":"<p> Click to see details <p>Evidence:</p> Line Current (Typo) Correct 247 <code>catchError(buildResults: ..., stageResults: ...)</code> <code>catchError(buildResult: ..., stageResult: ...)</code> 271 Same typo Same fix <p>Impact: Jenkins Pipeline DSL may ignore incorrect parameter names, causing unexpected behavior</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/02-software-smells-analysis/#conclusion","title":"Conclusion","text":"<p>Software Smells Summary: - Code Level: Divergent Change (4 change reasons), Shotgun Surgery (4 locations for new lint type), Duplicated Code (Groovy/Jenkinsfile lint 30 lines \u00d7 2) - Design Level: 4 concerns mixed, lint config not abstracted, lint pattern not encapsulated - Implementation Issue: <code>catchError</code> parameter typo (lines 247, 271)</p> <p>\u2190 SRP Analysis</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/","title":"Design Smells Analysis","text":"<p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#pipelineforjenkinsjenkinsfile-design-smells-symptoms-analysis","title":"PipelineForJenkins/Jenkinsfile - Design Smells Symptoms Analysis","text":"<p>Source: Martin, R.C. (2000). Design Principles and Design Patterns</p> <p>This document analyzes Martin's 7 Design Symptoms using evidence from: - SRP Violation Analysis: Inline code detection per stage - Software Smells Analysis: Code Smells (Fowler), Design Smells (Suryanarayana) - Direct code review: Readability, naming, complexity issues</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#1-rigidity","title":"1. Rigidity","text":"<p>Definition: Changing one place requires cascading changes to other places</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells","title":"Contributing Smells","text":"Smell Evidence Impact Shotgun Surgery Adding new lint type \u2192 4 locations Medium Duplicated Code Groovy/Jenkinsfile lint pattern change \u2192 2 locations (30 lines each) Medium Primitive Obsession Lint config hardcoded (config file, targets, report file separately) Low"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#2-fragility","title":"2. Fragility","text":"<p>Definition: Modifying one place breaks conceptually unrelated places</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_1","title":"Contributing Smells","text":"Smell Evidence Risk Shotgun Surgery Miss one of 4 lint locations \u2192 incomplete lint Medium Duplicated Code Update Groovy lint pattern, forget Jenkinsfile \u2192 inconsistent behavior High Divergent Change 4 change reasons mixed \u2192 unexpected side effects Medium"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#3-immobility","title":"3. Immobility","text":"<p>Definition: Difficult to extract useful parts for reuse in other systems/modules</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_2","title":"Contributing Smells","text":"Smell Evidence Impact Multifaceted Abstraction 4 concerns mixed (lint, groovydoc, gradle, SonarQube) High Missing Abstraction Lint config scattered \u2192 can't reuse lint logic Medium"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#4-viscosity","title":"4. Viscosity","text":"<p>Definition: Doing the right thing (maintaining design) is harder than doing the wrong thing (hacking)</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_3","title":"Contributing Smells","text":"Smell Evidence Impact Missing Encapsulation Groovy/Jenkinsfile lint pattern not encapsulated \u2192 copy-paste for new type easier Medium Duplicated Code Groovy/Jenkinsfile 30 lines \u00d7 2 \u2192 duplication pattern established Medium"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#5-needless-complexity","title":"5. Needless Complexity","text":"<p>Definition: Over-engineering for features not currently needed</p> <p>Symptom: \"I might need this later\" (YAGNI violation)</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#evidence","title":"Evidence","text":"<p>No clear evidence of over-engineering found in PipelineForJenkins/Jenkinsfile.</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#6-needless-repetition","title":"6. Needless Repetition","text":"<p>Definition: Code that could be unified through abstraction is duplicated in multiple places</p> <p>Symptom: \"Same code in multiple places\" (DRY violation)</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#contributing-smells_4","title":"Contributing Smells","text":"Smell Evidence Impact Duplicated Code Groovy/Jenkinsfile lint execution pattern (15 lines \u00d7 2) High Duplicated Code Groovy/Jenkinsfile lint result handling pattern (15 lines \u00d7 2) High Missing Encapsulation Same patterns repeated without extraction Medium"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#7-opacity","title":"7. Opacity","text":"<p>Definition: Code is difficult to understand and intent is unclear</p> <p>Symptom: \"What does this code do?\"</p>"},{"location":"problem-analysis/08-PipelineForJenkins-Jenkinsfile/03-design-smells-symptoms/#evidence-code-review","title":"Evidence (Code Review)","text":"Issue Evidence Impact catchError parameter typo <code>buildResults:</code> \u2192 <code>buildResult:</code>, <code>stageResults:</code> \u2192 <code>stageResult:</code> (lines 247, 271) High (potential bug) <p>\u2190 SRP Analysis | Software Smells \u2192</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/","title":"Baseline Technical Snapshot","text":"<p>Note: This document was analyzed based on commit <code>54479b2</code>.</p> <p>Other documents in <code>problem-analysis/</code> use commit <code>74fc356</code> as the baseline.</p> <p>Difference in analysis direction: - This document: Focused on code statistics, file structure, technical state - problem-analysis/: Problem analysis based on Software Smells classification system</p> <p>Commit: <code>54479b2</code> (2025-02-21) - \"emergency fixed\"</p> <p>This document provides a comprehensive analysis of the codebase state before the architectural refactoring.</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Code Statistics</li> <li>File Structure</li> <li>Domain Analysis</li> <li>Architecture Analysis</li> <li>Folder-by-Folder Analysis</li> <li>Critical Problems</li> <li>Code Duplication Analysis (Detailed)</li> <li>Dependency Graph</li> <li>Technical Debt Summary</li> <li>Summary Table</li> <li>Key Issues for Refactoring</li> </ol>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#1-code-statistics","title":"1. Code Statistics","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#11-total-lines-by-category","title":"1.1 Total Lines by Category","text":"Category Files Lines Percentage Jenkinsfiles 5 1,239 33.1% Groovy Helpers 3 1,148 30.6% Python Scripts 9 749 20.0% Bash Scripts 2 330 8.8% Tests 2 84 2.2% Config/Other 6 195 5.2% TOTAL 27 3,745 100%"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#12-detailed-line-counts","title":"1.2 Detailed Line Counts","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#jenkinsfiles-1239-lines","title":"Jenkinsfiles (1,239 lines)","text":"File Lines DLXJenkins/Jenkinsfile 249 DLXJenkins/JenkinsfileDeployment 242 JsJenkins/Jenkinsfile 198 JsJenkins/JenkinsfileDeployment 372 PipelineForJenkins/Jenkinsfile 178"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#groovy-helpers-1148-lines","title":"Groovy Helpers (1,148 lines)","text":"File Lines groovy/generalHelper.groovy 403 groovy/jsHelper.groovy 408 groovy/unityHelper.groovy 337"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#python-scripts-749-lines","title":"Python Scripts (749 lines)","text":"File Lines python/linting_error_report.py 203 python/create_bitbucket_test_report.py 152 python/npm_audit.py 137 python/send_bitbucket_build_status.py 64 python/create_log_report.py 56 python/get_bitbucket_commit_hash.py 38 python/get_unity_version.py 34 python/get_unity_failure.py 26 python/log-template/logs.html 39"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#tests-84-lines","title":"Tests (84 lines)","text":"File Lines tests/JsHelperSpec.groovy 66 tests/GeneralHelperSpec.groovy 18"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#other-files-525-lines","title":"Other Files (525 lines)","text":"File Lines Bash/.editorconfig 264 Bash/Linting.bash 66 PipelineForJenkins/.groovylintrc.groovy.json 43 PipelineForJenkins/.groovylintrc.jenkins.json 19 .gitignore 51 build.gradle 42 Builder.cs 36 logErrors.txt 4"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#2-file-structure-27-files","title":"2. File Structure (27 files)","text":"<pre><code>54479b2/\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 build.gradle                          # Gradle build configuration\n\u251c\u2500\u2500 Builder.cs                            # Unity WebGL build script\n\u251c\u2500\u2500 logErrors.txt                         # Error log file\n\u2502\n\u251c\u2500\u2500 DLXJenkins/                           # Unity Project Pipeline\n\u2502   \u251c\u2500\u2500 Jenkinsfile                       # PR Pipeline (249 lines)\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment             # Deployment Pipeline (242 lines)\n\u2502\n\u251c\u2500\u2500 JsJenkins/                            # JavaScript Project Pipeline\n\u2502   \u251c\u2500\u2500 Jenkinsfile                       # PR Pipeline (198 lines)\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment             # Deployment Pipeline (372 lines)\n\u2502\n\u251c\u2500\u2500 PipelineForJenkins/                   # Jenkins Self Pipeline\n\u2502   \u251c\u2500\u2500 Jenkinsfile                       # (178 lines)\n\u2502   \u251c\u2500\u2500 .groovylintrc.groovy.json         # Groovy lint config\n\u2502   \u2514\u2500\u2500 .groovylintrc.jenkins.json        # Jenkins lint config\n\u2502\n\u251c\u2500\u2500 groovy/                               # Helper Scripts\n\u2502   \u251c\u2500\u2500 generalHelper.groovy              # Common utilities (403 lines)\n\u2502   \u251c\u2500\u2500 unityHelper.groovy                # Unity-specific (337 lines)\n\u2502   \u2514\u2500\u2500 jsHelper.groovy                   # JavaScript-specific (408 lines)\n\u2502\n\u251c\u2500\u2500 Bash/\n\u2502   \u251c\u2500\u2500 .editorconfig                     # Editor configuration\n\u2502   \u2514\u2500\u2500 Linting.bash                      # dotnet format linting script\n\u2502\n\u251c\u2500\u2500 python/                               # Python Scripts\n\u2502   \u251c\u2500\u2500 send_bitbucket_build_status.py    # Send build status\n\u2502   \u251c\u2500\u2500 create_bitbucket_test_report.py   # Send test report\n\u2502   \u251c\u2500\u2500 create_log_report.py              # Generate log report\n\u2502   \u251c\u2500\u2500 get_bitbucket_commit_hash.py      # Get commit hash\n\u2502   \u251c\u2500\u2500 get_unity_failure.py              # Analyze Unity failures\n\u2502   \u251c\u2500\u2500 get_unity_version.py              # Get Unity version\n\u2502   \u251c\u2500\u2500 linting_error_report.py           # Linting error report\n\u2502   \u251c\u2500\u2500 npm_audit.py                      # npm security audit\n\u2502   \u2514\u2500\u2500 log-template/logs.html            # Log HTML template\n\u2502\n\u2514\u2500\u2500 tests/                                # Tests\n    \u251c\u2500\u2500 GeneralHelperSpec.groovy          # generalHelper tests\n    \u2514\u2500\u2500 JsHelperSpec.groovy               # jsHelper tests\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#3-domain-analysis","title":"3. Domain Analysis","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#31-project-types","title":"3.1 Project Types","text":"Domain Pipeline Files Helper Unity Project DLXJenkins/Jenkinsfile, JenkinsfileDeployment unityHelper.groovy JavaScript Project JsJenkins/Jenkinsfile, JenkinsfileDeployment jsHelper.groovy Jenkins Pipeline Project PipelineForJenkins/Jenkinsfile generalHelper.groovy"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#32-pipeline-types","title":"3.2 Pipeline Types","text":"Type Trigger Purpose PR Pipeline <code>PR_STATE = 'OPEN'</code> Pull Request validation (tests, linting, static analysis) Deployment Pipeline <code>PR_STATE = 'MERGED'</code> Deployment (branch cleanup, build, server deployment)"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#4-architecture-analysis","title":"4. Architecture Analysis","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#41-current-architecture-flatmonolithic","title":"4.1 Current Architecture: Flat/Monolithic","text":"<pre><code>flowchart TB\n    subgraph Jenkinsfile[\"Jenkinsfile Layer\"]\n        direction TB\n        J1[\"Pipeline declaration\"]\n        J2[\"Stage definitions\"]\n        J3[\"Business logic (inline)\"]\n        J4[\"Error handling (inline)\"]\n        J5[\"Logging (inline echo)\"]\n    end\n\n    subgraph Helper[\"groovy/*Helper.groovy Layer\"]\n        direction TB\n        H1[\"Git operations (functions)\"]\n        H2[\"API calls (Python wrapper)\"]\n        H3[\"Utility functions\"]\n        H4[\"Each file 400+ lines (everything mixed)\"]\n    end\n\n    subgraph Python[\"python/*.py Layer\"]\n        direction TB\n        P1[\"Bitbucket API calls\"]\n        P2[\"XML parsing\"]\n        P3[\"Report generation\"]\n    end\n\n    Jenkinsfile --&gt;|\"load()\"| Helper\n    Helper --&gt;|\"sh(python...)\"| Python</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#42-layer-analysis","title":"4.2 Layer Analysis","text":"<p>Only 2 effective layers exist:</p> <ol> <li>Jenkinsfile Layer: Pipeline definition + business logic mixed</li> <li>Helper Layer: groovy/.groovy + python/.py (Flat structure)</li> </ol> <p>Inter-layer dependencies:</p> <pre><code>flowchart LR\n    A[Jenkinsfile] --&gt;|\"load()\"| B[groovy/*Helper.groovy]\n    B --&gt;|\"sh(python)\"| C[python/*.py]</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#5-folder-by-folder-analysis","title":"5. Folder-by-Folder Analysis","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#51-dlxjenkins-unity-pipeline","title":"5.1 DLXJenkins/ (Unity Pipeline)","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#jenkinsfile-249-lines","title":"Jenkinsfile (249 lines)","text":"<pre><code>// Problem 1: All logic inline\nstage('Prepare WORKSPACE') {\n    steps {\n        dir (\"${PROJECT_DIR}\") {\n            script {\n                sh 'env'\n                try {\n                    generalUtil = load(\"${env.WORKSPACE}/groovy/generalHelper.groovy\")\n                    unityUtil = load(\"${env.WORKSPACE}/groovy/unityHelper.groovy\")\n                } catch (Exception e) {\n                    error \"Failed to load Groovy scripts: ${e.message}\"\n                }\n                // ... 30+ lines of logic\n            }\n        }\n    }\n}\n\n// Problem 2: Duplicated patterns repeated in every stage\nstage('Linting') {\n    steps {\n        dir(\"${REPORT_DIR}\") {\n            sh 'mkdir -p linting_results'\n        }\n        script {\n            sh \"cp -f '${env.WORKSPACE}/Bash/.editorconfig' '${PROJECT_DIR}'\"\n            def exitCode = sh script: \"sh '${env.WORKSPACE}/Bash/Linting.bash'...\", returnStatus: true\n            // ... 20+ lines of error handling\n        }\n    }\n}\n</code></pre> <p>Problems: - Stage logic written inline in Jenkinsfile - Same patterns duplicated in JenkinsfileDeployment - Structure not amenable to testing</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#jenkinsfiledeployment-242-lines","title":"JenkinsfileDeployment (242 lines)","text":"<ul> <li>70%+ code duplication with Jenkinsfile</li> <li>Only deployment-specific logic added</li> </ul>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#52-jsjenkins-javascript-pipeline","title":"5.2 JsJenkins/ (JavaScript Pipeline)","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#characteristics","title":"Characteristics","text":"<ul> <li>Same structure as DLXJenkins but uses jsHelper</li> <li>Includes Azure Container Registry deployment logic</li> <li>Includes SonarQube static analysis</li> </ul>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#problems","title":"Problems","text":"<pre><code>// Almost identical code repeated from DLXJenkins\nstage('Prepare WORKSPACE') {\n    steps {\n        dir(\"${PROJECT_DIR}\") {\n            script {\n                sh 'env'\n                generalUtil = load(\"${env.WORKSPACE}/groovy/generalHelper.groovy\")\n                jsUtil = load(\"${env.WORKSPACE}/groovy/jsHelper.groovy\")\n                // ... same pattern\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#53-groovy-helper-scripts","title":"5.3 groovy/ (Helper Scripts)","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#generalhelpergroovy-403-lines","title":"generalHelper.groovy (403 lines)","text":"<p>Functions included (mixed): 1. Git operations: cloneOrUpdateRepo, checkoutBranch, mergeBranchIfNeeded, isBranchUpToDateWithRemote 2. Environment setup: initializeEnvironment, parseTicketNumber 3. API calls: sendBuildStatus (Python wrapper) 4. Server deployment: publishTestResultsHtmlToWebServer, cleanMergedBranchReportsFromWebServer 5. File cleanup: cleanUpPRBranch, closeLogfiles</p> <p>Problems:</p> <pre><code>// Problem 1: All functionality mixed in one file\ndef cloneOrUpdateRepo(...) {\n    // Git logic\n}\ndef sendBuildStatus(...) {\n    // Python script call\n    sh \"python '${workspace}/python/send_bitbucket_build_status.py'...\"\n}\ndef publishTestResultsHtmlToWebServer(...) {\n    // SSH/SCP commands\n}\n\n// Problem 2: Duplicated shell commands\nsh 'git reset --hard'\nsh 'git clean -fd'\nsh \"git checkout ${targetBranch}\"\n// Repeated in multiple functions\n\n// Problem 3: Inconsistent error handling\ncatch (Exception e) {\n    echo \"An error occurred: ${e.getMessage()}\"\n    error('Merge process failed.')\n}\n// vs\ncatch (Exception e) {\n    error(\"Failed to execute: ${e.message}\")\n}\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#unityhelpergroovy-337-lines","title":"unityHelper.groovy (337 lines)","text":"<p>Functions included: - Unity Batch Mode execution - Test report generation - Code Coverage configuration</p> <p>Problems: <pre><code>// Problem: Giant functions (100+ lines)\nint runUnityBatchMode(String unityExecutable, String projectDirectory, String reportDirectory, String stageName) {\n    // Closure definitions\n    Closure setLogFilePathAndUrl = { ... }\n    Closure&lt;String&gt; getTestRunArgs = { ... }\n    Closure&lt;String&gt; getAdditionalArgs = { ... }\n\n    // All stages handled in one function\n    if (['EditMode', 'PlayMode'].contains(stageName)) { ... }\n    else if (stageName == 'Coverage') { ... }\n    else if (['Webgl', 'Rider'].contains(stageName)) { ... }\n    // ... 100+ lines\n}\n</code></pre></p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#jshelpergroovy-408-lines","title":"jsHelper.groovy (408 lines)","text":"<p>Functions included: - npm command execution - SonarQube integration - Azure Container deployment</p> <p>Problems: - Same issues as generalHelper.groovy - Duplicated OS branching logic (isUnix() checks)</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#54-python-api-scripts","title":"5.4 python/ (API Scripts)","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#role","title":"Role","text":"<p>Handles HTTP API calls that are difficult to do directly in Groovy</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#file-list","title":"File List","text":"File Purpose send_bitbucket_build_status.py Send build status to Bitbucket create_bitbucket_test_report.py Send test report get_bitbucket_commit_hash.py Get commit hash linting_error_report.py Linting error report npm_audit.py npm security audit get_unity_failure.py Analyze Unity failures get_unity_version.py Get Unity version <p>Problems: <pre><code># Problem 1: Groovy calling Python \u2192 complex dependency\ndef sendBuildStatus(workspace, state, commitHash, deployment = false, javascript = false) {\n    def pythonCommand = \"python '${workspace}/python/send_bitbucket_build_status.py' '${commitHash}' '${state}'\"\n    sh(script: pythonCommand, returnStatus: true)\n}\n\n# Problem 2: Debugging difficult on errors\n# - Only exit code returned\n# - Detailed error messages lost\n</code></pre></p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#55-bash-shell-scripts","title":"5.5 Bash/ (Shell Scripts)","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#lintingbash","title":"Linting.bash","text":"<pre><code># Script for C# project linting\ndotnet format \"$SOLUTION_FILE\" --verify-no-changes\n</code></pre> <p>Problems: - Called directly from Jenkinsfile \u2192 difficult to test - Error code interpretation done in Jenkinsfile</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#56-tests-test-files","title":"5.6 tests/ (Test Files)","text":"<pre><code>// GeneralHelperSpec.groovy\nclass GeneralHelperSpec extends Specification {\n    def \"parseTicketNumber should extract ticket numbers\"() {\n        // Only one function tested\n    }\n}\n</code></pre> <p>Problems: - Extremely low test coverage (only parseTicketNumber function) - Most functions depend on Jenkins environment, cannot be tested</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#6-critical-problems","title":"6. Critical Problems","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#61-impact-of-file-changes","title":"6.1 Impact of File Changes","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#when-generalhelpergroovy-is-modified","title":"When generalHelper.groovy is modified:","text":"<pre><code>flowchart TB\n    GH[generalHelper.groovy]\n    GH --&gt; D1[DLXJenkins/Jenkinsfile]\n    GH --&gt; D2[DLXJenkins/JenkinsfileDeployment]\n    GH --&gt; J1[JsJenkins/Jenkinsfile]\n    GH --&gt; J2[JsJenkins/JenkinsfileDeployment]\n    GH --&gt; P1[PipelineForJenkins/Jenkinsfile]</code></pre> <p>\u2192 All 5 pipelines affected! \u2192 Risk of system-wide failure when deployed without testing</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#when-pythonsend_bitbucket_build_statuspy-is-modified","title":"When python/send_bitbucket_build_status.py is modified:","text":"<pre><code>flowchart TB\n    PY[send_bitbucket_build_status.py]\n    PY --&gt; GH[generalHelper.sendBuildStatus]\n    GH --&gt; D1[DLXJenkins/Jenkinsfile&lt;br/&gt;post success/failure]\n    GH --&gt; D2[DLXJenkins/JenkinsfileDeployment&lt;br/&gt;post success/failure]\n    GH --&gt; J1[JsJenkins/Jenkinsfile&lt;br/&gt;post success/failure]\n    GH --&gt; J2[JsJenkins/JenkinsfileDeployment&lt;br/&gt;post success/failure]\n    GH --&gt; P1[PipelineForJenkins/Jenkinsfile&lt;br/&gt;post success/failure]</code></pre> <p>\u2192 Affects Bitbucket status updates for all pipelines!</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#62-code-duplication-overview","title":"6.2 Code Duplication Overview","text":"<pre><code>// Patterns repeated across 5 Jenkinsfiles\n\n// Pattern 1: Helper loading (~10 lines \u00d7 5)\ngeneralUtil = load(\"${env.WORKSPACE}/groovy/generalHelper.groovy\")\n\n// Pattern 2: Branch check (~15 lines \u00d7 5)\nif (generalUtil.isBranchUpToDateWithRemote(PR_BRANCH)...) {\n    currentBuild.result = 'ABORTED'\n    error('Branch is up to date...')\n}\n\n// Pattern 3: Post actions (~20 lines \u00d7 5)\npost {\n    success { generalUtil.sendBuildStatus(..., 'SUCCESSFUL'...) }\n    failure { generalUtil.sendBuildStatus(..., 'FAILED'...) }\n    aborted { generalUtil.sendBuildStatus(..., 'STOPPED'...) }\n}\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#63-testability-issues","title":"6.3 Testability Issues","text":"Component Testable? Reason Jenkinsfile No Requires Jenkins environment generalHelper.groovy Partial (1 function only) Depends on Jenkins APIs (sh, withCredentials, etc.) unityHelper.groovy No Requires Jenkins + Unity environment jsHelper.groovy No Requires Jenkins + Node.js environment python/*.py Partial Requires environment variables + API tokens"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#64-logging-problems","title":"6.4 Logging Problems","text":"<pre><code>// Inconsistent echo usage\necho 'Identifying Unity version...'\necho \"Parameters for bash: ${env.WORKSPACE}/Linting.bash...\"\necho \"After bash call, exit code: ${exitCode}\"\necho 'Error linting calling report'\n\n// Problems:\n// 1. No Stage/Step distinction\n// 2. Inconsistent format\n// 3. Difficult to identify error location\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#65-inconsistent-error-handling","title":"6.5 Inconsistent Error Handling","text":"<pre><code>// Method 1: catch + echo + error\ncatch (Exception e) {\n    echo \"An error occurred: ${e.getMessage()}\"\n    error('Process failed.')\n}\n\n// Method 2: catch + error directly\ncatch (Exception e) {\n    error \"Failed: ${e.message}\"\n}\n\n// Method 3: catchError\ncatchError(buildResult: 'SUCCESS', stageResult: 'FAILURE') {\n    error(\"Failed with exit code: ${exitCode}\")\n}\n\n// Problems:\n// - Stack trace lost\n// - Difficult to trace where error occurred\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#7-code-duplication-analysis-detailed","title":"7. Code Duplication Analysis (Detailed)","text":"<p>This section provides a comprehensive analysis of duplicated code patterns found across the codebase in commit 54479b2.</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#duplication-definition","title":"Duplication Definition","text":"<p>What IS counted as duplication: - Structural patterns appearing in multiple files with similar/identical code - Boilerplate code that could be extracted to shared modules - Copy-paste patterns where same logic exists in different locations</p> <p>What is NOT counted: - Project-specific configuration values (different env vars per project) - Intentional variations (OPEN vs MERGED triggers) - Single occurrences of any pattern</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#71-duplication-summary","title":"7.1 Duplication Summary","text":"Category Duplicated Lines Base Lines Percentage Jenkinsfile Patterns 463 1,239 37.4% Groovy Helper Patterns 106 1,148 9.2% Total 569 3,136* 18.1% <p>*Base = Jenkinsfiles (1,239) + Groovy Helpers (1,148) + Python (749), excluding Tests (84) and Config (525)</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#72-jenkinsfile-duplication-patterns","title":"7.2 Jenkinsfile Duplication Patterns","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-1-parameters-block-47-lines-total","title":"Pattern 1: Parameters Block (47 lines total)","text":"File Lines DLXJenkins/Jenkinsfile 10 DLXJenkins/JenkinsfileDeployment 9 JsJenkins/Jenkinsfile 10 JsJenkins/JenkinsfileDeployment 8 PipelineForJenkins/Jenkinsfile 10 <pre><code>parameters {\n    string(name: 'PR_BRANCH', defaultValue: '', description: '')\n    string(name: 'PR_DESTINATION_BRANCH', defaultValue: '', description: '')\n    string(name: 'PR_REPO_HTML', defaultValue: '', description: '')\n    string(name: 'PR_REPO_NAME', defaultValue: '', description: '')\n    string(name: 'PR_COMMIT', defaultValue: '', description: '')\n    string(name: 'PR_PROJECT', defaultValue: '', description: '')\n    string(name: 'PR_STATE', defaultValue: '', description: '')\n    string(name: 'TEST_RUN', defaultValue: '', description: '...')\n}\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-2-triggers-block-83-lines-total","title":"Pattern 2: Triggers Block (83 lines total)","text":"File Lines DLXJenkins/Jenkinsfile 17 DLXJenkins/JenkinsfileDeployment 17 JsJenkins/Jenkinsfile 17 JsJenkins/JenkinsfileDeployment 16 PipelineForJenkins/Jenkinsfile 16 <pre><code>triggers {\n    GenericTrigger(\n        genericVariables: [\n            [key: 'PR_BRANCH', value: '$.pullrequest.source.branch.name'],\n            [key: 'PR_DESTINATION_BRANCH', value: '$.pullrequest.destination.branch.name'],\n            [key: 'PR_REPO_HTML', value: '$.repository.links.self.href'],\n            [key: 'PR_REPO_NAME', value: '$.repository.name'],\n            [key: 'PR_COMMIT', value: '$.pullrequest.source.commit.hash'],\n            [key: 'PR_PROJECT', value: '$.repository.full_name'],\n            [key: 'PR_STATE', value: '$.pullrequest.state']\n        ],\n        tokenCredentialId: 'trigger-token',\n        regexpFilterText: '$PR_STATE',\n        regexpFilterExpression: 'OPEN'  // or 'MERGED' for deployment\n    )\n}\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-3-environment-block-63-lines-total","title":"Pattern 3: Environment Block (63 lines total)","text":"File Lines DLXJenkins/Jenkinsfile 11 DLXJenkins/JenkinsfileDeployment 10 JsJenkins/Jenkinsfile 16 JsJenkins/JenkinsfileDeployment 14 PipelineForJenkins/Jenkinsfile 12 <pre><code>environment {\n    CI_PIPELINE = 'true'\n    PROJECT_TYPE = 'Unity_Project'\n    PROJECT_DIR = \"${env.WORKSPACE}/${PROJECT_TYPE}\"\n    REPORT_DIR = \"${env.WORKSPACE}/PRJob/${PR_BRANCH}\"\n    JOB_REPO = \"${PR_REPO_HTML}\"\n    BITBUCKET_ACCESS_TOKEN = credentials('bitbucket-access-token')\n    REPO_SSH = \"git@bitbucket.org:${PR_PROJECT}.git\"\n    DESTINATION_BRANCH = \"${PR_DESTINATION_BRANCH}\"\n}\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-4-post-actions-block-119-lines-total","title":"Pattern 4: Post Actions Block (119 lines total)","text":"File Lines DLXJenkins/Jenkinsfile 24 DLXJenkins/JenkinsfileDeployment 24 JsJenkins/Jenkinsfile 23 JsJenkins/JenkinsfileDeployment 23 PipelineForJenkins/Jenkinsfile 25 <pre><code>post {\n    always {\n        script {\n            echo 'Returning to the main branch...'\n            generalUtil.checkoutBranch(PROJECT_DIR, DESTINATION_BRANCH)\n        }\n    }\n    success {\n        script {\n            generalUtil.sendBuildStatus(env.WORKSPACE, 'SUCCESSFUL', env.COMMIT_HASH)\n        }\n    }\n    failure {\n        script {\n            generalUtil.sendBuildStatus(env.WORKSPACE, 'FAILED', env.COMMIT_HASH)\n        }\n    }\n    aborted {\n        script {\n            generalUtil.sendBuildStatus(env.WORKSPACE, 'STOPPED', env.COMMIT_HASH)\n        }\n    }\n}\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-5-prepare-workspace-stage-151-lines-total","title":"Pattern 5: Prepare WORKSPACE Stage (151 lines total)","text":"<p>Each Jenkinsfile has a similar 'Prepare WORKSPACE' stage that includes helper loading, branch checks, environment initialization, and repository setup:</p> File Lines DLXJenkins/Jenkinsfile 35 DLXJenkins/JenkinsfileDeployment 28 JsJenkins/Jenkinsfile 33 JsJenkins/JenkinsfileDeployment 30 PipelineForJenkins/Jenkinsfile 25 <pre><code>stage('Prepare WORKSPACE') {\n    steps {\n        dir(\"${PROJECT_DIR}\") {\n            script {\n                sh 'env'\n                try {\n                    generalUtil = load(\"${env.WORKSPACE}/groovy/generalHelper.groovy\")\n                    unityUtil = load(\"${env.WORKSPACE}/groovy/unityHelper.groovy\")\n                } catch (Exception e) {\n                    error \"Failed to load Groovy scripts: ${e.message}\"\n                }\n\n                if (generalUtil.isBranchUpToDateWithRemote(PR_BRANCH) &amp;&amp; !TEST_RUN.equals('Y')) {\n                    echo 'Local branch commit is up to date with remote branch, no changes. Aborting pipeline.'\n                    currentBuild.result = 'ABORTED'\n                    error('Branch is up to date, no changes.')\n                }\n\n                env.COMMIT_HASH = generalUtil.getFullCommitHash(env.WORKSPACE, PR_COMMIT)\n                generalUtil.initializeEnvironment(env.WORKSPACE, env.COMMIT_HASH, PR_BRANCH)\n                generalUtil.cloneOrUpdateRepo(PROJECT_TYPE, env.WORKSPACE, PROJECT_DIR, REPO_SSH, PR_BRANCH)\n                generalUtil.mergeBranchIfNeeded()\n            }\n        }\n    }\n}\n</code></pre> <p>Jenkinsfile Total: 47 + 83 + 63 + 119 + 151 = 463 lines</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#73-groovy-helper-duplication-patterns","title":"7.3 Groovy Helper Duplication Patterns","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-6-git-command-sequences-24-lines-in-generalhelpergroovy","title":"Pattern 6: Git Command Sequences (24 lines in generalHelper.groovy)","text":"<p>12 git shell commands repeated across multiple functions:</p> <pre><code>// Found in generalHelper.groovy - repeated in cloneOrUpdateRepo(), checkoutBranch(), mergeBranchIfNeeded()\nsh 'git reset --hard'\nsh 'git clean -fd'\nsh \"git checkout ${targetBranch}\"\nsh 'git pull origin'\nsh 'git fetch origin'\nsh 'git branch --show-current'\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-7-python-script-wrapper-calls-16-lines-in-generalhelpergroovy","title":"Pattern 7: Python Script Wrapper Calls (16 lines in generalHelper.groovy)","text":"<p>8 Python wrapper calls using same pattern:</p> <pre><code>def sendBuildStatus(workspace, state, commitHash) {\n    def pythonCommand = \"python '${workspace}/python/send_bitbucket_build_status.py' '${commitHash}' '${state}'\"\n    sh(script: pythonCommand, returnStatus: true)\n}\n// Similar calls for: create_bitbucket_test_report.py, get_unity_version.py, linting_error_report.py, etc.\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-8-error-handling-patterns-24-lines-in-generalhelpergroovy","title":"Pattern 8: Error Handling Patterns (24 lines in generalHelper.groovy)","text":"<p>8 inconsistent error handling blocks:</p> <pre><code>// Version 1\ncatch (Exception e) {\n    echo \"An error occurred: ${e.getMessage()}\"\n    error('Process failed.')\n}\n\n// Version 2\ncatch (Exception e) {\n    error \"Failed: ${e.message}\"\n}\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-9-isunix-branching-12-lines-in-jshelpergroovy","title":"Pattern 9: isUnix() Branching (12 lines in jsHelper.groovy)","text":"<p>2 OS branching blocks:</p> <pre><code>if (isUnix()) {\n    sh \"command for unix\"\n} else {\n    bat \"command for windows\"\n}\n</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#pattern-10-error-handling-in-jshelperunityhelper-30-lines","title":"Pattern 10: Error Handling in jsHelper/unityHelper (30 lines)","text":"<ul> <li>jsHelper.groovy: 6 occurrences (18 lines)</li> <li>unityHelper.groovy: 4 occurrences (12 lines)</li> </ul> <p>Groovy Helper Total: 24 + 16 + 24 + 12 + 30 = 106 lines</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#74-cross-file-duplication-matrix","title":"7.4 Cross-File Duplication Matrix","text":"Pattern DLX/JF DLX/JFD JS/JF JS/JFD Pipe/JF generalH unityH jsH Parameters Block \u2713 \u2713 \u2713 \u2713 \u2713 - - - Triggers Block \u2713 \u2713 \u2713 \u2713 \u2713 - - - Environment Block \u2713 \u2713 \u2713 \u2713 \u2713 - - - Post Actions \u2713 \u2713 \u2713 \u2713 \u2713 - - - Prepare WORKSPACE \u2713 \u2713 \u2713 \u2713 \u2713 - - - Git Commands - - - - - \u2713 \u2713 \u2713 isUnix() Branch - - - - - \u2713 \u2713 \u2713 Python Wrapper - - - - - \u2713 \u2713 - Error Handling \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 \u2713 <p>Legend: JF=Jenkinsfile, JFD=JenkinsfileDeployment, H=Helper</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#75-impact-of-duplication","title":"7.5 Impact of Duplication","text":"Issue Impact Maintenance Overhead Changes must be made in 5+ locations for common patterns Bug Propagation Risk Fixing a bug in one place doesn't fix copies elsewhere Inconsistent Behavior Small variations in copied code cause different behavior Testing Difficulty Same logic must be tested multiple times Code Review Burden Reviewers must verify consistency across all copies"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#76-deduplication-opportunities","title":"7.6 Deduplication Opportunities","text":"Pattern Current After Refactoring Reduction Parameters Block 47 lines 10 lines (1 shared) 37 lines Triggers Block 83 lines 17 lines (1 shared) 66 lines Environment Block 63 lines 12 lines (1 shared) 51 lines Post Actions Block 119 lines 25 lines (1 shared) 94 lines Prepare WORKSPACE 151 lines 30 lines (1 shared) 121 lines Git Commands 24 lines 6 lines (closures) 18 lines Python Wrappers 16 lines 0 lines (HttpApiService) 16 lines Error Handling 66 lines 10 lines (centralized) 56 lines <p>Total Potential Reduction: 459 lines (81% of duplicated code)</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#77-pipeline-specific-duplication-analysis","title":"7.7 Pipeline-Specific Duplication Analysis","text":"<p>This section analyzes file-level duplication between pipelines, revealing cross-project code sharing patterns.</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#file-sizes-4-main-jenkinsfiles","title":"File Sizes (4 Main Jenkinsfiles)","text":"File Lines DLXJenkins/Jenkinsfile 249 DLXJenkins/JenkinsfileDeployment 242 JsJenkins/Jenkinsfile 198 JsJenkins/JenkinsfileDeployment 372 Total 1,061"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#within-project-duplication-pr-vs-deployment","title":"Within-Project Duplication (PR vs Deployment)","text":"<p>DLX Pipeline (Unity)</p> Metric Value Total lines (both files) 491 Identical lines 146 Duplication rate 29.7% <p>JS Pipeline (JavaScript)</p> Metric Value Total lines (both files) 570 Identical lines 156 Duplication rate 27.4%"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#cross-project-duplication-dlx-vs-js","title":"Cross-Project Duplication (DLX vs JS)","text":"<p>PR Pipelines (DLX Jenkinsfile vs JS Jenkinsfile)</p> Metric Value DLX Jenkinsfile 249 lines JS Jenkinsfile 198 lines Identical lines 135 Duplication rate 54.2% (of smaller file) <p>Deployment Pipelines (DLX vs JS JenkinsfileDeployment)</p> Metric Value DLX JenkinsfileDeployment 242 lines JS JenkinsfileDeployment 372 lines Identical lines 167 Duplication rate 69.0% (of smaller file)"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#summary","title":"Summary","text":"Comparison Identical Lines Rate DLX: PR vs Deployment 146 29.7% JS: PR vs Deployment 156 27.4% DLX PR vs JS PR 135 54.2% DLX Deploy vs JS Deploy 167 69.0%"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#key-insight","title":"Key Insight","text":"<p>Cross-project duplication (54-69%) is significantly higher than within-project duplication (27-30%)</p> <p>This reveals that: 1. DLX and JS pipelines share enormous amounts of identical code 2. Deployment pipelines are even more similar than PR pipelines 3. Refactoring to a Global Shared Library would eliminate this massive redundancy 4. The 569 lines (18.1%) from pattern-based analysis is a conservative estimate</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#8-dependency-graph","title":"8. Dependency Graph","text":"<pre><code>flowchart TB\n    subgraph Jenkinsfiles[\"Jenkinsfiles (5 files)\"]\n        JF1[DLXJenkins/Jenkinsfile]\n        JF2[DLXJenkins/JenkinsfileDeployment]\n        JF3[JsJenkins/Jenkinsfile]\n        JF4[JsJenkins/JenkinsfileDeployment]\n        JF5[PipelineForJenkins/Jenkinsfile]\n    end\n\n    subgraph Helpers[\"groovy/*.groovy\"]\n        GH[generalHelper.groovy]\n        UH[unityHelper.groovy]\n        JH[jsHelper.groovy]\n    end\n\n    subgraph Python[\"python/*.py\"]\n        P1[send_bitbucket_build_status.py]\n        P2[create_bitbucket_test_report.py]\n        P3[get_unity_version.py]\n        P4[...]\n    end\n\n    JF1 --&gt;|\"load()\"| GH\n    JF1 --&gt;|\"load()\"| UH\n    JF2 --&gt;|\"load()\"| GH\n    JF2 --&gt;|\"load()\"| UH\n    JF3 --&gt;|\"load()\"| GH\n    JF3 --&gt;|\"load()\"| JH\n    JF4 --&gt;|\"load()\"| GH\n    JF4 --&gt;|\"load()\"| JH\n    JF5 --&gt;|\"load()\"| GH\n\n    GH --&gt;|\"sh(python...)\"| P1\n    GH --&gt;|\"sh(python...)\"| P2\n    UH --&gt;|\"sh(python...)\"| P3</code></pre>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#9-technical-debt-summary","title":"9. Technical Debt Summary","text":""},{"location":"problem-analysis/archive/baseline-technical-snapshot/#91-code-metrics","title":"9.1 Code Metrics","text":"Metric Value Total Files 27 Total Lines 3,745 Jenkinsfile Lines 1,239 lines (5 files) Groovy Helper Lines 1,148 lines (3 files) Python Scripts 749 lines (9 files) Test Lines 84 lines (2 files) Test Coverage ~1 function testable"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#92-duplication-analysis","title":"9.2 Duplication Analysis","text":"Duplicated Pattern Occurrences Lines Parameters block 5 files 47 Triggers block 5 files 83 Environment block 5 files 63 Post actions block 5 files 119 Prepare WORKSPACE stage 5 files 151 Git commands (generalHelper) 12 calls 24 Python wrappers (generalHelper) 8 calls 16 Error handling (all helpers) 18 blocks 66 <p>Total Duplication: 569 lines (18.1% of active codebase*)</p> <p>*Active codebase = Jenkinsfiles (1,239) + Groovy Helpers (1,148) + Python (749) = 3,136 lines</p>"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#10-summary-table","title":"10. Summary Table","text":"Aspect Status Problem Architecture Flat/Monolithic No layer separation Code Reuse Poor Duplicated code across 5 Jenkinsfiles Testability Very Low Only 1 function testable Maintainability Poor 1 file modification \u2192 affects everything Logging Inconsistent No format consistency, no hierarchy Error Handling Inconsistent Stack trace lost API Communication Python dependent Not possible directly in Groovy Documentation Partial Some JSDoc present"},{"location":"problem-analysis/archive/baseline-technical-snapshot/#11-key-issues-for-refactoring","title":"11. Key Issues for Refactoring","text":"<ol> <li>Separate concerns: Extract stage logic from Jenkinsfile into reusable modules</li> <li>Eliminate Python dependency: Implement HTTP communication directly in Groovy</li> <li>Standardize logging: Create centralized logging system with hierarchy</li> <li>Unify error handling: Create consistent error handling with stack trace preservation</li> <li>Enable testing: Structure code to allow unit testing</li> <li>Reduce duplication: Extract common patterns into reusable components</li> <li>Create layer architecture: Establish clear separation between layers</li> </ol>"},{"location":"problem-analysis/archive/detailed-analysis-old/","title":"Problem Analysis","text":"<p>Problem analysis document for the pre-refactoring Jenkins Pipeline codebase (Baseline: <code>74fc356</code>).</p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#1-analysis-overview","title":"1. Analysis Overview","text":""},{"location":"problem-analysis/archive/detailed-analysis-old/#11-background","title":"1.1. Background","text":"<p>This document is the problem analysis document for the pre-refactoring Baseline codebase.</p> <p>During the VARLab Co-op period, 5 monolithic pipelines (37% duplication, untestable) with 14 months of accumulated Technical Debt were refactored into a 4-Layer Architecture.</p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#111-project-context","title":"1.1.1. Project Context","text":"<ul> <li>As an R&amp;D project, rapid feature addition for value validation was the priority</li> <li>The Jenkins Global Trusted Shared Library feature itself was poorly documented and difficult to discover/apply</li> <li>This feature was discovered at month 13 of the project</li> </ul>"},{"location":"problem-analysis/archive/detailed-analysis-old/#112-refactoring-trigger","title":"1.1.2. Refactoring Trigger","text":"<ul> <li>At month 14, a project break term of approximately 3 weeks occurred, and with permission from the software architect, full refactoring began</li> <li>Problems felt intuitively at the time:</li> <li>Modifying one thing caused problems elsewhere</li> <li>Continuous situation where all places had to be considered when making modifications or adding features</li> <li>Due to Jenkins characteristics, creating classes for Import/Export was not possible</li> </ul>"},{"location":"problem-analysis/archive/detailed-analysis-old/#113-refactoring-approach","title":"1.1.3. Refactoring Approach","text":"<ul> <li>Started without completing problem identification or planning specific design pattern application</li> <li>Progressed naturally and emergently during the Tech Debt resolution process</li> <li>Design patterns naturally emerged by utilizing the Jenkins Global Trusted Shared Library feature</li> </ul>"},{"location":"problem-analysis/archive/detailed-analysis-old/#12-analysis-purpose","title":"1.2. Analysis Purpose","text":"<ul> <li>At the time of refactoring, it was done intuitively without clear criteria.</li> <li> <p>To lead from experience-based understanding to systematic theory acquisition, classification and definition using Industry Convention criteria:</p> </li> <li> <p>Learn how the problems I felt are classified and named in practice</p> </li> <li>Check if there are any missed problems</li> <li>Understand the analysis methodology itself</li> </ul>"},{"location":"problem-analysis/archive/detailed-analysis-old/#13-analysis-target","title":"1.3. Analysis Target","text":""},{"location":"problem-analysis/archive/detailed-analysis-old/#131-helper-files-reusable-logic","title":"1.3.1. Helper Files (Reusable Logic)","text":"File Domain <code>generalHelper.groovy</code> Pipeline utilities (Git, Bitbucket, Logging) <code>jsHelper.groovy</code> Web Pipeline utilities <code>unityHelper.groovy</code> Unity Pipeline utilities"},{"location":"problem-analysis/archive/detailed-analysis-old/#132-jenkinsfile-pipeline-orchestration","title":"1.3.2. Jenkinsfile (Pipeline Orchestration)","text":"File Domain <code>DLXJenkins/Jenkinsfile</code> Unity Project CI <code>DLXJenkins/JenkinsfileDeployment</code> Unity Project CD <code>JsJenkins/Jenkinsfile</code> Node.js Project CI <code>JsJenkins/JenkinsfileDeployment</code> Node.js Project CD <code>PipelineForJenkins/Jenkinsfile</code> Pipeline Library Self CI"},{"location":"problem-analysis/archive/detailed-analysis-old/#14-analysis-methodology","title":"1.4. Analysis Methodology","text":"<p>Analyze problems by level using the Software Smells classification system.</p> <p>Reason for methodology selection: To learn how intuitively felt problems (\"modifying one thing causes problems elsewhere\", \"all places must be considered\") are classified and named in the industry, the most widely known classification systems were utilized.</p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#141-function-level","title":"1.4.1. Function Level","text":"Analysis Type Source Description Code Smells Fowler/Beck (1999) Method/function level problems SRP Violation Analysis Martin (2006, 2010) Single Responsibility Principle violation - change reason analysis <p>Note: SRP is a SOLID principle for OOP languages, but it is a generally applicable principle regardless of programming paradigm and is suitable as a baseline analysis criterion. Cases where two or more functional domains or logic units are mixed within a function are investigated.</p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#142-module-level-modulefile-level","title":"1.4.2. Module Level (Module/File Level)","text":"Analysis Type Source Description Design Smells - Symptoms Martin (2000) 7 symptoms (Rigidity, Fragility, Immobility, etc.) Design Smells - Principles Suryanarayana et al. (2014) OO principle violations (Abstraction, Encapsulation, Modularization) SRP Violation Analysis Martin (2006, 2010) Single Responsibility Principle violation - change reason analysis <p>Note: Applying OO or OOP principles to Procedural code (Jenkins Pipeline) to understand which concepts are applicable/inapplicable. - SRP Violation Analysis: Sequence diagrams are created per stage for each pipeline to identify functional domains.   - Jenkinsfile: SRP violation analysis based on the number of domains requiring changes due to actual logic existing rather than orchestration   - Helper files: Verify through cohesion whether they are being used as designed (originally the helper file design itself contains multiple domains and is not suitable for SRP, but verify if it's being used according to the original design purpose)</p> <ul> <li>Design Smells - Principles: Hierarchy Smells are not applicable as they presuppose inheritance structure, Abstraction/Modularization are interpreted at file/function level for application</li> </ul>"},{"location":"problem-analysis/archive/detailed-analysis-old/#143-system-level","title":"1.4.3. System Level","text":"Analysis Type Source Description Architecture Smells Garcia et al. (2009), Sharma System-level structural problems DRY Violation Analysis Hunt &amp; Thomas (1999) Duplication pattern identification <p>Note: DRY violation analysis identifies duplication patterns using a top-down comparison approach. - All pipelines (5) \u2192 CI vs CD \u2192 Between CIs / Between CDs \u2192 Within single pipeline \u2192 Between Helpers - Grouped for analysis based on ranges where identical logic can exist</p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#2-detailed-document-structure","title":"2. Detailed Document Structure","text":"<pre><code>problem-analysis/\n\u251c\u2500\u2500 README.md                           # This document\n\u251c\u2500\u2500 baseline-technical-snapshot.md      # Baseline technical snapshot (code statistics, file structure)\n\u251c\u2500\u2500 DRY-violation-analysis.md           # System-wide DRY violation analysis\n\u2502\n\u251c\u2500\u2500 01-generalHelper/                   # Per-file analysis folder (example)\n\u2502   \u251c\u2500\u2500 01-srp-violation-analysis.md    # SRP violation analysis\n\u2502   \u251c\u2500\u2500 02-software-smells-analysis.md  # Code/Design/Architecture Smells\n\u2502   \u2514\u2500\u2500 03-design-smells-symptoms.md    # Martin's 7 Symptoms detail\n\u251c\u2500\u2500 02-jsHelper/                        # (Same structure)\n\u251c\u2500\u2500 ...\n\u251c\u2500\u2500 08-PipelineForJenkins-Jenkinsfile/  # (Same structure)\n\u2502\n\u251c\u2500\u2500 pipeline-sequence-diagrams/         # Pipeline sequence diagrams\n\u2514\u2500\u2500 reference/                          # Smells Taxonomy reference documents\n</code></pre>"},{"location":"problem-analysis/archive/detailed-analysis-old/#3-analysis-results-summary","title":"3. Analysis Results Summary","text":""},{"location":"problem-analysis/archive/detailed-analysis-old/#31-system-level","title":"3.1. System Level","text":""},{"location":"problem-analysis/archive/detailed-analysis-old/#311-dry-violation-analysis","title":"3.1.1. DRY Violation Analysis","text":"<p>Grouped for analysis based on ranges where identical logic can exist: - All Jenkinsfiles (5) - CI vs CD (same project type) - Between CI pipelines - Between CD pipelines - Between Helper files</p> <p>Details: DRY-violation-analysis.md</p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#312-architecture-smells-summary","title":"3.1.2. Architecture Smells Summary","text":"File Hub-like Dependency Implicit Cross-module Dependency 01-generalHelper High High 02-jsHelper - Medium 03-unityHelper - Medium 04-DLXJenkins-Jenkinsfile - High 05-DLXJenkins-JenkinsfileDeployment - High 06-JsJenkins-Jenkinsfile - High 07-JsJenkins-JenkinsfileDeployment - High 08-PipelineForJenkins-Jenkinsfile - High <p>Detailed analysis: <code>{folder}/software-smells-analysis.md</code> &gt; <code>## 3. Architecture Smells (System Level)</code></p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#32-module-level-modulefile-level","title":"3.2. Module Level (Module/File Level)","text":""},{"location":"problem-analysis/archive/detailed-analysis-old/#321-srp-violation-analysis-summary","title":"3.2.1. SRP Violation Analysis Summary","text":"File Analysis Criteria SRP Violation Summary 01-generalHelper Cohesion (Design Intent) Kitchen Sink - 19% cohesion (4/21 functions with 100% reuse) 02-jsHelper Cohesion (Design Intent) CI/CD-specific functions mixed - 50% cohesion 03-unityHelper Cohesion (Design Intent) CI-specific functions mixed - 50% cohesion 04-DLXJenkins-Jenkinsfile Logic Existence Logic exists in 6 domains, Prepare WORKSPACE has 5 change reasons 05-DLXJenkins-JenkinsfileDeployment Logic Existence Logic exists in 7 domains, deployment pattern repeated 2 times 06-JsJenkins-Jenkinsfile Logic Existence Logic exists in 5 domains, Server/Client pattern 80 lines repeated 07-JsJenkins-JenkinsfileDeployment Logic Existence Logic exists in 5 domains, Server/Client deployment 150 lines repeated 08-PipelineForJenkins-Jenkinsfile Logic Existence Logic exists in 5 domains, Groovy/Jenkinsfile lint 60 lines repeated <p>Detailed analysis: <code>{folder}/srp-violation-analysis.md</code> &gt; <code>## Conclusion</code></p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#322-design-smells-principles-summary-suryanarayana-2014","title":"3.2.2. Design Smells - Principles Summary (Suryanarayana 2014)","text":"File Abstraction Encapsulation Modularization 01-generalHelper Multifaceted, Missing Missing Insufficient, Hub-like 02-jsHelper Multifaceted, Missing Missing Insufficient 03-unityHelper Multifaceted Missing - 04-DLXJenkins-Jenkinsfile Multifaceted, Missing, Imperative Missing - 05-DLXJenkins-JenkinsfileDeployment Multifaceted, Missing, Imperative Missing - 06-JsJenkins-Jenkinsfile Multifaceted, Missing, Imperative Missing Insufficient 07-JsJenkins-JenkinsfileDeployment Multifaceted, Missing, Imperative Missing Insufficient 08-PipelineForJenkins-Jenkinsfile Multifaceted, Missing, Imperative Missing - <p>Detailed analysis: <code>{folder}/software-smells-analysis.md</code> &gt; <code>## 2. Design Smells (Module/File Level)</code></p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#323-design-smells-symptoms-summary-martin-2000","title":"3.2.3. Design Smells - Symptoms Summary (Martin 2000)","text":"<p>Note: 7 symptoms inferred based on Code Smells, Design Principles, Architecture Smells analysis results + direct code review</p> File Rigidity Fragility Immobility Viscosity Complexity Repetition Opacity 01-generalHelper High Medium-High High Medium Low High High 02-jsHelper Medium Medium Medium Medium Low Medium Medium 03-unityHelper High Medium Medium High Low High Medium 04-DLXJenkins-Jenkinsfile High High High Medium Low High High 05-DLXJenkins-JenkinsfileDeployment High High High High Low High Medium 06-JsJenkins-Jenkinsfile High High High High Low High High 07-JsJenkins-JenkinsfileDeployment High High High High Low High High 08-PipelineForJenkins-Jenkinsfile Medium High High Medium Low High Low <p>Detailed analysis: <code>{folder}/design-smells-symptoms.md</code></p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#33-function-level","title":"3.3. Function Level","text":""},{"location":"problem-analysis/archive/detailed-analysis-old/#331-srp-violation-analysis-summary-function-level","title":"3.3.1. SRP Violation Analysis Summary (Function Level)","text":"<p>Note: Function-level SRP analysis performed only on Helper files. Jenkinsfiles are covered at module level (3.2.1) with stage-unit analysis.</p> File Functions with Multiple Change Reasons 01-generalHelper <code>initializeEnvironment</code>(2), <code>cleanUpPRBranch</code>(2), <code>checkQualityGateStatus</code>(5) 02-jsHelper <code>installNpmInTestingDirs</code>(3) 03-unityHelper <code>getUnityExecutable</code>(2), <code>runUnityBatchMode</code>(7) <p>Detailed analysis: <code>{folder}/srp-violation-analysis.md</code> &gt; <code>## 4. Function Level SRP Violation Analysis</code></p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#332-code-smells-summary-fowler-1999","title":"3.3.2. Code Smells Summary (Fowler 1999)","text":"File Change Preventers Dispensables Bloaters Couplers 01-generalHelper Divergent Change(High), Shotgun Surgery(High) - - - 02-jsHelper Divergent Change(Medium), Shotgun Surgery(Medium) Duplicated Code(Medium) Long Method(Low), Primitive Obsession(Low) - 03-unityHelper Divergent Change(Medium), Shotgun Surgery(High) - Long Method(High), Switch Statements(Medium) - 04-DLXJenkins-Jenkinsfile Divergent Change(High), Shotgun Surgery(Medium) Duplicated Code(Medium) Primitive Obsession(Low) - 05-DLXJenkins-JenkinsfileDeployment Divergent Change(High), Shotgun Surgery(Medium) Duplicated Code(High) Primitive Obsession(Low) - 06-JsJenkins-Jenkinsfile Divergent Change(High), Shotgun Surgery(High) Duplicated Code(High), Dead Code(Low) Long Method(High), Primitive Obsession(Low) Feature Envy(High) 07-JsJenkins-JenkinsfileDeployment Divergent Change(High), Shotgun Surgery(High) Duplicated Code(High) Long Method(High), Primitive Obsession(Low) - 08-PipelineForJenkins-Jenkinsfile Divergent Change(High), Shotgun Surgery(Medium) Duplicated Code(High) Primitive Obsession(Low) - <p>Detailed analysis: <code>{folder}/software-smells-analysis.md</code> &gt; <code>## 1. Code Smells (Method/Function Level)</code></p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#4-comprehensive-analysis-results","title":"4. Comprehensive Analysis Results","text":""},{"location":"problem-analysis/archive/detailed-analysis-old/#41-core-problem-patterns","title":"4.1. Core Problem Patterns","text":"<p>Core problems appearing commonly across all 8 files:</p> Pattern Impact Scope Occurrence Frequency Severity Divergent Change All files 8/8 High Shotgun Surgery All files 8/8 High Duplicated Code 5 Jenkinsfiles + jsHelper 6/8 High Implicit Cross-module Dependency All files 8/8 High Missing Encapsulation All files 8/8 Medium Multifaceted Abstraction All files 8/8 Medium"},{"location":"problem-analysis/archive/detailed-analysis-old/#42-priority-by-severity","title":"4.2. Priority by Severity","text":"<p>51 issues derived from all analysis documents (20 High, 23 Medium, 8 Low)</p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#high-immediate-resolution-required-20-items","title":"High (Immediate Resolution Required) - 20 items","text":"# Issue Type File Impact 1 Hub-like Dependency Architecture generalHelper 5 pipelines depend on single file 2 DRY Violation - parameters block DRY 5 Jenkinsfiles Parameter changes require 5 modifications 3 DRY Violation - triggers.GenericTrigger DRY 5 Jenkinsfiles Trigger changes require 5 modifications 4 DRY Violation - post block DRY 5 Jenkinsfiles Build status handling changes require 5 modifications 5 DRY Violation - Prepare WORKSPACE logic DRY 3 CI Jenkinsfiles Initialization logic changes require 3 modifications 6 Server/Client deployment duplication (150 lines) Code - Duplicated JS CD Deployment logic changes require 2 modifications 7 Server/Client report duplication (80 lines) Code - Duplicated JS CI Python script argument changes require 2 modifications 8 Kitchen Sink file (19% cohesion) Design - Modularization generalHelper Unclear change reasons, 21 functions/8 domains 9 Divergent Change (8 domains) Code - Change Preventers generalHelper 8 change reasons mixed 10 Shotgun Surgery (7 triggers) Code - Change Preventers generalHelper Path/command changes require 10+ modifications 11 Shotgun Surgery (7 places when adding new Stage) Code - Change Preventers unityHelper Stage addition requires 7 simultaneous modifications 12 Implicit Cross-module Dependency Architecture All files Runtime error when external system changes 13 Long Method (126 lines) Code - Bloaters unityHelper <code>runUnityBatchMode</code> 7 responsibilities mixed 14 Long Method (112 lines) Code - Bloaters JS CI <code>Unit Testing</code> 7 responsibilities mixed 15 Long Method (75 lines \u00d7 2) Code - Bloaters JS CD <code>Server/Client Deploy</code> 5 responsibilities each mixed 16 Feature Envy Code - Couplers JS CI <code>Unit Testing</code> Excessive dependency on external module 17 Insufficient Modularization Design - Modularization JS CI, JS CD Stage is too large and complex 18 Missing Encapsulation (Stage conditions in 7 places) Design - Encapsulation unityHelper Stage-specific conditional branching scattered 19 Missing Encapsulation (deployment patterns) Design - Encapsulation DLX CD, JS CD SSH/SCP, Docker patterns repeated 20 Multifaceted Abstraction Design - Abstraction All files Multiple domains mixed in one file"},{"location":"problem-analysis/archive/detailed-analysis-old/#medium-planned-resolution-23-items","title":"Medium (Planned Resolution) - 23 items","text":"# Issue Type File Impact 21 CI/CD-specific functions mixed (50% cohesion) SRP Violation jsHelper, unityHelper Unnecessary dependencies 22 DRY Violation - environment block DRY 5 Jenkinsfiles Environment variable pattern changes require 5 modifications 23 DRY Violation - buildResults/stageResults DRY 5 Jenkinsfiles Status value changes require 5 modifications 24 DRY Violation - Static Analysis pattern DRY JS CI, JS CD, Jenkins CI SonarQube setting changes require 3 modifications 25 DRY Violation - logMessage() copy DRY generalHelper, jsHelper Logging changes require 2 modifications 26 Shotgun Surgery (Unity Stage name 5 places) Code - Change Preventers DLX CI Stage name changes require 5 modifications 27 Shotgun Surgery (6 places when adding report type) Code - Change Preventers JS CI New report type addition requires 6 modifications 28 Shotgun Surgery (4 places when adding deployment target) Code - Change Preventers JS CD New deployment target addition requires 4 modifications 29 Shotgun Surgery (4 places when adding lint type) Code - Change Preventers Jenkins CI New lint type addition requires 4 modifications 30 Duplicated Code (stageName/errorMsg 5 times) Code - Dispensables DLX CI Error message format changes require 5 modifications 31 Duplicated Code (deployment pattern 2 times) Code - Dispensables DLX CD SSH option changes require 2 modifications 32 Duplicated Code (lint pattern 60 lines) Code - Dispensables Jenkins CI Lint option changes require 2 modifications 33 Switch Statements (same branching 7 places) Code - Bloaters unityHelper Stage-specific conditional branching repeated 34 Missing Abstraction (magic strings/paths) Design - Abstraction All files Environment changes require multiple modifications 35 Imperative Abstraction Design - Abstraction 5 Jenkinsfiles Procedural script structure 36 Hub-like Modularization Design - Modularization generalHelper Many places depend on it 37 Viscosity (copying is easier) Design Symptom generalHelper, unityHelper Hacking is easier than correct changes 38 Fragility (unexpected impact) Design Symptom generalHelper, DLX CI/CD No domain boundaries 39 Opacity (complex nested conditions) Design Symptom unityHelper, DLX CI 3-4 level nesting, difficult to trace 40 Opacity (undefined variable usage) Design Symptom DLX CI FOLDER_NAME, TICKET_NUMBER definition location unclear 41 Deeply Nested Code (3 levels) Implementation JS CI Server/Client report processing 42 Magic String (SonarQube URL) Implementation JS CI, JS CD, Jenkins CI Hardcoded URL 43 Magic String (Docker image) Implementation Jenkins CI Hardcoded image name"},{"location":"problem-analysis/archive/detailed-analysis-old/#low-gradual-improvement-8-items","title":"Low (Gradual Improvement) - 8 items","text":"# Issue Type File Impact 44 DRY Violation - mainBranches constant DRY DLX CD, JS CD Branch policy changes require 2 modifications 45 Primitive Obsession Code - Bloaters All Jenkinsfiles Lack of type safety 46 Dead Code (2 functions) Code - Dispensables generalHelper Unused code exists 47 Dead Code (commented code) Code - Dispensables JS CI JENKINS_API_KEY comment 48 Needless Complexity (Low) Design Symptom All files No excessive design beyond Dead Code 49 Opacity (counter-intuitive variable name) Design Symptom generalHelper 0=exists in projectExists 50 Opacity (function name mismatch) Design Symptom generalHelper parseJson, isBranchUpToDateWithMain 51 Opacity (complex Map/JSON structure) Design Symptom unityHelper logConfig, loadPathsToExclude"},{"location":"problem-analysis/archive/detailed-analysis-old/#43-causal-relationships-between-issues","title":"4.3. Causal Relationships Between Issues","text":"<pre><code>flowchart LR\n    subgraph ROOT[\"Root Causes\"]\n        A1[\"Lack of Helper Design&lt;br/&gt;(generalHelper)\"]\n        A2[\"Common Patterns Not Extracted&lt;br/&gt;(parameters, triggers)\"]\n        A3[\"Environment Settings Hardcoded&lt;br/&gt;(magic strings/paths)\"]\n        A4[\"Insufficient CI/CD Separation&lt;br/&gt;(jsHelper, unityHelper)\"]\n        A5[\"Insufficient Function Decomposition\"]\n    end\n\n    subgraph L1[\"Level 1 Results - Design Smells\"]\n        B1[\"Kitchen Sink File&lt;br/&gt;(multi-purpose file)\"]\n        B2[\"Hub-like Dependency&lt;br/&gt;(everything depends on it)\"]\n        B3[\"Duplicated Code&lt;br/&gt;(copied to 5 places)\"]\n        B4[\"Implicit Cross-module&lt;br/&gt;Dependency\"]\n        B5[\"Missing Encapsulation&lt;br/&gt;(settings exposed)\"]\n        B6[\"Multifaceted Abstraction&lt;br/&gt;(multiple responsibilities)\"]\n        B7[\"Long Method&lt;br/&gt;(125-line function)\"]\n    end\n\n    subgraph L2[\"Level 2 Results - Code Smells\"]\n        C1[\"Divergent Change&lt;br/&gt;(1 file \u2190 N change reasons)\"]\n        C2[\"Shotgun Surgery&lt;br/&gt;(1 change \u2192 N files)\"]\n        C3[\"DRY Violation&lt;br/&gt;(synchronization issues)\"]\n        C4[\"Primitive Obsession&lt;br/&gt;(lack of type safety)\"]\n    end\n\n    subgraph L3[\"Level 3 Results - Symptoms\"]\n        D1[\"Rigidity&lt;br/&gt;(difficulty changing)\"]\n        D2[\"Fragility&lt;br/&gt;(unexpected failures)\"]\n        D3[\"Immobility&lt;br/&gt;(cannot reuse)\"]\n        D4[\"Viscosity&lt;br/&gt;(correct changes are difficult)\"]\n        D5[\"Opacity&lt;br/&gt;(difficult to understand)\"]\n    end\n\n    %% Chain 1: Lack of Helper Design\n    A1 --&gt; B1 --&gt; C1 --&gt; D1\n    B1 --&gt; B2 --&gt; C2 --&gt; D2\n    B1 --&gt; B6\n\n    %% Chain 2: Common Patterns Not Extracted\n    A2 --&gt; B3 --&gt; C3\n    B3 --&gt; B4 --&gt; D2\n    B3 --&gt; D3\n\n    %% Chain 3: Environment Settings Hardcoded\n    A3 --&gt; B5 --&gt; D4\n    B5 --&gt; C4\n\n    %% Chain 4: Insufficient CI/CD Separation\n    A4 --&gt; B6 --&gt; C1\n    B6 --&gt; D3\n\n    %% Chain 5: Insufficient Function Decomposition\n    A5 --&gt; B7 --&gt; D5\n    B7 --&gt; C2</code></pre>"},{"location":"problem-analysis/archive/detailed-analysis-old/#44-refactoring-direction-implications","title":"4.4. Refactoring Direction Implications","text":"<p>Refactoring directions derived from analysis results:</p> # Problem Group Refactoring Direction Expected Effect 1 Hub-like Dependency + Kitchen Sink Helper File Separation: Separate Helpers by functional domain Reduce Divergent Change, Shotgun Surgery 2 DRY Violation (parameters/triggers) Utilize Shared Library: Extract common blocks to Shared Library 5 places \u2192 1 place change 3 Server/Client duplication Abstraction: Extract deployment pattern as function Remove 150 lines of duplication 4 Implicit Cross-module Dependency Explicit Dependencies: Constantize environment variables/script paths Reduce Fragility 5 CI/CD-specific functions mixed Cohesion-based Separation: Separate into CI-only / CD-only / Common Remove unnecessary dependencies <p>Note: This direction was naturally derived from analysis results, and actual refactoring was performed in <code>phase-4-full-pipeline-refactoring-and-stage-modularization</code>.</p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#5-per-file-analysis-documents","title":"5. Per-File Analysis Documents","text":"# Analysis Target SRP Analysis Software Smells Design Symptoms 01 generalHelper.groovy 01-srp-violation-analysis.md 02-software-smells-analysis.md 03-design-smells-symptoms.md 02 jsHelper.groovy 01-srp-violation-analysis.md 02-software-smells-analysis.md 03-design-smells-symptoms.md 03 unityHelper.groovy 01-srp-violation-analysis.md 02-software-smells-analysis.md 03-design-smells-symptoms.md 04 DLXJenkins/Jenkinsfile 01-srp-violation-analysis.md 02-software-smells-analysis.md 03-design-smells-symptoms.md 05 DLXJenkins/JenkinsfileDeployment 01-srp-violation-analysis.md 02-software-smells-analysis.md 03-design-smells-symptoms.md 06 JsJenkins/Jenkinsfile 01-srp-violation-analysis.md 02-software-smells-analysis.md 03-design-smells-symptoms.md 07 JsJenkins/JenkinsfileDeployment 01-srp-violation-analysis.md 02-software-smells-analysis.md 03-design-smells-symptoms.md 08 PipelineForJenkins/Jenkinsfile 01-srp-violation-analysis.md 02-software-smells-analysis.md 03-design-smells-symptoms.md"},{"location":"problem-analysis/archive/detailed-analysis-old/#6-related-documents","title":"6. Related Documents","text":"Document Description Analysis Criteria baseline-technical-snapshot.md Code statistics, file structure, technical state Commit <code>54479b2</code> <p>Note: <code>baseline-technical-snapshot.md</code> was analyzed based on commit <code>54479b2</code>, which differs from the baseline of other documents in this folder (commit <code>74fc356</code>). The analysis direction is also different, and that document is a technical snapshot focused on code statistics and file structure.</p>"},{"location":"problem-analysis/archive/detailed-analysis-old/#7-references","title":"7. References","text":"<ul> <li>Software Smells &amp; Anti-Patterns Taxonomy</li> <li>Pipeline Sequence Diagrams</li> </ul>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/","title":"Problem Analysis: Baseline Code Analysis","text":"<p>Analysis Target: Commit <code>74fc356</code> (2025-03-20)</p> <p>Total Code: 2,975 lines across 8 files</p>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#overview","title":"Overview","text":"<p>Technical debt analysis of 5 pipelines (DLX CI/CD, JS CI/CD, PipelineForJenkins) that grew over 14 months with focus on feature additions.</p>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#key-metrics","title":"Key Metrics","text":"Metric Value Total Lines of Code 2,975 lines Helper Files 1,369 lines (46%) Jenkinsfile 1,606 lines (54%) Identified Issues 51 (High 20, Medium 23, Low 8)"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#project-structure","title":"Project Structure","text":"<pre><code>devops-jenkins-linux/\n\u251c\u2500\u2500 groovy/                              # Helper files (1,369 lines, 46%)\n\u2502   \u251c\u2500\u2500 generalHelper.groovy      656 lines    \u2190 Kitchen Sink (19% cohesion)\n\u2502   \u251c\u2500\u2500 unityHelper.groovy        357 lines    \u2190 Unity specific\n\u2502   \u2514\u2500\u2500 jsHelper.groovy           356 lines    \u2190 JS Web specific\n\u251c\u2500\u2500 DLXJenkins/                          # Unity pipeline (551 lines)\n\u2502   \u251c\u2500\u2500 Jenkinsfile               286 lines    \u2190 CI\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment     265 lines    \u2190 CD\n\u251c\u2500\u2500 JsJenkins/                           # JS Web pipeline (740 lines)\n\u2502   \u251c\u2500\u2500 Jenkinsfile               314 lines    \u2190 CI\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment     426 lines    \u2190 CD\n\u2514\u2500\u2500 PipelineForJenkins/                  # Jenkins self pipeline (315 lines)\n    \u2514\u2500\u2500 Jenkinsfile               315 lines    \u2190 CI only\n</code></pre>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#detailed-analysis-documents","title":"Detailed Analysis Documents","text":"<p>\ud83d\udc49 Problem Analysis Summary - Complete list of 51 issues with severity classification</p>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#per-file-analysis","title":"Per-File Analysis","text":"# File SRP Analysis Software Smells Design Symptoms 01 generalHelper.groovy srp-violation-analysis.md software-smells-analysis.md design-smells-symptoms.md 02 jsHelper.groovy srp-violation-analysis.md software-smells-analysis.md design-smells-symptoms.md 03 unityHelper.groovy srp-violation-analysis.md software-smells-analysis.md design-smells-symptoms.md 04 DLXJenkins/Jenkinsfile srp-violation-analysis.md software-smells-analysis.md design-smells-symptoms.md 05 DLXJenkins/JenkinsfileDeployment srp-violation-analysis.md software-smells-analysis.md design-smells-symptoms.md 06 JsJenkins/Jenkinsfile srp-violation-analysis.md software-smells-analysis.md design-smells-symptoms.md 07 JsJenkins/JenkinsfileDeployment srp-violation-analysis.md software-smells-analysis.md design-smells-symptoms.md 08 PipelineForJenkins/Jenkinsfile srp-violation-analysis.md software-smells-analysis.md design-smells-symptoms.md"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#system-level-analysis","title":"System-Level Analysis","text":"<ul> <li>DRY Violation Analysis - Duplication patterns across pipelines/helpers</li> <li>Pipeline Sequence Diagrams - Call flow visualization by pipeline</li> <li>Software Smells Taxonomy - Theoretical classification framework used in analysis</li> </ul>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#analysis-results-summary","title":"Analysis Results Summary","text":""},{"location":"problem-analysis/archive/problem-analysis-overview-old/#baseline-analysis-conclusions","title":"Baseline Analysis Conclusions","text":"<ul> <li>Jenkinsfile INLINE duplication: 29-31% (not abstracted to helpers)</li> <li>Change reasons per Helper file: 8-17 (God Object)</li> <li>generalHelper: Kitchen Sink class (no classification criteria, 19% cohesion)</li> </ul>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#key-symptoms","title":"Key Symptoms","text":"<ul> <li>Untestable Structure: Helper functions strongly coupled to Jenkins environment, making unit testing impossible</li> <li>Shotgun Surgery: One line of code change \u2192 Must check all 5 pipelines</li> <li>Technical Debt Vicious Cycle: Code no one dares touch \u2192 New features copy-pasted INLINE \u2192 Duplication increases</li> </ul>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#real-world-experience","title":"Real-World Experience","text":""},{"location":"problem-analysis/archive/problem-analysis-overview-old/#human-error-prone-structure","title":"Human Error Prone Structure","text":"<ul> <li>Modified INLINE code in CI Jenkinsfile, tested only CI pipeline</li> <li>Forgot about identical INLINE code in CD Jenkinsfile, deployed \u2192 CD pipeline not applied</li> <li>Modified Helper function + CI Jenkinsfile, missed CD Jenkinsfile update \u2192 CD pipeline broken</li> </ul>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#risk-of-needing-to-consider-everything-for-one-feature","title":"Risk of Needing to Consider Everything for One Feature","text":"<ul> <li>When changing common functionality like \"Add Warning status to build results\":</li> <li>Must find and modify all 5 pipelines individually</li> <li>Context switching when interrupted by other ticket work</li> <li>Need to notify team members before every change</li> </ul>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#workflow-and-teamwork-threatened-by-strong-coupling","title":"Workflow and Teamwork Threatened by Strong Coupling","text":"<ul> <li>Multiple responsibilities concentrated in single file + strong coupling</li> <li>One person's code changes affect other team members' work</li> <li>Psychologically reluctant to modify/add features \u2192 Teamwork degradation</li> </ul>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#roi-degradation","title":"ROI Degradation","text":"<ul> <li>Even simple modifications can't focus on just that feature</li> <li>Must consider 5 pipelines + Jenkins UI settings + Webhook/Third-party APIs</li> <li>10-20 minute tasks extend to hours or days</li> </ul> Case Study: cloneOrUpdateRepo() function unable to handle project structure changes <p>The <code>cloneOrUpdateRepo()</code> function was designed with the assumption that there's only one project in the root folder.</p> <ul> <li>Unity: Single project folder at root (<code>Unity_Project/</code>)</li> <li>JS Web: <code>frontend/</code>, <code>backend/</code> subfolders at root, each with independent <code>package.json</code></li> </ul> <p>When the web development team used a different folder structure, this function threw errors:</p> <ol> <li>Debugging difficulty: Error handling and logging were inadequate, couldn't determine what values were being passed</li> <li>Root cause identification: Contacted dev team \u2192 Checked project structure \u2192 Discovered different folder structure than Unity</li> <li>Code modification attempt: Tried modifying helper function internals \u2192 Caused issues in other pipeline (Unity)</li> <li>Jenkinsfile modification attempt: Couldn't bring myself to touch it (affects 5 pipelines)</li> <li>Final workaround: Temporarily handled by modifying environment variables in pipeline webhook settings via Jenkins web UI</li> </ol> <p>Eventually gave up on helper for CD pipeline and implemented INLINE directly:</p> <pre><code>// JenkinsfileDeployment - INLINE implementation instead of helper\ndir(\"${PROJECT_DIR}\") {\n    sh \"git checkout ${DESTINATION_BRANCH}\"\n    sh 'git reset --hard HEAD'\n    sh 'git pull'\n}\n</code></pre>"},{"location":"problem-analysis/archive/problem-analysis-overview-old/#reference","title":"Reference","text":"<ul> <li>Jenkins Shared Libraries Documentation</li> <li>Pipeline: Groovy Plugin - load step</li> </ul>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/","title":"DLX CD Pipeline Sequence Diagrams","text":"<p>Analysis Target: <code>DLXJenkins/JenkinsfileDeployment</code> (DLX Unity CD Pipeline)</p> <p>Related: Domain Mapping Summary</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#why-sequence-diagrams","title":"Why Sequence Diagrams?","text":"<p>Q: Why use Sequence Diagrams for Jenkins Pipeline analysis?</p> <p>A: Jenkins Pipeline is procedural code. Unlike OOP where classes naturally define domain boundaries, procedural code mixes multiple domains within sequential execution flow. Sequence Diagrams visualize the call flow between components, making it easier to identify which domains are involved at each stage.</p> <p>Q: What is the goal of this analysis?</p> <p>A: To identify domains by function. By tracing \"who calls what\", I can classify each function into its domain (Git, Bitbucket, Unity, etc.) and detect where domain boundaries are violated (e.g., one function mixing multiple domains).</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#domain-summary","title":"Domain Summary","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#helper-domains-used","title":"Helper Domains Used","text":"Helper Domain Functions Called Used Stage generalHelper Git <code>checkoutBranch</code> Post generalHelper Bitbucket <code>getFullCommitHash</code>, <code>sendBuildStatus</code> Delete Merged Branch, Prepare WORKSPACE, Post generalHelper Web Server <code>cleanMergedBranchFromWebServer</code> Delete Merged Branch generalHelper Parsing <code>parseJson</code>, <code>parseTicketNumber</code> Delete Merged Branch generalHelper File System <code>cleanUpPRBranch</code> Delete Merged Branch unityHelper Unity CLI <code>runUnityStage</code> Prepare WORKSPACE, EditMode, PlayMode, Build Project unityHelper Unity Installation <code>getUnityExecutable</code> Prepare WORKSPACE"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#jenkinsfile-direct-calls","title":"Jenkinsfile Direct Calls","text":"Domain Direct Call Used Stage Jenkins Pipeline DSL <code>pipeline</code>, <code>stages</code>, <code>post</code>, <code>script</code>, <code>dir</code>, <code>credentials</code> All Git <code>git clone</code>, <code>git checkout</code>, <code>git reset</code>, <code>git pull</code> Prepare WORKSPACE File System <code>mkdir -p</code>, <code>cp</code>, <code>mv</code> Linting, EditMode, Build Project Linting (Bash) <code>sh Linting.bash</code> Linting Web Server (SSH/SCP) <code>ssh mkdir</code>, <code>ssh chown</code>, <code>scp</code>, <code>ssh bash UpdateBuildURL.sh</code> Deploy Build"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#domain-mapping-by-stage","title":"Domain Mapping by Stage","text":"Stage Git Bitbucket Unity CLI Unity Install Web Server Parsing File System Linting Delete Merged Branch \u2713 \u2713 \u2713 \u2713 Prepare WORKSPACE \u2713 \u2713 \u2713 \u2713 Linting \u2713 \u2713 EditMode Tests \u2713 \u2713 PlayMode Tests \u2713 Build Project \u2713 \u2713 Deploy Build \u2713 Post \u2713 \u2713"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#overall-pipeline-overview","title":"Overall Pipeline Overview","text":"<pre><code>flowchart LR\n    subgraph Stages\n        S1[Delete Merged Branch]\n        S2[Prepare WORKSPACE]\n        S3[Linting]\n        S4[EditMode Tests]\n        S5[PlayMode Tests]\n        S6[Build Project]\n        S7[Deploy Build]\n    end\n\n    S1 --&gt; S2 --&gt; S3 --&gt; S4 --&gt; S5 --&gt; S6 --&gt; S7\n\n    S7 --&gt; Post[Post&lt;br/&gt;always/success/failure/aborted]</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#stage-1-delete-merged-branch","title":"Stage 1: Delete Merged Branch","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n    participant WS as Web Server&lt;br/&gt;(SSH/SCP)\n\n    Note over JF: Stage: Delete Merged Branch\n\n    JF-&gt;&gt;GH: load(\"generalHelper.groovy\")\n    JF-&gt;&gt;GH: load(\"unityHelper.groovy\")\n\n    JF-&gt;&gt;GH: parseJson()\n    Note over GH: Domain: Parsing\n    GH--&gt;&gt;JF: buildResults, stageResults\n\n    JF-&gt;&gt;JF: mainBranches.contains(DESTINATION_BRANCH)\n    Note over JF: Abort if not merging to main\n\n    JF-&gt;&gt;GH: getFullCommitHash(workspace, PR_COMMIT)\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: get_bitbucket_commit_hash.py\n    Python-&gt;&gt;BB: GET /commits\n    BB--&gt;&gt;Python: commit hash\n    Python--&gt;&gt;GH: full commit hash\n    GH--&gt;&gt;JF: COMMIT_HASH\n\n    JF-&gt;&gt;GH: cleanUpPRBranch(PR_BRANCH)\n    Note over GH: Domain: File System\n    GH--&gt;&gt;JF: find &amp; rm -rf PR directories\n\n    JF-&gt;&gt;GH: parseTicketNumber(PR_BRANCH)\n    Note over GH: Domain: Parsing\n    GH--&gt;&gt;JF: ticketNumber\n\n    JF-&gt;&gt;GH: cleanMergedBranchFromWebServer(FOLDER_NAME, ticketNumber)\n    Note over GH: Domain: Web Server\n    GH-&gt;&gt;WS: ssh rm -rf /var/www/html/{folder}/PR-Builds/{ticket}\n    WS--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#stage-2-prepare-workspace","title":"Stage 2: Prepare WORKSPACE","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant UH as unityHelper\n    participant Git as Git CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n    participant Unity as Unity CLI\n\n    Note over JF: Stage: Prepare WORKSPACE\n\n    Note over JF,Git: Jenkinsfile Direct Git Calls\n    alt !fileExists(PROJECT_DIR)\n        JF-&gt;&gt;Git: git clone {REPO_SSH} {PROJECT_DIR}\n    end\n\n    JF-&gt;&gt;Git: git checkout {DESTINATION_BRANCH}\n    JF-&gt;&gt;Git: git reset --hard HEAD\n    JF-&gt;&gt;Git: git pull\n\n    JF-&gt;&gt;GH: sendBuildStatus(workspace, 'INPROGRESS', commitHash, true)\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py -d\n    Python-&gt;&gt;BB: POST /statuses/build\n    BB--&gt;&gt;Python: OK\n\n    JF-&gt;&gt;UH: getUnityExecutable(workspace, projectDir)\n    Note over UH: Domain: Unity Installation\n    UH-&gt;&gt;Python: get_unity_version.py (executable-path)\n    Python--&gt;&gt;UH: unity path\n    UH--&gt;&gt;JF: UNITY_EXECUTABLE\n\n    JF-&gt;&gt;UH: runUnityStage('Rider', errorMsg)\n    Note over UH: Domain: Unity CLI\n    UH-&gt;&gt;UH: runUnityBatchMode('Rider')\n    UH-&gt;&gt;Unity: unity -batchmode -executeMethod Rider.SyncSolution\n    Unity--&gt;&gt;UH: exit code\n    UH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#stage-3-linting","title":"Stage 3: Linting","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant FS as File System\n    participant Bash as Bash Scripts\n\n    Note over JF: Stage: Linting\n\n    JF-&gt;&gt;FS: mkdir -p linting_results\n    JF-&gt;&gt;FS: cp .editorconfig\n    JF-&gt;&gt;Bash: sh Linting.bash\n    Bash--&gt;&gt;JF: exitCode\n\n    alt exitCode != 0\n        Note over JF: catchError - stage FAILURE\n    end</code></pre> <p>Note: In DLX CD, linting results are not reported to Bitbucket (differs from CI)</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#stage-4-editmode-tests","title":"Stage 4: EditMode Tests","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant FS as File System\n    participant UH as unityHelper\n    participant Unity as Unity CLI\n\n    Note over JF: Stage: EditMode Tests\n\n    JF-&gt;&gt;FS: mkdir -p test_results\n\n    JF-&gt;&gt;UH: runUnityStage('EditMode', errorMsg)\n    UH-&gt;&gt;UH: runUnityBatchMode('EditMode')\n    UH-&gt;&gt;Unity: unity -batchmode -nographics -testPlatform EditMode -runTests\n    Unity--&gt;&gt;UH: exit code + test_results/*.xml\n    UH--&gt;&gt;JF: OK/FAIL</code></pre> <p>Note: In DLX CD, Code Coverage is not generated (CI_PIPELINE=false)</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#stage-5-playmode-tests","title":"Stage 5: PlayMode Tests","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant UH as unityHelper\n    participant Unity as Unity CLI\n\n    Note over JF: Stage: PlayMode Tests\n\n    JF-&gt;&gt;UH: runUnityStage('PlayMode', errorMsg)\n    UH-&gt;&gt;UH: runUnityBatchMode('PlayMode')\n    UH-&gt;&gt;Unity: xvfb-run unity -batchmode -testPlatform PlayMode -runTests\n    Unity--&gt;&gt;UH: exit code + test_results/*.xml\n    UH--&gt;&gt;JF: OK/FAIL</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#stage-6-build-project","title":"Stage 6: Build Project","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant FS as File System\n    participant UH as unityHelper\n    participant Unity as Unity CLI\n\n    Note over JF: Stage: Build Project\n\n    JF-&gt;&gt;FS: mkdir -p Assets/Editor\n    JF-&gt;&gt;FS: mv Builder.cs Assets/Editor/\n\n    JF-&gt;&gt;UH: runUnityStage('Webgl', errorMsg)\n    UH-&gt;&gt;UH: runUnityBatchMode('Webgl')\n    UH-&gt;&gt;Unity: xvfb-run unity -batchmode -buildTarget WebGL -executeMethod Builder.BuildWebGL\n    Unity--&gt;&gt;UH: Builds/*\n    UH--&gt;&gt;JF: OK/FAIL</code></pre> <p>Note: In DLX CD, Build Report is not sent to Bitbucket (differs from CI)</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#stage-7-deploy-build","title":"Stage 7: Deploy Build","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant WS1 as LTI Web Server\n    participant WS2 as eConestoga DLX Server\n\n    Note over JF: Stage: Deploy Build\n    Note over JF: Jenkinsfile Direct Web Server Calls\n\n    Note over JF,WS1: Deploy to LTI Web Server\n    JF-&gt;&gt;WS1: ssh mkdir -p /var/www/html/{FOLDER_NAME}\n    JF-&gt;&gt;WS1: ssh chown vconadmin:vconadmin\n    JF-&gt;&gt;WS1: scp -rp Builds/*\n    JF-&gt;&gt;WS1: ssh bash UpdateBuildURL.sh\n    WS1--&gt;&gt;JF: OK\n\n    alt DLX_PROJECT_LIST.contains(PR_REPO_NAME)\n        Note over JF,WS2: Deploy to eConestoga DLX Server\n        JF-&gt;&gt;WS2: ssh mkdir -p /var/www/html/{FOLDER_NAME}\n        JF-&gt;&gt;WS2: ssh chown vconadmin:vconadmin\n        JF-&gt;&gt;WS2: scp -rp Builds/*\n        JF-&gt;&gt;WS2: ssh bash UpdateBuildURL.sh\n        WS2--&gt;&gt;JF: OK\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#post-alwayssuccessfailureaborted","title":"Post: always/success/failure/aborted","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant Git as Git CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Post: always/success/failure/aborted\n\n    Note over JF,GH: always block\n    JF-&gt;&gt;JF: currentBuild.description = PR_BRANCH\n    JF-&gt;&gt;GH: checkoutBranch(PROJECT_DIR, DESTINATION_BRANCH)\n    Note over GH: Domain: Git\n    GH-&gt;&gt;Git: git reset --hard\n    GH-&gt;&gt;Git: git clean -fd\n    GH-&gt;&gt;Git: git checkout {destination}\n    GH-&gt;&gt;Git: git reset --hard origin/{destination}\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n\n    Note over JF,GH: success/failure/aborted\n    alt success\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'SUCCESSFUL', commitHash, true)\n    else failure\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'FAILED', commitHash, true)\n    else aborted\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'STOPPED', commitHash, true)\n    end\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py -d\n    Python-&gt;&gt;BB: POST /statuses/build\n    BB--&gt;&gt;Python: OK\n    GH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#observations","title":"Observations","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#delegation-pattern","title":"Delegation Pattern","text":"Pattern Example Count Jenkinsfile \u2192 generalHelper \u2192 External <code>sendBuildStatus</code> \u2192 Python \u2192 Bitbucket API 3 Jenkinsfile \u2192 unityHelper \u2192 External <code>runUnityStage</code> \u2192 Unity CLI 4 Jenkinsfile \u2192 Git direct <code>git clone</code>, <code>git checkout</code>, <code>git pull</code> 4 Jenkinsfile \u2192 Web Server direct <code>ssh</code>, <code>scp</code> in Deploy Build 8 Jenkinsfile \u2192 Bash direct <code>Linting.bash</code> 1"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#ci-vs-cd-differences","title":"CI vs CD Differences","text":"Item DLX CI DLX CD Linting report to Bitbucket \u2713 \u2717 Code Coverage generation \u2713 \u2717 Build report to Bitbucket \u2713 \u2717 Test report to Bitbucket \u2713 \u2717 Web Server deployment PR-Builds (reports) Production (builds) Git operations Via generalHelper Mixed (direct + helper)"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-cd/#inconsistencies","title":"Inconsistencies","text":"Issue Description Mixed Git delegation CI uses <code>cloneOrUpdateRepo</code>, CD uses direct Git commands in Prepare WORKSPACE Mixed Web Server delegation Delete Merged Branch uses helper, Deploy Build uses direct calls No <code>initializeEnvironment</code> CD calls <code>sendBuildStatus</code> directly instead of using mixed function <p>\u2190 Domain Mapping Summary | DLX CI \u2192</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/","title":"DLX CI Pipeline Sequence Diagrams","text":"<p>Analysis Target: <code>DLXJenkins/Jenkinsfile</code> (DLX Unity CI Pipeline)</p> <p>Related: Domain Mapping Summary</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#why-sequence-diagrams","title":"Why Sequence Diagrams?","text":"<p>Q: Why use Sequence Diagrams for Jenkins Pipeline analysis?</p> <p>A: Jenkins Pipeline is procedural code. Unlike OOP where classes naturally define domain boundaries, procedural code mixes multiple domains within sequential execution flow. Sequence Diagrams visualize the call flow between components, making it easier to identify which domains are involved at each stage.</p> <p>Q: What is the goal of this analysis?</p> <p>A: To identify domains by function. By tracing \"who calls what\", I can classify each function into its domain (Git, Bitbucket, Unity, etc.) and detect where domain boundaries are violated (e.g., one function mixing multiple domains).</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#domain-summary","title":"Domain Summary","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#helper-domains-used","title":"Helper Domains Used","text":"Helper Domain Functions Called Used Stage generalHelper Git <code>cloneOrUpdateRepo</code>, <code>mergeBranchIfNeeded</code>, <code>isBranchUpToDateWithRemote</code>, <code>checkoutBranch</code> Prepare WORKSPACE, Post generalHelper Bitbucket <code>getFullCommitHash</code>, <code>sendBuildStatus</code> Prepare WORKSPACE, Post generalHelper Web Server <code>publishTestResultsHtmlToWebServer</code>, <code>publishBuildResultsToWebServer</code> Code Coverage, Build Project generalHelper Parsing <code>parseJson</code> Prepare WORKSPACE generalHelper Mixed (Bitbucket + Parsing) <code>initializeEnvironment</code> Prepare WORKSPACE unityHelper Unity CLI <code>runUnityStage</code> Prepare WORKSPACE, EditMode, PlayMode, Code Coverage, Build Project unityHelper Unity Installation <code>getUnityExecutable</code> Prepare WORKSPACE unityHelper Bitbucket <code>sendTestReport</code> Code Coverage"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#jenkinsfile-direct-calls","title":"Jenkinsfile Direct Calls","text":"Domain Direct Call Used Stage Jenkins Pipeline DSL <code>pipeline</code>, <code>stages</code>, <code>post</code>, <code>script</code>, <code>dir</code>, <code>credentials</code> All File System <code>mkdir -p</code>, <code>cp</code> Linting, EditMode, Build Project Linting (Bash) <code>sh Linting.bash</code> Linting Bitbucket (Python) <code>linting_error_report.py</code>, <code>create_bitbucket_webgl_build_report.py</code> Linting, Build Project"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#domain-mapping-by-stage","title":"Domain Mapping by Stage","text":"Stage Git Bitbucket Unity CLI Unity Install Web Server Parsing File System Linting Prepare WORKSPACE \u2713 \u2713 \u2713 \u2713 \u2713 Linting \u2713 \u2713 \u2713 EditMode Tests \u2713 \u2713 PlayMode Tests \u2713 Code Coverage \u2713 \u2713 \u2713 Build Project \u2713 \u2713 \u2713 \u2713 Post \u2713 \u2713"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#overall-pipeline-overview","title":"Overall Pipeline Overview","text":"<pre><code>flowchart LR\n    subgraph Stages\n        S1[Prepare WORKSPACE]\n        S2[Linting]\n        S3[EditMode Tests]\n        S4[PlayMode Tests]\n        S5[Code Coverage&lt;br/&gt;Send Reports]\n        S6[Build Project]\n    end\n\n    S1 --&gt; S2 --&gt; S3 --&gt; S4 --&gt; S5 --&gt; S6\n\n    S6 --&gt; Post[Post&lt;br/&gt;always/success/failure/aborted]</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#stage-1-prepare-workspace","title":"Stage 1: Prepare WORKSPACE","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant UH as unityHelper\n    participant Git as Git CLI\n    participant BB as Bitbucket API\n    participant Unity as Unity CLI\n    participant Python as Python Scripts\n\n    Note over JF: Stage: Prepare WORKSPACE\n\n    JF-&gt;&gt;JF: sh 'env' (print environment variables)\n    JF-&gt;&gt;GH: load(\"generalHelper.groovy\")\n    JF-&gt;&gt;UH: load(\"unityHelper.groovy\")\n\n    JF-&gt;&gt;GH: parseJson()\n    GH--&gt;&gt;JF: buildResults, stageResults\n\n    JF-&gt;&gt;GH: isBranchUpToDateWithRemote(PR_BRANCH)\n    GH-&gt;&gt;Git: git fetch origin\n    GH-&gt;&gt;Git: git rev-parse HEAD\n    GH-&gt;&gt;Git: git rev-parse origin/{branch}\n    Git--&gt;&gt;GH: commit hashes\n    GH--&gt;&gt;JF: true/false\n\n    JF-&gt;&gt;GH: getFullCommitHash(PR_BRANCH)\n    GH-&gt;&gt;Python: get_bitbucket_commit_hash.py\n    Python-&gt;&gt;BB: GET /commits\n    BB--&gt;&gt;Python: commit hash\n    Python--&gt;&gt;GH: full commit hash\n    GH--&gt;&gt;JF: COMMIT_HASH\n\n    JF-&gt;&gt;GH: initializeEnvironment(workspace, commitHash, prBranch)\n    Note over GH: Mixed: Bitbucket + Parsing\n    GH-&gt;&gt;GH: sendBuildStatus('INPROGRESS')\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py\n    Python-&gt;&gt;BB: POST /statuses/build\n    GH-&gt;&gt;GH: parseTicketNumber(prBranch)\n    GH--&gt;&gt;JF: TICKET_NUMBER, FOLDER_NAME\n\n    JF-&gt;&gt;GH: cloneOrUpdateRepo(workspace, projectDir, prBranch)\n    GH-&gt;&gt;Git: git clone / git fetch\n    GH-&gt;&gt;Git: git checkout\n    GH-&gt;&gt;Git: git reset --hard\n    GH-&gt;&gt;Git: git clean -fd\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n\n    JF-&gt;&gt;GH: mergeBranchIfNeeded(prBranch)\n    GH-&gt;&gt;GH: getDefaultBranch()\n    GH-&gt;&gt;Git: git remote show origin\n    Git--&gt;&gt;GH: default branch\n    GH-&gt;&gt;GH: isBranchUpToDateWithMain()\n    GH-&gt;&gt;Git: git merge-base --is-ancestor\n    GH-&gt;&gt;GH: tryMerge(defaultBranch)\n    GH-&gt;&gt;Git: git merge origin/{default}\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n\n    JF-&gt;&gt;UH: getUnityExecutable(workspace, projectDir)\n    UH-&gt;&gt;Python: get_unity_version.py (executable-path)\n    Python--&gt;&gt;UH: unity path\n    UH--&gt;&gt;JF: UNITY_EXECUTABLE\n\n    JF-&gt;&gt;UH: runUnityStage('Rider', errorMsg)\n    UH-&gt;&gt;UH: runUnityBatchMode('Rider')\n    UH-&gt;&gt;Unity: unity -batchmode -executeMethod Rider.SyncSolution\n    Unity--&gt;&gt;UH: exit code\n    UH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#stage-2-linting","title":"Stage 2: Linting","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant FS as File System\n    participant Bash as Bash Scripts\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Stage: Linting\n\n    JF-&gt;&gt;FS: mkdir -p linting_results\n    JF-&gt;&gt;FS: cp .editorconfig\n    JF-&gt;&gt;Bash: sh Linting.bash\n    Bash--&gt;&gt;JF: exitCode\n\n    alt exitCode == 2 (lint errors)\n        JF-&gt;&gt;Python: linting_error_report.py (fail)\n        Python-&gt;&gt;BB: POST /reports\n    else exitCode == 0\n        JF-&gt;&gt;Python: linting_error_report.py (pass)\n        Python-&gt;&gt;BB: POST /reports\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#stage-3-editmode-tests","title":"Stage 3: EditMode Tests","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant FS as File System\n    participant UH as unityHelper\n    participant Unity as Unity CLI\n\n    Note over JF: Stage: EditMode Tests\n\n    JF-&gt;&gt;FS: mkdir -p test_results\n    JF-&gt;&gt;FS: mkdir -p coverage_results\n\n    JF-&gt;&gt;UH: runUnityStage('EditMode', errorMsg)\n    UH-&gt;&gt;UH: runUnityBatchMode('EditMode')\n    UH-&gt;&gt;UH: setLogFilePathAndUrl()\n    UH-&gt;&gt;UH: getTestRunArgs()\n    UH-&gt;&gt;UH: getCodeCoverageArguments()\n    UH-&gt;&gt;Unity: unity -batchmode -nographics -testPlatform EditMode -runTests -enableCodeCoverage\n    Unity--&gt;&gt;UH: exit code + test_results/*.xml\n    UH--&gt;&gt;JF: OK/FAIL</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#stage-4-playmode-tests","title":"Stage 4: PlayMode Tests","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant UH as unityHelper\n    participant Unity as Unity CLI\n\n    Note over JF: Stage: PlayMode Tests\n\n    JF-&gt;&gt;UH: runUnityStage('PlayMode', errorMsg)\n    UH-&gt;&gt;UH: runUnityBatchMode('PlayMode')\n    UH-&gt;&gt;Unity: xvfb-run unity -batchmode -testPlatform PlayMode -runTests -enableCodeCoverage\n    Unity--&gt;&gt;UH: exit code + test_results/*.xml\n    UH--&gt;&gt;JF: OK/FAIL</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#stage-5-code-coverage-send-reports","title":"Stage 5: Code Coverage &amp; Send Reports","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant UH as unityHelper\n    participant Unity as Unity CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n    participant WS as Web Server&lt;br/&gt;(SSH/SCP)\n\n    Note over JF: Stage: Code Coverage &amp; Send Reports\n\n    JF-&gt;&gt;UH: runUnityStage('Coverage', errorMsg)\n    UH-&gt;&gt;UH: runUnityBatchMode('Coverage')\n    UH-&gt;&gt;UH: loadPathsToExclude()\n    Note over UH: Read Settings.json\n    UH-&gt;&gt;UH: fetCoverageOptionsKeyAndValue()\n    UH-&gt;&gt;UH: buildCoverageOptions()\n    UH-&gt;&gt;Unity: unity -batchmode -nographics -enableCodeCoverage -coverageOptions\n    Unity--&gt;&gt;UH: coverage_results/Report\n    UH--&gt;&gt;JF: OK/FAIL\n\n    JF-&gt;&gt;GH: publishTestResultsHtmlToWebServer(folderName, ticketNum, reportPath, 'CodeCoverage')\n    GH-&gt;&gt;WS: ssh mkdir -p /var/www/html/{folder}/{ticket}/CodeCoverage\n    GH-&gt;&gt;WS: scp -r coverage_results/Report/*\n    GH-&gt;&gt;WS: ssh chmod 755 &amp; chown\n    WS--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n\n    JF-&gt;&gt;UH: sendTestReport(workspace, reportDir, commitHash)\n    UH-&gt;&gt;Python: create_bitbucket_test_report.py\n    Python-&gt;&gt;BB: POST /reports\n    BB--&gt;&gt;Python: OK\n    UH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#stage-6-build-project","title":"Stage 6: Build Project","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant FS as File System\n    participant GH as generalHelper\n    participant UH as unityHelper\n    participant Unity as Unity CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n    participant WS as Web Server&lt;br/&gt;(SSH/SCP)\n\n    Note over JF: Stage: Build Project\n\n    JF-&gt;&gt;FS: mkdir -p Assets/Editor\n    JF-&gt;&gt;FS: cp Builder.cs Assets/Editor/\n\n    JF-&gt;&gt;UH: runUnityStage('Webgl', errorMsg)\n    UH-&gt;&gt;UH: runUnityBatchMode('Webgl')\n    UH-&gt;&gt;Unity: xvfb-run unity -batchmode -buildTarget WebGL -executeMethod Builder.BuildWebGL\n    Unity--&gt;&gt;UH: Builds/* + build_project_results/*.log\n    UH--&gt;&gt;JF: OK/FAIL\n\n    JF-&gt;&gt;Python: create_bitbucket_webgl_build_report.py (commitHash, logPath)\n    Python-&gt;&gt;BB: POST /reports\n    BB--&gt;&gt;Python: OK\n\n    JF-&gt;&gt;GH: publishBuildResultsToWebServer(folderName, ticketNum, buildsPath, resultsPath)\n    GH-&gt;&gt;WS: ssh mkdir -p /var/www/html/{folder}/{ticket}/build\n    GH-&gt;&gt;WS: scp -r Builds/*\n    GH-&gt;&gt;WS: scp -r build_project_results/*\n    GH-&gt;&gt;WS: ssh chmod 755 &amp; chown\n    WS--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#post-alwayssuccessfailureaborted","title":"Post: always/success/failure/aborted","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant Git as Git CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Post: always/success/failure/aborted\n\n    Note over JF,GH: always block\n    JF-&gt;&gt;GH: checkoutBranch(PROJECT_DIR, DESTINATION_BRANCH)\n    GH-&gt;&gt;Git: git reset --hard\n    GH-&gt;&gt;Git: git clean -fd\n    GH-&gt;&gt;Git: git checkout {destination}\n    GH-&gt;&gt;Git: git reset --hard origin/{destination}\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n    JF-&gt;&gt;JF: currentBuild.description = PR_BRANCH\n\n    Note over JF,GH: success/failure/aborted\n    alt success\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'SUCCESSFUL', commitHash)\n    else failure\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'FAILED', commitHash)\n    else aborted\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'STOPPED', commitHash)\n    end\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py\n    Python-&gt;&gt;BB: POST /statuses/build\n    BB--&gt;&gt;Python: OK\n    GH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#observations","title":"Observations","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#delegation-pattern","title":"Delegation Pattern","text":"Pattern Example Count Jenkinsfile \u2192 generalHelper \u2192 External <code>sendBuildStatus</code> \u2192 Python \u2192 Bitbucket API 5 Jenkinsfile \u2192 unityHelper \u2192 External <code>runUnityStage</code> \u2192 Unity CLI 5 Jenkinsfile \u2192 Python direct <code>linting_error_report.py</code> 2 Jenkinsfile \u2192 Bash direct <code>Linting.bash</code> 1"},{"location":"problem-analysis/pipeline-sequence-diagrams/dlx-ci/#inconsistencies","title":"Inconsistencies","text":"Issue Description Direct Python calls <code>linting_error_report.py</code>, <code>create_bitbucket_webgl_build_report.py</code> bypass Helper Mixed domain function <code>initializeEnvironment</code> combines Bitbucket + Parsing (SRP violation) Inconsistent Bitbucket reporting <code>sendTestReport</code> in unityHelper, but linting/build reports called directly <p>\u2190 Domain Mapping Summary</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/","title":"Pipeline Domain Mapping","text":"<p>Summary of domains used across all 5 pipelines, derived from sequence diagram analysis.</p> <p>Related: DLX CI | DLX CD | JS CI | JS CD | Jenkins CI</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#why-this-document","title":"Why This Document?","text":"<p>Q: Why map domains across pipelines?</p> <p>A: Jenkins Pipeline is procedural code. Unlike OOP where classes naturally define domain boundaries, procedural code mixes multiple domains within sequential execution flow. This document summarizes domain distribution across all pipelines to establish a baseline for Software Smells analysis.</p> <p>Q: What is a \"domain\" in this context?</p> <p>A: A domain represents a functional boundary - a distinct area of responsibility such as Git operations, Bitbucket API calls, or Unity CLI commands.</p> <p>Q: How is this document used?</p> <p>A: This document serves as the domain reference when analyzing Software Smells (e.g., Divergent Change, Shotgun Surgery). By defining which functions belong to which domains, we can objectively measure SRP violations and identify refactoring targets.</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#1-domain-by-pipeline","title":"1. Domain by Pipeline","text":"Domain DLX CI DLX CD JS CI JS CD Jenkins CI Primary Location Git \u2713 \u2713 \u2713 \u2713 \u2713 generalHelper + Jenkinsfile Bitbucket \u2713 \u2713 \u2713 \u2713 \u2713 generalHelper + unityHelper + Python Web Server (SSH/SCP) \u2713 \u2713 \u2713 \u2713 generalHelper + Jenkinsfile SonarQube \u2713 \u2713 \u2713 generalHelper + sonar-scanner Parsing \u2713 \u2713 \u2713 \u2713 \u2713 generalHelper File System \u2713 \u2713 \u2713 \u2713 \u2713 generalHelper + jsHelper + Jenkinsfile Unity CLI \u2713 \u2713 unityHelper Unity Installation \u2713 \u2713 unityHelper Node.js (npm) \u2713 \u2713 jsHelper + Jenkinsfile Utility \u2713 jsHelper Linting (Bash) \u2713 \u2713 Jenkinsfile direct Docker \u2713 \u2713 Jenkinsfile direct Azure \u2713 Jenkinsfile direct Gradle \u2713 Jenkinsfile direct Groovydoc \u2713 Jenkinsfile direct"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#2-domain-by-helper-file","title":"2. Domain by Helper File","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#21-generalhelpergroovy-7-domains-1-mixed-21-functions","title":"2.1 generalHelper.groovy (7 domains + 1 mixed, 21 functions)","text":"# Domain Functions Count 1 Git <code>cloneOrUpdateRepo</code>, <code>getDefaultBranch</code>, <code>checkoutBranch</code>, <code>mergeBranchIfNeeded</code>, <code>isBranchUpToDateWithRemote</code>, <code>isBranchUpToDateWithMain</code>, <code>tryMerge</code>, <code>getCurrentCommitHash</code> 8 2 Bitbucket <code>getFullCommitHash</code>, <code>sendBuildStatus</code> 2 3 Web Server (SSH/SCP) <code>publishTestResultsHtmlToWebServer</code>, <code>publishBuildResultsToWebServer</code>, <code>cleanMergedBranchFromWebServer</code>, <code>publishGroovyDocToWebServer</code> 4 4 SonarQube <code>checkQualityGateStatus</code> 1 5 Parsing <code>parseJson</code>, <code>parseTicketNumber</code> 2 6 File System <code>cleanUpPRBranch</code> 1 7 Logging <code>logMessage</code>, <code>closeLogfiles</code> 2 - Mixed (Bitbucket + Parsing) <code>initializeEnvironment</code> 1 <p>Note: <code>initializeEnvironment</code> combines Bitbucket notification and parsing logic in single function - this is an SRP violation.</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#22-jshelpergroovy-4-domains-10-functions","title":"2.2 jsHelper.groovy (4 domains, 10 functions)","text":"# Domain Functions Count 1 Node.js/npm <code>installNpmInTestingDirs</code>, <code>runUnitTestsInTestingDirs</code>, <code>executeLintingInTestingDirs</code>, <code>checkNodeVersion</code>, <code>getPackageJsonVersion</code> 5 2 File System <code>findTestingDirs</code>, <code>retrieveReportSummaryDirs</code> 2 3 Utility <code>versionCompare</code>, <code>runCommandReturnStatus</code> 2 4 Logging <code>logMessage</code> 1"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#23-unityhelpergroovy-3-domains-8-functions","title":"2.3 unityHelper.groovy (3 domains, 8 functions)","text":"# Domain Functions Count 1 Unity CLI <code>runUnityStage</code>, <code>runUnityBatchMode</code>, <code>getCodeCoverageArguments</code>, <code>fetCoverageOptionsKeyAndValue</code>, <code>loadPathsToExclude</code>, <code>buildCoverageOptions</code> 6 2 Unity Installation <code>getUnityExecutable</code> 1 3 Bitbucket <code>sendTestReport</code> 1"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#3-pipeline-comparison","title":"3. Pipeline Comparison","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#31-ci-pipelines","title":"3.1 CI Pipelines","text":"Item DLX CI JS CI Jenkins CI Build Tool Unity CLI Node.js (npm) Gradle + Docker Helper unityHelper jsHelper (none) Trigger OPEN OPEN OPEN + MERGED <code>initializeEnvironment</code> \u2713 \u2713 \u2713 <code>mergeBranchIfNeeded</code> \u2713 \u2713 \u2717 <code>checkoutBranch</code> in Post \u2713 \u2713 \u2717 Linting Bash Script (C#) jsHelper (ESLint) Docker (npm-groovy-lint) Test Type EditMode/PlayMode Jest Spock Code Coverage Unity Code Coverage lcov-report JaCoCo Static Analysis No SonarQube SonarQube Test Report to Bitbucket \u2713 (Python) \u2713 (Python) \u2717 Build Output WebGL No No Documentation No No Groovydoc"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#32-cd-pipelines","title":"3.2 CD Pipelines","text":"Item DLX CD JS CD Trigger MERGED MERGED <code>initializeEnvironment</code> \u2717 (direct call) \u2717 (direct call) Git in Prepare WORKSPACE Direct Direct <code>checkoutBranch</code> in Post \u2713 (helper) \u2713 (helper) Deploy Target LTI Web Server, eConestoga Azure Container App Build Tool Unity (WebGL) Docker Deploy Method SSH/SCP (direct + helper) Docker push + az containerapp (direct) Version Management None package.json version compare Conditional Deploy DLX_PROJECT_LIST Version compare result Coverage Report to Bitbucket \u2717 \u2717"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#33-ci-vs-cd-pattern","title":"3.3 CI vs CD Pattern","text":"Item CI Pipelines CD Pipelines <code>initializeEnvironment</code> \u2713 Used \u2717 Direct <code>sendBuildStatus</code> call Git operations Via generalHelper Mixed (direct + helper) Test/Coverage reports Sent to Bitbucket Not sent Delete Merged Branch No Yes"},{"location":"problem-analysis/pipeline-sequence-diagrams/domain-mapping/#4-source-documents","title":"4. Source Documents","text":"<ul> <li>DLX CI Sequence Diagram</li> <li>DLX CD Sequence Diagram</li> <li>JS CI Sequence Diagram</li> <li>JS CD Sequence Diagram</li> <li>Jenkins CI Sequence Diagram</li> </ul>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/","title":"Jenkins CI Pipeline Sequence Diagrams","text":"<p>Analysis Target: <code>PipelineForJenkins/Jenkinsfile</code> (Jenkins Groovy CI Pipeline)</p> <p>Trigger: Runs when PR is <code>OPEN</code> or <code>MERGED</code> (differs from other pipelines)</p> <p>Related: Domain Mapping Summary</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#why-sequence-diagrams","title":"Why Sequence Diagrams?","text":"<p>Q: Why use Sequence Diagrams for Jenkins Pipeline analysis?</p> <p>A: Jenkins Pipeline is procedural code. Unlike OOP where classes naturally define domain boundaries, procedural code mixes multiple domains within sequential execution flow. Sequence Diagrams visualize the call flow between components, making it easier to identify which domains are involved at each stage.</p> <p>Q: What is the goal of this analysis?</p> <p>A: To identify domains by function. By tracing \"who calls what\", I can classify each function into its domain (Git, Bitbucket, Unity, etc.) and detect where domain boundaries are violated (e.g., one function mixing multiple domains).</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#domain-summary","title":"Domain Summary","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#helper-domains-used","title":"Helper Domains Used","text":"Helper Domain Functions Called Used Stage generalHelper Git <code>cloneOrUpdateRepo</code>, <code>isBranchUpToDateWithRemote</code>, <code>checkoutBranch</code> Prepare WORKSPACE generalHelper Bitbucket <code>getFullCommitHash</code>, <code>sendBuildStatus</code> Prepare WORKSPACE, Post generalHelper Web Server <code>publishGroovyDocToWebServer</code> Generate Groovydoc (MERGED only) generalHelper SonarQube <code>checkQualityGateStatus</code> Static Analysis generalHelper Parsing <code>parseJson</code> Prepare WORKSPACE generalHelper Mixed (Bitbucket + Parsing) <code>initializeEnvironment</code> Prepare WORKSPACE"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#jenkinsfile-direct-calls","title":"Jenkinsfile Direct Calls","text":"Domain Direct Call Used Stage Jenkins Pipeline DSL <code>pipeline</code>, <code>stages</code>, <code>post</code>, <code>script</code>, <code>dir</code>, <code>credentials</code>, <code>tool</code>, <code>withSonarQubeEnv</code>, <code>withCredentials</code>, <code>docker.image().inside()</code>, <code>junit</code> All Docker <code>docker info</code>, <code>docker.image().inside()</code>, <code>npm-groovy-lint</code> Lint Groovy Code Gradle <code>gradle test</code> Run Unit Tests Groovydoc <code>groovydoc</code> Generate Groovydoc File System <code>mkdir -p</code>, <code>find</code> Generate Groovydoc SonarQube <code>sonar-scanner</code> Static Analysis Bitbucket (Python) <code>Lint_groovy_report.py</code> Lint Groovy Code"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#domain-mapping-by-stage","title":"Domain Mapping by Stage","text":"Stage Git Bitbucket Docker Gradle Groovydoc Web Server SonarQube Parsing File System Prepare WORKSPACE \u2713 \u2713 \u2713 Lint Groovy Code \u2713 \u2713 Generate Groovydoc \u2713 \u2713* \u2713 Run Unit Tests \u2713 Publish Test Results Static Analysis \u2713 Post \u2713 <p>*Web Server: Groovydoc deployed only when <code>PR_STATE == 'MERGED'</code></p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#overall-pipeline-overview","title":"Overall Pipeline Overview","text":"<pre><code>flowchart LR\n    subgraph Stages\n        S1[Prepare WORKSPACE]\n        S2[Lint Groovy Code]\n        S3[Generate Groovydoc]\n        S4[Run Unit Tests]\n        S5[Publish Test Results]\n        S6[Static Analysis]\n    end\n\n    S1 --&gt; S2 --&gt; S3 --&gt; S4 --&gt; S5 --&gt; S6\n\n    S6 --&gt; Post[Post&lt;br/&gt;always/success/failure/aborted]</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#stage-1-prepare-workspace","title":"Stage 1: Prepare WORKSPACE","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant Git as Git CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Stage: Prepare WORKSPACE\n\n    JF-&gt;&gt;GH: load(\"generalHelper.groovy\")\n\n    JF-&gt;&gt;GH: parseJson()\n    Note over GH: Domain: Parsing\n    GH--&gt;&gt;JF: buildResults, stageResults\n\n    JF-&gt;&gt;GH: isBranchUpToDateWithRemote(PR_BRANCH)\n    Note over GH: Domain: Git\n    GH-&gt;&gt;Git: git fetch origin\n    GH-&gt;&gt;Git: git rev-parse HEAD\n    GH-&gt;&gt;Git: git rev-parse origin/{branch}\n    Git--&gt;&gt;GH: commit hashes\n    GH--&gt;&gt;JF: true/false\n\n    JF-&gt;&gt;GH: getFullCommitHash(workspace, PR_COMMIT)\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: get_bitbucket_commit_hash.py\n    Python-&gt;&gt;BB: GET /commits\n    BB--&gt;&gt;Python: commit hash\n    Python--&gt;&gt;GH: full commit hash\n    GH--&gt;&gt;JF: COMMIT_HASH\n\n    JF-&gt;&gt;GH: initializeEnvironment(workspace, commitHash, prBranch)\n    Note over GH: Mixed: Bitbucket + Parsing\n    GH-&gt;&gt;GH: sendBuildStatus('INPROGRESS')\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py\n    Python-&gt;&gt;BB: POST /statuses/build\n    GH-&gt;&gt;GH: parseTicketNumber(prBranch)\n    GH--&gt;&gt;JF: TICKET_NUMBER, FOLDER_NAME\n\n    JF-&gt;&gt;GH: cloneOrUpdateRepo(workspace, projectDir, prBranch)\n    Note over GH: Domain: Git\n    GH-&gt;&gt;Git: git clone / git fetch\n    GH-&gt;&gt;Git: git checkout\n    GH-&gt;&gt;Git: git reset --hard\n    GH-&gt;&gt;Git: git clean -fd\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n\n    JF-&gt;&gt;GH: checkoutBranch(PROJECT_DIR, PR_BRANCH)\n    Note over GH: Domain: Git\n    GH-&gt;&gt;Git: git reset --hard\n    GH-&gt;&gt;Git: git clean -fd\n    GH-&gt;&gt;Git: git checkout {branch}\n    GH-&gt;&gt;Git: git reset --hard origin/{branch}\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK</code></pre> <p>Note: Unlike other CI pipelines, Jenkins CI does not call <code>mergeBranchIfNeeded</code></p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#stage-2-lint-groovy-code","title":"Stage 2: Lint Groovy Code","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant Docker as Docker Container&lt;br/&gt;(npm-groovy-lint)\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Stage: Lint Groovy Code\n\n    JF-&gt;&gt;JF: docker info\n    Note over JF: Jenkinsfile Direct: Docker\n\n    JF-&gt;&gt;Docker: docker.image('nvuillam/npm-groovy-lint').inside()\n    Note over Docker: Lint Groovy scripts\n    Docker-&gt;&gt;Docker: npm-groovy-lint --path groovy --output groovy-lint-report.json\n    Docker--&gt;&gt;JF: exitCodeGroovy\n\n    JF-&gt;&gt;Docker: docker.image('nvuillam/npm-groovy-lint').inside()\n    Note over Docker: Lint Jenkinsfiles\n    Docker-&gt;&gt;Docker: npm-groovy-lint --path DLXJenkins,JsJenkins,PipelineForJenkins\n    Docker--&gt;&gt;JF: exitCodeJenkins\n\n    alt exitCodeGroovy != 0 OR exitCodeJenkins != 0\n        JF-&gt;&gt;Python: Lint_groovy_report.py ... Fail\n        Note over JF: Jenkinsfile Direct: Bitbucket (Python)\n        Python-&gt;&gt;BB: POST /reports\n        BB--&gt;&gt;Python: OK\n        Note over JF: catchError - stage FAILURE\n    else all passed\n        JF-&gt;&gt;Python: Lint_groovy_report.py ... Pass\n        Python-&gt;&gt;BB: POST /reports\n        BB--&gt;&gt;Python: OK\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#stage-3-generate-groovydoc","title":"Stage 3: Generate Groovydoc","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant FS as File System\n    participant Groovy as Groovydoc CLI\n    participant GH as generalHelper\n    participant WS as Web Server&lt;br/&gt;(SSH/SCP)\n\n    Note over JF: Stage: Generate Groovydoc\n\n    JF-&gt;&gt;FS: find ${PROJECT_DIR}/groovy -type f -name '*.groovy'\n    Note over JF: Jenkinsfile Direct: File System\n    FS--&gt;&gt;JF: fileList\n\n    JF-&gt;&gt;FS: mkdir -p ${REPORT_DIR}\n\n    JF-&gt;&gt;Groovy: groovydoc -d ${REPORT_DIR} ${fileList}\n    Note over JF: Jenkinsfile Direct: Groovydoc\n    Groovy--&gt;&gt;JF: build/docs/groovydoc/\n\n    alt PR_STATE == 'MERGED'\n        JF-&gt;&gt;GH: publishGroovyDocToWebServer(REPORT_DIR)\n        Note over GH: Domain: Web Server\n        GH-&gt;&gt;WS: ssh mkdir -p /var/www/html/Jenkins/GroovyDoc\n        GH-&gt;&gt;WS: ssh rm -rf (clean old)\n        GH-&gt;&gt;WS: scp -r groovydoc/*\n        GH-&gt;&gt;WS: ssh find ... chmod 755/644\n        WS--&gt;&gt;GH: OK\n        GH--&gt;&gt;JF: OK\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#stage-4-run-unit-tests","title":"Stage 4: Run Unit Tests","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant Gradle as Gradle CLI\n\n    Note over JF: Stage: Run Unit Tests\n\n    JF-&gt;&gt;Gradle: gradle test\n    Note over JF: Jenkinsfile Direct: Gradle\n    Gradle-&gt;&gt;Gradle: Spock Framework test execution\n    Gradle--&gt;&gt;JF: build/test-results/test/*.xml\n    Gradle--&gt;&gt;JF: build/reports/tests/test/index.html\n    Gradle--&gt;&gt;JF: exitCode\n\n    alt exitCode != 0\n        Note over JF: catchError - stage FAILURE\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#stage-5-publish-test-results","title":"Stage 5: Publish Test Results","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant Jenkins as Jenkins JUnit Plugin\n\n    Note over JF: Stage: Publish Test Results\n\n    JF-&gt;&gt;Jenkins: junit 'build/test-results/test/*.xml'\n    Note over JF: Jenkins Pipeline DSL\n    Jenkins--&gt;&gt;JF: Test results published</code></pre> <p>Note: Unlike other pipelines, Jenkins CI does not send test/coverage reports to Bitbucket via Python scripts</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#stage-6-static-analysis","title":"Stage 6: Static Analysis","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant SQ as SonarQube\n\n    Note over JF: Stage: Static Analysis\n\n    JF-&gt;&gt;SQ: sonar-scanner -Dsonar.projectKey={key} -Dsonar.sources=.\n    Note over JF: Jenkinsfile Direct: SonarQube\n    SQ--&gt;&gt;JF: analysis queued\n\n    JF-&gt;&gt;GH: checkQualityGateStatus(SONAR_PROJECT_KEY, token)\n    Note over GH: Domain: SonarQube\n    loop retry (max 5)\n        GH-&gt;&gt;SQ: GET /api/ce/component\n        SQ--&gt;&gt;GH: queue status\n        alt queue not empty\n            GH-&gt;&gt;GH: sleep(10)\n        else queue empty\n            GH-&gt;&gt;SQ: GET /api/qualitygates/project_status\n            SQ--&gt;&gt;GH: entireCodeStatus, newCodeStatus\n        end\n    end\n    GH--&gt;&gt;JF: PASSED/FAILED\n\n    alt status != OK\n        Note over JF: catchError - stage FAILURE\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#post-alwayssuccessfailureaborted","title":"Post: always/success/failure/aborted","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Post: always/success/failure/aborted\n\n    Note over JF: always block\n    JF-&gt;&gt;JF: currentBuild.description = PR_BRANCH\n    Note over JF: No checkoutBranch call (differs from other pipelines)\n\n    Note over JF,GH: success/failure/aborted\n    alt success\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'SUCCESSFUL', commitHash)\n    else failure\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'FAILED', commitHash)\n    else aborted\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'STOPPED', commitHash)\n    end\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py\n    Python-&gt;&gt;BB: POST /statuses/build\n    BB--&gt;&gt;Python: OK\n    GH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#observations","title":"Observations","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#delegation-pattern","title":"Delegation Pattern","text":"Pattern Example Count Jenkinsfile \u2192 generalHelper \u2192 External <code>sendBuildStatus</code> \u2192 Python \u2192 Bitbucket API 4 Jenkinsfile \u2192 Docker direct <code>docker.image().inside()</code> \u2192 npm-groovy-lint 2 Jenkinsfile \u2192 Gradle direct <code>gradle test</code> 1 Jenkinsfile \u2192 Groovydoc direct <code>groovydoc</code> 1 Jenkinsfile \u2192 SonarQube direct <code>sonar-scanner</code> 1 Jenkinsfile \u2192 Python direct <code>Lint_groovy_report.py</code> 1"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#ci-pipeline-comparison-dlx-ci-vs-js-ci-vs-jenkins-ci","title":"CI Pipeline Comparison (DLX CI vs JS CI vs Jenkins CI)","text":"Item DLX CI JS CI Jenkins CI Tool Unity CLI Node.js (npm) Gradle + Docker Helper unityHelper jsHelper (none) Trigger OPEN OPEN OPEN + MERGED <code>initializeEnvironment</code> \u2713 \u2713 \u2713 <code>mergeBranchIfNeeded</code> \u2713 \u2713 \u2717 <code>checkoutBranch</code> in Post \u2713 \u2713 \u2717 Linting Bash Script (C#) jsHelper (ESLint) Docker (npm-groovy-lint) Test Type EditMode/PlayMode Jest Spock (Gradle) Code Coverage Unity Code Coverage lcov-report JaCoCo Static Analysis No SonarQube SonarQube Build Project WebGL No No Documentation No No Groovydoc Test Report to Bitbucket \u2713 (Python) \u2713 (Python) \u2717"},{"location":"problem-analysis/pipeline-sequence-diagrams/jenkins-ci/#inconsistencies","title":"Inconsistencies","text":"Issue Description Mixed domain function <code>initializeEnvironment</code> combines Bitbucket + Parsing (SRP violation) No <code>mergeBranchIfNeeded</code> Unlike other CI pipelines, does not merge default branch before build No <code>checkoutBranch</code> in Post Unlike other pipelines, does not return to destination branch after build No test report to Bitbucket Unlike DLX CI and JS CI, does not send test/coverage reports via Python No dedicated Helper Unlike DLX (unityHelper) and JS (jsHelper), no project-specific helper <p>\u2190 JS CD | Domain Mapping Summary \u2192</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/","title":"JS CD Pipeline Sequence Diagrams","text":"<p>Analysis Target: <code>JsJenkins/JenkinsfileDeployment</code> (JavaScript CD Pipeline)</p> <p>Trigger: Runs when PR is <code>MERGED</code></p> <p>Related: Domain Mapping Summary</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#why-sequence-diagrams","title":"Why Sequence Diagrams?","text":"<p>Q: Why use Sequence Diagrams for Jenkins Pipeline analysis?</p> <p>A: Jenkins Pipeline is procedural code. Unlike OOP where classes naturally define domain boundaries, procedural code mixes multiple domains within sequential execution flow. Sequence Diagrams visualize the call flow between components, making it easier to identify which domains are involved at each stage.</p> <p>Q: What is the goal of this analysis?</p> <p>A: To identify domains by function. By tracing \"who calls what\", I can classify each function into its domain (Git, Bitbucket, Unity, etc.) and detect where domain boundaries are violated (e.g., one function mixing multiple domains).</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#domain-summary","title":"Domain Summary","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#helper-domains-used","title":"Helper Domains Used","text":"Helper Domain Functions Called Used Stage generalHelper Git <code>checkoutBranch</code> Post generalHelper Bitbucket <code>getFullCommitHash</code>, <code>sendBuildStatus</code> Prepare WORKSPACE, Post generalHelper SonarQube <code>checkQualityGateStatus</code> Static Analysis generalHelper Parsing <code>parseJson</code> Delete Merged Branch jsHelper Node.js/npm <code>installNpmInTestingDirs</code>, <code>executeLintingInTestingDirs</code>, <code>runUnitTestsInTestingDirs</code>, <code>getPackageJsonVersion</code> Install Dependencies, Linting, Unit Testing, Server/Client Deploy jsHelper File System <code>findTestingDirs</code> Prepare WORKSPACE jsHelper Utility <code>versionCompare</code> Server/Client Deploy"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#jenkinsfile-direct-calls","title":"Jenkinsfile Direct Calls","text":"Domain Direct Call Used Stage Jenkins Pipeline DSL <code>pipeline</code>, <code>stages</code>, <code>post</code>, <code>script</code>, <code>dir</code>, <code>credentials</code>, <code>tool</code>, <code>withSonarQubeEnv</code>, <code>withCredentials</code>, <code>when</code> All Git <code>git clone</code>, <code>git checkout</code>, <code>git reset</code>, <code>git pull</code> Prepare WORKSPACE File System <code>find</code>, <code>rm -rf</code>, <code>mkdir -p</code> Delete Merged Branch, Linting Node.js <code>node -v</code>, <code>npm -v</code>, <code>npm config ls</code> Install Dependencies SonarQube <code>sonar-scanner</code> Static Analysis Docker <code>docker info</code>, <code>docker build</code>, <code>docker push</code>, <code>docker rmi</code> Check Condition, Server/Client Deploy Azure <code>az login</code>, <code>az acr login</code>, <code>az acr repository show-tags</code>, <code>az containerapp update</code> Check Condition, Server/Client Deploy"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#domain-mapping-by-stage","title":"Domain Mapping by Stage","text":"Stage Git Bitbucket Node.js SonarQube Docker Azure Parsing File System Utility Delete Merged Branch \u2713 \u2713 Prepare WORKSPACE \u2713 \u2713 \u2713 Install Dependencies \u2713 Linting \u2713 \u2713 Unit Testing \u2713 Static Analysis \u2713 Check Build Condition \u2713 \u2713 Server Build &amp; Deploy \u2713 \u2713 \u2713 \u2713 Client Build &amp; Deploy \u2713 \u2713 \u2713 \u2713 Post \u2713 \u2713"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#overall-pipeline-overview","title":"Overall Pipeline Overview","text":"<pre><code>flowchart LR\n    subgraph Stages\n        S1[Delete Merged Branch]\n        S2[Prepare WORKSPACE]\n        S3[Install Dependencies]\n        S4[Linting]\n        S5[Unit Testing]\n        S6[Static Analysis]\n        S7[Check Build Condition]\n        S8[Server Build &amp; Deploy]\n        S9[Client Build &amp; Deploy]\n    end\n\n    S1 --&gt; S2 --&gt; S3 --&gt; S4 --&gt; S5 --&gt; S6 --&gt; S7 --&gt; S8 --&gt; S9\n\n    S9 --&gt; Post[Post&lt;br/&gt;always/success/failure/aborted/unstable]</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#stage-1-delete-merged-branch","title":"Stage 1: Delete Merged Branch","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant JSH as jsHelper\n    participant FS as File System\n\n    Note over JF: Stage: Delete Merged Branch\n\n    JF-&gt;&gt;JF: mainBranches.contains(DESTINATION_BRANCH)\n    Note over JF: Abort if not merging to main\n\n    JF-&gt;&gt;GH: load(\"generalHelper.groovy\")\n    JF-&gt;&gt;JSH: load(\"jsHelper.groovy\")\n\n    JF-&gt;&gt;GH: parseJson()\n    Note over GH: Domain: Parsing\n    GH--&gt;&gt;JF: buildResults, stageResults\n\n    JF-&gt;&gt;FS: find ../ -type d -name \"{PR_BRANCH}\"\n    Note over JF: Jenkinsfile Direct: File System\n    FS--&gt;&gt;JF: branch_path\n\n    alt branch_path exists\n        JF-&gt;&gt;FS: rm -rf {branch_path}\n        JF-&gt;&gt;FS: rm -rf {branch_path}@tmp\n    end\n\n    JF-&gt;&gt;JF: FOLDER_NAME = JOB_NAME.split('/').first()</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#stage-2-prepare-workspace","title":"Stage 2: Prepare WORKSPACE","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant JSH as jsHelper\n    participant Git as Git CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Stage: Prepare WORKSPACE\n\n    JF-&gt;&gt;GH: getFullCommitHash(workspace, PR_COMMIT)\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: get_bitbucket_commit_hash.py\n    Python-&gt;&gt;BB: GET /commits\n    BB--&gt;&gt;Python: commit hash\n    Python--&gt;&gt;GH: full commit hash\n    GH--&gt;&gt;JF: COMMIT_HASH\n\n    Note over JF,Git: Jenkinsfile Direct Git Calls\n    alt !fileExists(PROJECT_DIR)\n        JF-&gt;&gt;Git: git clone {REPO_SSH} {PROJECT_DIR}\n    end\n\n    JF-&gt;&gt;Git: git checkout {DESTINATION_BRANCH}\n    JF-&gt;&gt;Git: git reset --hard HEAD\n    JF-&gt;&gt;Git: git pull\n\n    JF-&gt;&gt;GH: sendBuildStatus(workspace, 'INPROGRESS', commitHash, true)\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py -d\n    Python-&gt;&gt;BB: POST /statuses/build\n    BB--&gt;&gt;Python: OK\n\n    JF-&gt;&gt;JSH: findTestingDirs(PROJECT_DIR)\n    Note over JSH: Domain: File System\n    JSH--&gt;&gt;JF: TEST_DIRECTORIES</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#stage-3-install-dependencies","title":"Stage 3: Install Dependencies","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant JSH as jsHelper\n    participant NPM as npm CLI\n\n    Note over JF: Stage: Install Dependencies\n\n    JF-&gt;&gt;NPM: node -v\n    Note over JF: Jenkinsfile Direct: Node.js\n    JF-&gt;&gt;NPM: npm -v\n    JF-&gt;&gt;NPM: npm config ls\n\n    JF-&gt;&gt;JSH: installNpmInTestingDirs(TEST_DIRECTORIES)\n    Note over JSH: Domain: Node.js/npm\n    loop for each testDir\n        JSH-&gt;&gt;NPM: npm audit\n        JSH-&gt;&gt;NPM: npm install\n        NPM--&gt;&gt;JSH: OK\n    end\n    JSH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#stage-4-linting","title":"Stage 4: Linting","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant FS as File System\n    participant JSH as jsHelper\n    participant NPM as npm CLI\n\n    Note over JF: Stage: Linting\n\n    JF-&gt;&gt;FS: mkdir -p linting_results\n    Note over JF: Jenkinsfile Direct: File System\n\n    JF-&gt;&gt;JSH: executeLintingInTestingDirs(TEST_DIRECTORIES, false)\n    Note over JSH: Domain: Node.js/npm\n    loop for each testDir\n        JSH-&gt;&gt;NPM: npm run lint\n        NPM--&gt;&gt;JSH: exitCode\n    end\n    JSH--&gt;&gt;JF: OK/FAIL</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#stage-5-unit-testing","title":"Stage 5: Unit Testing","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant JSH as jsHelper\n    participant NPM as npm CLI\n\n    Note over JF: Stage: Unit Testing\n\n    JF-&gt;&gt;JSH: runUnitTestsInTestingDirs(TEST_DIRECTORIES, false)\n    Note over JSH: Domain: Node.js/npm\n    loop for each testDir\n        JSH-&gt;&gt;NPM: npm test\n        NPM--&gt;&gt;JSH: exitCode\n    end\n    JSH--&gt;&gt;JF: OK/FAIL</code></pre> <p>Note: In JS CD, Coverage Report is not sent to Bitbucket (differs from CI)</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#stage-6-static-analysis","title":"Stage 6: Static Analysis","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant SQ as SonarQube\n\n    Note over JF: Stage: Static Analysis\n\n    JF-&gt;&gt;SQ: sonar-scanner -Dsonar.projectKey={key} -Dsonar.sources=.\n    Note over JF: Jenkinsfile Direct: SonarQube\n    SQ--&gt;&gt;JF: analysis queued\n\n    JF-&gt;&gt;GH: checkQualityGateStatus(SONAR_PROJECT_KEY, token)\n    Note over GH: Domain: SonarQube\n    loop retry (max 5)\n        GH-&gt;&gt;SQ: GET /api/ce/component\n        SQ--&gt;&gt;GH: queue status\n        alt queue not empty\n            GH-&gt;&gt;GH: sleep(10)\n        else queue empty\n            GH-&gt;&gt;SQ: GET /api/qualitygates/project_status\n            SQ--&gt;&gt;GH: entireCodeStatus, newCodeStatus\n        end\n    end\n    GH--&gt;&gt;JF: PASSED/FAILED\n\n    alt status != OK\n        Note over JF: catchError - stage FAILURE\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#stage-7-check-build-and-deploy-condition","title":"Stage 7: Check Build and Deploy Condition","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant Docker as Docker CLI\n    participant AZ as Azure CLI\n\n    Note over JF: Stage: Check Build and Deploy Condition\n    Note over JF: Jenkinsfile Direct: Docker + Azure\n\n    JF-&gt;&gt;Docker: sudo docker info\n    Docker--&gt;&gt;JF: OK/FAIL\n    Note over JF: Error if Docker not running\n\n    JF-&gt;&gt;AZ: sudo az login --identity\n    AZ--&gt;&gt;JF: OK\n\n    JF-&gt;&gt;AZ: sudo az acr login --name webbuilds\n    AZ--&gt;&gt;JF: OK/FAIL\n    Note over JF: Error if ACR login failed</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#stage-8-server-build-and-deploy","title":"Stage 8: Server Build and Deploy","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant JSH as jsHelper\n    participant AZ as Azure CLI\n    participant Docker as Docker CLI\n    participant ACR as Azure Container Registry\n\n    Note over JF: Stage: Server Build and Deploy\n    Note over JF: when: params.SERVER_SOURCE_FOLDER exists\n\n    JF-&gt;&gt;AZ: sudo az acr repository show-tags --name webbuilds --repository {SERVER_CONTAINER_NAME}\n    Note over JF: Jenkinsfile Direct: Azure\n    AZ--&gt;&gt;JF: server_latest_version\n\n    JF-&gt;&gt;JSH: getPackageJsonVersion()\n    Note over JSH: Domain: Node.js/npm\n    JSH--&gt;&gt;JF: project_server_version\n\n    JF-&gt;&gt;JSH: versionCompare(server_latest_version, project_server_version)\n    Note over JSH: Domain: Utility\n    JSH--&gt;&gt;JF: true/false\n\n    alt version is newer\n        JF-&gt;&gt;Docker: sudo docker build -t {ACR}/{SERVER_CONTAINER_NAME}:{version}\n        Note over JF: Jenkinsfile Direct: Docker\n        Docker--&gt;&gt;JF: image built\n\n        JF-&gt;&gt;Docker: sudo docker push {ACR}/{SERVER_CONTAINER_NAME}:{version}\n        Docker-&gt;&gt;ACR: push image\n        ACR--&gt;&gt;Docker: OK\n\n        JF-&gt;&gt;AZ: sudo az containerapp update --name {SERVER_CONTAINER_NAME} --image {version}\n        Note over JF: Jenkinsfile Direct: Azure\n        AZ--&gt;&gt;JF: OK\n\n        JF-&gt;&gt;Docker: sudo docker rmi {image}\n        Docker--&gt;&gt;JF: image removed\n    else version not newer\n        Note over JF: UNSTABLE - Skip deployment\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#stage-9-client-build-and-deploy","title":"Stage 9: Client Build and Deploy","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant JSH as jsHelper\n    participant AZ as Azure CLI\n    participant Docker as Docker CLI\n    participant ACR as Azure Container Registry\n\n    Note over JF: Stage: Client Build and Deploy\n    Note over JF: when: params.CLIENT_SOURCE_FOLDER exists\n\n    JF-&gt;&gt;AZ: sudo az acr repository show-tags --name webbuilds --repository {CLIENT_CONTAINER_NAME}\n    Note over JF: Jenkinsfile Direct: Azure\n    AZ--&gt;&gt;JF: client_latest_version\n\n    JF-&gt;&gt;JSH: getPackageJsonVersion()\n    Note over JSH: Domain: Node.js/npm\n    JSH--&gt;&gt;JF: project_client_version\n\n    JF-&gt;&gt;JSH: versionCompare(client_latest_version, project_client_version)\n    Note over JSH: Domain: Utility\n    JSH--&gt;&gt;JF: true/false\n\n    alt version is newer\n        JF-&gt;&gt;Docker: sudo docker build -t {ACR}/{CLIENT_CONTAINER_NAME}:{version}\n        Note over JF: Jenkinsfile Direct: Docker\n        Docker--&gt;&gt;JF: image built\n\n        JF-&gt;&gt;Docker: sudo docker push {ACR}/{CLIENT_CONTAINER_NAME}:{version}\n        Docker-&gt;&gt;ACR: push image\n        ACR--&gt;&gt;Docker: OK\n\n        JF-&gt;&gt;AZ: sudo az containerapp update --name {CLIENT_CONTAINER_NAME} --image {version}\n        Note over JF: Jenkinsfile Direct: Azure\n        AZ--&gt;&gt;JF: OK\n\n        JF-&gt;&gt;Docker: sudo docker rmi {image}\n        Docker--&gt;&gt;JF: image removed\n    else version not newer\n        Note over JF: UNSTABLE - Skip deployment\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#post-alwayssuccessfailureabortedunstable","title":"Post: always/success/failure/aborted/unstable","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant Git as Git CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Post: always/success/failure/aborted/unstable\n\n    Note over JF,GH: always block\n    JF-&gt;&gt;JF: currentBuild.description = PR_BRANCH\n    JF-&gt;&gt;GH: checkoutBranch(PROJECT_DIR, DESTINATION_BRANCH)\n    Note over GH: Domain: Git\n    GH-&gt;&gt;Git: git reset --hard\n    GH-&gt;&gt;Git: git clean -fd\n    GH-&gt;&gt;Git: git checkout {destination}\n    GH-&gt;&gt;Git: git reset --hard origin/{destination}\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n\n    Note over JF,GH: success/failure/aborted/unstable\n    alt success\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'SUCCESSFUL', commitHash, true)\n    else failure\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'FAILED', commitHash, true)\n    else aborted\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'STOPPED', commitHash, true)\n    else unstable\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'SUCCESSFUL', commitHash, true)\n    end\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py -d\n    Python-&gt;&gt;BB: POST /statuses/build\n    BB--&gt;&gt;Python: OK\n    GH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#observations","title":"Observations","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#delegation-pattern","title":"Delegation Pattern","text":"Pattern Example Count Jenkinsfile \u2192 generalHelper \u2192 External <code>sendBuildStatus</code> \u2192 Python \u2192 Bitbucket API 3 Jenkinsfile \u2192 jsHelper \u2192 External <code>installNpmInTestingDirs</code> \u2192 npm CLI 4 Jenkinsfile \u2192 jsHelper (Utility) <code>versionCompare</code> 2 Jenkinsfile \u2192 Git direct <code>git clone</code>, <code>git checkout</code>, <code>git pull</code> 4 Jenkinsfile \u2192 Docker direct <code>docker build</code>, <code>docker push</code>, <code>docker rmi</code> 8 Jenkinsfile \u2192 Azure direct <code>az login</code>, <code>az acr</code>, <code>az containerapp</code> 8 Jenkinsfile \u2192 SonarQube direct <code>sonar-scanner</code> 1 Jenkinsfile \u2192 File System direct <code>find</code>, <code>rm -rf</code>, <code>mkdir</code> 4"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#js-ci-vs-js-cd-comparison","title":"JS CI vs JS CD Comparison","text":"Item JS CI JS CD Trigger <code>OPEN</code> (PR created) <code>MERGED</code> (PR merged) <code>CI_PIPELINE</code> <code>true</code> <code>false</code> <code>initializeEnvironment</code> \u2713 \u2717 (\uc9c1\uc811 \ud638\ucd9c) Coverage Report Send Yes No Web Server Deploy Yes (lcov-report) No Docker Build No Yes Azure Deploy No Yes (Container App) Delete Merged Branch No Yes"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-cd/#inconsistencies","title":"Inconsistencies","text":"Issue Description No <code>initializeEnvironment</code> CD calls <code>sendBuildStatus</code> directly instead of using mixed function Mixed Git delegation Post uses <code>checkoutBranch</code>, but Prepare WORKSPACE uses direct Git commands Heavy Jenkinsfile direct calls Docker (8), Azure (8), File System (4) - no Helper abstraction No Web Server Helper usage Unlike DLX CD, no deployment to web server via generalHelper <p>\u2190 JS CI | Domain Mapping Summary \u2192</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/","title":"JS CI Pipeline Sequence Diagrams","text":"<p>Analysis Target: <code>JsJenkins/Jenkinsfile</code> (JavaScript CI Pipeline)</p> <p>Trigger: Runs when PR is <code>OPEN</code></p> <p>Related: Domain Mapping Summary</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#why-sequence-diagrams","title":"Why Sequence Diagrams?","text":"<p>Q: Why use Sequence Diagrams for Jenkins Pipeline analysis?</p> <p>A: Jenkins Pipeline is procedural code. Unlike OOP where classes naturally define domain boundaries, procedural code mixes multiple domains within sequential execution flow. Sequence Diagrams visualize the call flow between components, making it easier to identify which domains are involved at each stage.</p> <p>Q: What is the goal of this analysis?</p> <p>A: To identify domains by function. By tracing \"who calls what\", I can classify each function into its domain (Git, Bitbucket, Unity, etc.) and detect where domain boundaries are violated (e.g., one function mixing multiple domains).</p>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#domain-summary","title":"Domain Summary","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#helper-domains-used","title":"Helper Domains Used","text":"Helper Domain Functions Called Used Stage generalHelper Git <code>cloneOrUpdateRepo</code>, <code>mergeBranchIfNeeded</code>, <code>isBranchUpToDateWithRemote</code>, <code>checkoutBranch</code> Prepare WORKSPACE, Post generalHelper Bitbucket <code>getFullCommitHash</code>, <code>sendBuildStatus</code> Prepare WORKSPACE, Post generalHelper Web Server <code>publishTestResultsHtmlToWebServer</code> Unit Testing generalHelper SonarQube <code>checkQualityGateStatus</code> Static Analysis generalHelper Parsing <code>parseJson</code> Prepare WORKSPACE generalHelper Mixed (Bitbucket + Parsing) <code>initializeEnvironment</code> Prepare WORKSPACE jsHelper Node.js/npm <code>checkNodeVersion</code>, <code>installNpmInTestingDirs</code>, <code>executeLintingInTestingDirs</code>, <code>runUnitTestsInTestingDirs</code> Install Dependencies, Linting, Unit Testing jsHelper File System <code>findTestingDirs</code>, <code>retrieveReportSummaryDirs</code> Prepare WORKSPACE, Unit Testing"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#jenkinsfile-direct-calls","title":"Jenkinsfile Direct Calls","text":"Domain Direct Call Used Stage Jenkins Pipeline DSL <code>pipeline</code>, <code>stages</code>, <code>post</code>, <code>script</code>, <code>dir</code>, <code>credentials</code>, <code>tool</code>, <code>withSonarQubeEnv</code>, <code>withCredentials</code> All File System <code>mkdir -p</code> Linting SonarQube <code>sonar-scanner</code> Static Analysis Bitbucket (Python) <code>create_bitbucket_coverage_report.py</code> Unit Testing"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#domain-mapping-by-stage","title":"Domain Mapping by Stage","text":"Stage Git Bitbucket Node.js Web Server SonarQube Parsing File System Prepare WORKSPACE \u2713 \u2713 \u2713 \u2713 Install Dependencies \u2713 Linting \u2713 \u2713 Unit Testing \u2713 \u2713 \u2713 \u2713 Static Analysis \u2713 Post \u2713 \u2713"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#overall-pipeline-overview","title":"Overall Pipeline Overview","text":"<pre><code>flowchart LR\n    subgraph Stages\n        S1[Prepare WORKSPACE]\n        S2[Install Dependencies]\n        S3[Linting]\n        S4[Unit Testing]\n        S5[Static Analysis]\n    end\n\n    S1 --&gt; S2 --&gt; S3 --&gt; S4 --&gt; S5\n\n    S5 --&gt; Post[Post&lt;br/&gt;always/success/failure/aborted]</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#stage-1-prepare-workspace","title":"Stage 1: Prepare WORKSPACE","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant JSH as jsHelper\n    participant Git as Git CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Stage: Prepare WORKSPACE\n\n    JF-&gt;&gt;JF: sh 'env' (print environment variables)\n    JF-&gt;&gt;GH: load(\"generalHelper.groovy\")\n    JF-&gt;&gt;JSH: load(\"jsHelper.groovy\")\n\n    JF-&gt;&gt;GH: parseJson()\n    Note over GH: Domain: Parsing\n    GH--&gt;&gt;JF: buildResults, stageResults\n\n    JF-&gt;&gt;GH: isBranchUpToDateWithRemote(PR_BRANCH)\n    Note over GH: Domain: Git\n    GH-&gt;&gt;Git: git fetch origin\n    GH-&gt;&gt;Git: git rev-parse HEAD\n    GH-&gt;&gt;Git: git rev-parse origin/{branch}\n    Git--&gt;&gt;GH: commit hashes\n    GH--&gt;&gt;JF: true/false\n\n    JF-&gt;&gt;GH: getFullCommitHash(workspace, PR_COMMIT)\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: get_bitbucket_commit_hash.py\n    Python-&gt;&gt;BB: GET /commits\n    BB--&gt;&gt;Python: commit hash\n    Python--&gt;&gt;GH: full commit hash\n    GH--&gt;&gt;JF: COMMIT_HASH\n\n    JF-&gt;&gt;GH: initializeEnvironment(workspace, commitHash, prBranch)\n    Note over GH: Mixed: Bitbucket + Parsing\n    GH-&gt;&gt;GH: sendBuildStatus('INPROGRESS')\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py\n    Python-&gt;&gt;BB: POST /statuses/build\n    GH-&gt;&gt;GH: parseTicketNumber(prBranch)\n    GH--&gt;&gt;JF: TICKET_NUMBER, FOLDER_NAME\n\n    JF-&gt;&gt;GH: cloneOrUpdateRepo(workspace, projectDir, prBranch)\n    Note over GH: Domain: Git\n    GH-&gt;&gt;Git: git clone / git fetch\n    GH-&gt;&gt;Git: git checkout\n    GH-&gt;&gt;Git: git reset --hard\n    GH-&gt;&gt;Git: git clean -fd\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n\n    JF-&gt;&gt;GH: mergeBranchIfNeeded(prBranch)\n    Note over GH: Domain: Git\n    GH-&gt;&gt;GH: getDefaultBranch()\n    GH-&gt;&gt;Git: git remote show origin\n    Git--&gt;&gt;GH: default branch\n    GH-&gt;&gt;GH: isBranchUpToDateWithMain()\n    GH-&gt;&gt;Git: git merge-base --is-ancestor\n    GH-&gt;&gt;GH: tryMerge(defaultBranch)\n    GH-&gt;&gt;Git: git merge origin/{default}\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n\n    JF-&gt;&gt;JSH: findTestingDirs(PROJECT_DIR)\n    Note over JSH: Domain: File System\n    JSH--&gt;&gt;JF: TEST_DIRECTORIES</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#stage-2-install-dependencies","title":"Stage 2: Install Dependencies","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant JSH as jsHelper\n    participant NPM as npm CLI\n\n    Note over JF: Stage: Install Dependencies\n\n    JF-&gt;&gt;JSH: checkNodeVersion()\n    Note over JSH: Domain: Node.js/npm\n    JSH-&gt;&gt;NPM: node -v\n    NPM--&gt;&gt;JSH: version\n    JSH-&gt;&gt;NPM: npm -v\n    NPM--&gt;&gt;JSH: version\n\n    JF-&gt;&gt;JSH: installNpmInTestingDirs(TEST_DIRECTORIES)\n    Note over JSH: Domain: Node.js/npm\n    loop for each testDir\n        JSH-&gt;&gt;NPM: npm audit\n        JSH-&gt;&gt;NPM: npm install\n        NPM--&gt;&gt;JSH: OK\n    end\n    JSH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#stage-3-linting","title":"Stage 3: Linting","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant FS as File System\n    participant JSH as jsHelper\n    participant NPM as npm CLI\n\n    Note over JF: Stage: Linting\n\n    JF-&gt;&gt;FS: mkdir -p linting_results\n\n    JF-&gt;&gt;JSH: executeLintingInTestingDirs(TEST_DIRECTORIES, false)\n    Note over JSH: Domain: Node.js/npm\n    loop for each testDir\n        JSH-&gt;&gt;NPM: npm run lint\n        NPM--&gt;&gt;JSH: exitCode\n    end\n    JSH--&gt;&gt;JF: OK/FAIL</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#stage-4-unit-testing","title":"Stage 4: Unit Testing","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant JSH as jsHelper\n    participant NPM as npm CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n    participant WS as Web Server&lt;br/&gt;(SSH/SCP)\n\n    Note over JF: Stage: Unit Testing\n\n    JF-&gt;&gt;JSH: runUnitTestsInTestingDirs(TEST_DIRECTORIES, false)\n    Note over JSH: Domain: Node.js/npm\n    loop for each testDir\n        JSH-&gt;&gt;NPM: npm test\n        NPM--&gt;&gt;JSH: coverage-summary.json, test-results.json\n    end\n    JSH--&gt;&gt;JF: OK/FAIL\n\n    Note over JF,WS: Publish coverage HTML to Web Server\n    JF-&gt;&gt;GH: publishTestResultsHtmlToWebServer(FOLDER_NAME, TICKET_NUMBER, lcov-report, 'server')\n    Note over GH: Domain: Web Server\n    GH-&gt;&gt;WS: ssh mkdir -p /var/www/html/{folder}/{ticket}/server\n    GH-&gt;&gt;WS: scp -r lcov-report/*\n    WS--&gt;&gt;GH: OK\n\n    JF-&gt;&gt;GH: publishTestResultsHtmlToWebServer(FOLDER_NAME, TICKET_NUMBER, lcov-report, 'client')\n    GH-&gt;&gt;WS: ssh mkdir -p /var/www/html/{folder}/{ticket}/client\n    GH-&gt;&gt;WS: scp -r lcov-report/*\n    WS--&gt;&gt;GH: OK\n\n    Note over JF,BB: Send coverage reports to Bitbucket\n    alt params.SERVER_SOURCE_FOLDER exists\n        JF-&gt;&gt;JSH: retrieveReportSummaryDirs(serverDir)\n        Note over JSH: Domain: File System\n        JSH--&gt;&gt;JF: coverageSummaryDir, testSummaryDir\n        JF-&gt;&gt;Python: create_bitbucket_coverage_report.py --server\n        Note over JF: Jenkinsfile Direct: Bitbucket (Python)\n        Python-&gt;&gt;BB: POST /reports\n        BB--&gt;&gt;Python: OK\n    end\n\n    alt params.CLIENT_SOURCE_FOLDER exists\n        JF-&gt;&gt;JSH: retrieveReportSummaryDirs(clientDir)\n        JSH--&gt;&gt;JF: coverageSummaryDir, testSummaryDir\n        JF-&gt;&gt;Python: create_bitbucket_coverage_report.py --client\n        Python-&gt;&gt;BB: POST /reports\n        BB--&gt;&gt;Python: OK\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#stage-5-static-analysis","title":"Stage 5: Static Analysis","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant SQ as SonarQube\n\n    Note over JF: Stage: Static Analysis\n\n    JF-&gt;&gt;SQ: sonar-scanner -Dsonar.projectKey={key} -Dsonar.sources=.\n    Note over JF: Jenkinsfile Direct: SonarQube\n    SQ--&gt;&gt;JF: analysis queued\n\n    JF-&gt;&gt;GH: checkQualityGateStatus(SONAR_PROJECT_KEY, token)\n    Note over GH: Domain: SonarQube\n    loop retry (max 5)\n        GH-&gt;&gt;SQ: GET /api/ce/component\n        SQ--&gt;&gt;GH: queue status\n        alt queue not empty\n            GH-&gt;&gt;GH: sleep(10)\n        else queue empty\n            GH-&gt;&gt;SQ: GET /api/qualitygates/project_status\n            SQ--&gt;&gt;GH: entireCodeStatus, newCodeStatus\n        end\n    end\n    GH--&gt;&gt;JF: PASSED/FAILED\n\n    alt status != OK\n        Note over JF: catchError - stage FAILURE\n    end</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#post-alwayssuccessfailureaborted","title":"Post: always/success/failure/aborted","text":"<pre><code>sequenceDiagram\n    autonumber\n\n    participant JF as Jenkinsfile&lt;br/&gt;(Orchestrator)\n    participant GH as generalHelper\n    participant Git as Git CLI\n    participant Python as Python Scripts\n    participant BB as Bitbucket API\n\n    Note over JF: Post: always/success/failure/aborted\n\n    Note over JF,GH: always block\n    JF-&gt;&gt;JF: currentBuild.description = PR_BRANCH\n    JF-&gt;&gt;GH: checkoutBranch(PROJECT_DIR, DESTINATION_BRANCH)\n    Note over GH: Domain: Git\n    GH-&gt;&gt;Git: git reset --hard\n    GH-&gt;&gt;Git: git clean -fd\n    GH-&gt;&gt;Git: git checkout {destination}\n    GH-&gt;&gt;Git: git reset --hard origin/{destination}\n    Git--&gt;&gt;GH: OK\n    GH--&gt;&gt;JF: OK\n\n    Note over JF,GH: success/failure/aborted\n    alt success\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'SUCCESSFUL', commitHash, false)\n    else failure\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'FAILED', commitHash, false)\n    else aborted\n        JF-&gt;&gt;GH: sendBuildStatus(workspace, 'STOPPED', commitHash, false)\n    end\n    Note over GH: Domain: Bitbucket\n    GH-&gt;&gt;Python: send_bitbucket_build_status.py\n    Python-&gt;&gt;BB: POST /statuses/build\n    BB--&gt;&gt;Python: OK\n    GH--&gt;&gt;JF: OK</code></pre>"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#observations","title":"Observations","text":""},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#delegation-pattern","title":"Delegation Pattern","text":"Pattern Example Count Jenkinsfile \u2192 generalHelper \u2192 External <code>sendBuildStatus</code> \u2192 Python \u2192 Bitbucket API 6 Jenkinsfile \u2192 jsHelper \u2192 External <code>installNpmInTestingDirs</code> \u2192 npm CLI 4 Jenkinsfile \u2192 Python direct <code>create_bitbucket_coverage_report.py</code> 2 Jenkinsfile \u2192 SonarQube direct <code>sonar-scanner</code> 1"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#dlx-ci-vs-js-ci-comparison","title":"DLX CI vs JS CI Comparison","text":"Item DLX CI JS CI Build Tool Unity CLI Node.js (npm) Helper unityHelper jsHelper Install Dependencies No Yes (<code>installNpmInTestingDirs</code>) Linting Bash Script (C#) jsHelper (<code>executeLintingInTestingDirs</code>) Test Type EditMode/PlayMode Jest (<code>runUnitTestsInTestingDirs</code>) Code Coverage Unity Code Coverage lcov-report Static Analysis No SonarQube Build Project WebGL No <code>initializeEnvironment</code> \u2713 \u2713"},{"location":"problem-analysis/pipeline-sequence-diagrams/js-ci/#inconsistencies","title":"Inconsistencies","text":"Issue Description Mixed domain function <code>initializeEnvironment</code> combines Bitbucket + Parsing (SRP violation) Direct Python calls <code>create_bitbucket_coverage_report.py</code> bypasses Helper Direct SonarQube call <code>sonar-scanner</code> called directly, but <code>checkQualityGateStatus</code> via generalHelper <p>\u2190 Domain Mapping Summary | JS CD \u2192</p>"},{"location":"problem-analysis/reference/","title":"Software Smells &amp; Anti-Patterns Taxonomy","text":"<p>This document provides a comprehensive classification of software smells and anti-patterns, organized by category, source/perspective, and specific types. It integrates classic definitions with modern research taxonomies (e.g., Sharma et al., Suryanarayana et al.).</p>"},{"location":"problem-analysis/reference/#summary-table","title":"Summary Table","text":"Category Primary Source / Perspective Scope &amp; Description Code Smell Fowler/Beck (1999) Scope: Intra-class or method level.Focus: Refactoring targets to improve maintainability and readability. Design Smell - Symptoms Robert C. Martin (2000) Scope: Inter-class or component relationships.Focus: Symptom-based: Observable signs of rotting design (Rigidity, Fragility, etc.). Design Smell - Principles Suryanarayana et al. (2014) Scope: Inter-class or component relationships.Focus: Principle-based: Violations of OO principles (Abstraction, Encapsulation, Modularization, Hierarchy). Architecture Smell Garcia et al. (2009), Lippert &amp; Roock, Sharma Scope: System-level structure.Focus: High-level structural issues affecting system evolution, deployment, and scalability. Anti-pattern Brown et al. (1998) Scope: Development, Architecture, and Project Management.Focus: Common solutions to recurring problems that generate negative consequences. Implementation Smell Sharma's Taxonomy Scope: Statement/Method level.Focus: Specific coding constructs that indicate poor implementation choices (subset of code smells). Test Smell Meszaros (xUnit Patterns) &amp; Others Scope: Test Code.Focus: Issues reducing test maintainability, reliability (flakiness), and execution speed. Configuration Smell Sharma's Taxonomy Scope: Configuration Files (IaC, XML, JSON, YAML).Focus: Security risks, deployment fragility, and environmental inconsistencies. Database Smell Sharma's Taxonomy, Arulraj et al. Scope: Database Schema &amp; Queries.Focus: Poor schema design, inefficient queries, and misuse of database features. Performance Smell Various Sources Scope: Runtime Behavior.Focus: Patterns known to degrade system latency, throughput, or resource efficiency. Grammar Smell Sharma's Taxonomy Scope: DSLs &amp; Parsers.Focus: Issues in language grammar definitions affecting parsing efficiency and ambiguity."},{"location":"problem-analysis/reference/#quick-navigation","title":"Quick Navigation","text":"# Category Types Count 1 Code Smells 22 2a Design Smells - Symptoms 7 2b Design Smells - Principles 27 3 Architecture Smells 9 4 Anti-patterns 27 (Dev: 11, Arch: 7, Mgmt: 9) 5 Implementation Smells 10 6 Test Smells 14 7 Configuration Smells 7 8 Database Smells 10 (Schema: 6, Query: 4) 9 Performance Smells 9 10 Grammar Smells 7"},{"location":"problem-analysis/reference/01-code-smells/","title":"01 code smells","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/01-code-smells/#code-smells","title":"Code Smells","text":"<p>Source: Fowler, M. &amp; Beck, K. (1999). Refactoring: Improving the Design of Existing Code</p> <p>Context: Visible signs that code may need refactoring (intra-class or method level).</p> <p>References: - Refactoring.guru Catalog - Code Smells Answer Table (Scribd) - Coding Horror: Code Smells - Industrial Logic: Smells to Refactorings</p>"},{"location":"problem-analysis/reference/01-code-smells/#1-bloaters","title":"1. Bloaters","text":"<p>Code that has grown too large and becomes difficult to work with.</p> Smell Description Long Method A method contains too many lines of code or does too much. Large Class A class has too many fields/methods/lines of code. Long Parameter List A method has too many parameters, making it hard to read/call. Primitive Obsession Using primitives instead of small objects for simple tasks (e.g., currency, ranges). Data Clumps Data items that like to hang around together (e.g., fields, parameters)."},{"location":"problem-analysis/reference/01-code-smells/#2-object-orientation-abusers","title":"2. Object-Orientation Abusers","text":"<p>Incorrect or incomplete application of object-oriented principles.</p> Smell Description Switch Statements Complex switch statements or type codes that should be polymorphism. Parallel Inheritance Hierarchies Every time you make a subclass of one class, you have to make a subclass of another. Temporary Field Instance variables that are set only in certain circumstances. Refused Bequest Subclasses usually use only a little of what their parents give them. Alternative Classes with Different Interfaces Classes that do the same thing but have different method names/signatures."},{"location":"problem-analysis/reference/01-code-smells/#3-change-preventers","title":"3. Change Preventers","text":"<p>Code that makes modifications difficult, requiring changes in many places.</p> Smell Description Divergent Change You have to change the same class in different ways for different reasons. Shotgun Surgery A single change requires making many small changes to many different classes. Parallel Inheritance Hierarchies Every time you make a subclass of one class, you have to make a subclass of another."},{"location":"problem-analysis/reference/01-code-smells/#4-dispensables","title":"4. Dispensables","text":"<p>Code that is unnecessary and should be removed.</p> Smell Description Lazy Class A class that doesn't do enough to justify its existence. Speculative Generality Code created \"just in case\" to support anticipated future features. Data Class Classes that have fields, getters and setters, and nothing else. Duplicated Code Identical or very similar code exists in more than one location. Dead Code Code that is no longer used or executed. Comments Used to hide bad code (the \"deodorant\" for other smells)."},{"location":"problem-analysis/reference/01-code-smells/#5-couplers","title":"5. Couplers","text":"<p>Code that creates excessive coupling between classes.</p> Smell Description Feature Envy A method seems more interested in a class other than the one it is in. Inappropriate Intimacy Classes know too much about each other's private parts. Message Chains A client asks one object for another object, which asks for another, etc. Middle Man A class that delegates all its work to another class. Incomplete Library Class A library class that doesn't provide the functionality you need."},{"location":"problem-analysis/reference/01-code-smells/#classification-notes","title":"Classification Notes","text":"<ul> <li>Parallel Inheritance Hierarchies appears in both Object-Orientation Abusers and Change Preventers as it exhibits characteristics of both categories.</li> <li>Dead Code is sometimes listed separately but is categorized under Dispensables in most references.</li> </ul> <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/02a-design-smells-symptoms/","title":"02a design smells symptoms","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/02a-design-smells-symptoms/#design-smells-symptom-based","title":"Design Smells - Symptom-Based","text":"<ul> <li>Source: Principles and Patterns (Robert C. Martin, 2000)</li> </ul> <p>Context: Observable symptoms that indicate software is rotting - focusing on how design problems manifest rather than which principle is violated.</p> <p>References: * Design Principles and Design Patterns (UTU) * Agile Software Development (Book)</p>"},{"location":"problem-analysis/reference/02a-design-smells-symptoms/#extended-definitions","title":"Extended Definitions","text":"Type Definition Symptom / Criteria Example Rigidity Changing one place requires cascading changes to other places. \"What I thought was a simple change turned out to be much more complex.\" / Higher rigidity = more modules need to be modified. Modifying a parameter block requires changes to all 5 files. Fragility Modifying one place breaks conceptually unrelated places. \"Why does touching this break that?\" / Developers refer to certain code as \"danger zones.\" Modifying a Git function breaks Bitbucket reporting. Immobility Useful parts are difficult to extract and reuse in other systems/modules. Extracting code brings too many other dependencies. / Cost of separation &gt; cost of rewriting. Trying to extract only Git functions from generalHelper, but too many other dependencies. Viscosity Doing the right thing (preserving design) is harder than hacking. \"Doing it properly takes too long, let's just do it this way for now.\" / Maintaining design is more difficult than breaking it. Copy-paste is faster than creating a common function. Needless Complexity Over-engineering for features not currently needed. YAGNI violation / Code exists because \"we might need it later.\" Unused abstraction layers, unused parameters. Needless Repetition Code that could be unified through abstraction is duplicated in multiple places. DRY violation / Similar code exists in slightly different forms across multiple locations. Same post block repeated in 5 pipelines. Opacity Code is hard to understand and intent is unclear. \"What does this code do?\" / Code becomes harder to understand over time. Unclear variable names, no comments, complex logic. <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/02b-design-smells-principles/","title":"02b design smells principles","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/02b-design-smells-principles/#design-smells-principle-based","title":"Design Smells - Principle-Based","text":"<ul> <li>Source: Refactoring for Software Design Smells (Suryanarayana et al., 2014)</li> </ul> <p>Context: Violations of core OO design principles (Abstraction, Encapsulation, Modularization, Hierarchy).</p> <p>References: * Refactoring for Software Design Smells (InfoQ) * Smells in Software Design (ACM) * Design Smells Taxonomy (Tushar Sharma)</p>"},{"location":"problem-analysis/reference/02b-design-smells-principles/#summary-table","title":"Summary Table","text":"Sub-Category Type Description Applied for Jenkins/Procedecual Abstraction Missing Abstraction Concepts are implemented using primitive types or data clumps instead of a dedicated class. O Abstraction Multifaceted Abstraction An abstraction has more than one responsibility (violates SRP). O Abstraction Unnecessary Abstraction An abstraction that is not needed (e.g., essentially empty). O Abstraction Unutilized Abstraction An abstraction that is declared but not used. O Abstraction Duplicate Abstraction Two or more abstractions have identical names or implementation. O Abstraction Imperative Abstraction An abstraction whose operations are procedural rather than object-oriented. - Abstraction Incomplete Abstraction An abstraction that does not support all complementary or expected operations. - Encapsulation Missing Encapsulation Variations are not encapsulated, leading to scattered logic. O Encapsulation Deficient Encapsulation Access modifiers are too permissive (e.g., everything is public). - Encapsulation Leaky Encapsulation An abstraction exposes implementation details through its interface. - Encapsulation Unexploited Encapsulation Client code uses explicit type checks (instanceof) instead of polymorphism. - Modularization Broken Modularization Data and/or methods that should be together are separated. O Modularization Insufficient Modularization An abstraction is too large or complex (e.g., God Class). O Modularization Cyclically-Dependent Modularization Two or more abstractions depend on each other directly or indirectly. O Modularization Hub-like Modularization An abstraction has dependencies with a large number of other abstractions. O Hierarchy Missing Hierarchy Use of conditional logic (if/else) instead of inheritance/polymorphism. - Hierarchy Unnecessary Hierarchy Inheritance is used where composition would be better, or no hierarchy is needed. - Hierarchy Unfactored Hierarchy Duplicate code exists among siblings in a hierarchy. - Hierarchy Wide Hierarchy A class has an excessive number of subclasses. - Hierarchy Speculative Hierarchy Hierarchy defined for future use that does not currently exist. - Hierarchy Deep Hierarchy Excessive inheritance levels (inheritance depth &gt; threshold). - Hierarchy Rebellious Hierarchy A subclass rejects the contract of its superclass. - Hierarchy Broken Hierarchy The superclass and subclass relationship is not \"is-a\". - Hierarchy Multipath Hierarchy A subclass inherits from a superclass through multiple paths (Diamond problem). - Hierarchy Cyclic Hierarchy A superclass depends on one of its subclasses. - <p>Note: This book assumes OOP-based design. Jenkins Pipeline (Groovy scripts) is procedural code without class/inheritance structures, so Hierarchy Smells and some Encapsulation Smells are not applicable. However, Abstraction and Modularization concepts can be interpreted at the file/function level.</p>"},{"location":"problem-analysis/reference/02b-design-smells-principles/#jenkinsprocedural-application-examples","title":"Jenkins/Procedural Application Examples","text":"Sub-Category Type Jenkins/Procedural Application Abstraction Missing Abstraction Constants/settings hardcoded instead of abstracted into variables or config Abstraction Multifaceted Abstraction Module/file/function has multiple responsibilities Abstraction Unnecessary Abstraction Unnecessary function/file separation Abstraction Unutilized Abstraction Declared but unused functions Abstraction Duplicate Abstraction Duplicate implementations across files Encapsulation Missing Encapsulation Variations scattered without encapsulation (e.g., same pattern repeated) Modularization Broken Modularization Functions that should be together are separated across files Modularization Insufficient Modularization File/module is too large (God File) Modularization Cyclically-Dependent Modularization Circular dependencies between helper files Modularization Hub-like Modularization One module has too many dependencies (e.g., generalHelper used by 5 pipelines) <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/03-architecture-smells/","title":"03 architecture smells","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/03-architecture-smells/#architecture-smells","title":"Architecture Smells","text":"<ul> <li>Source: Garcia et al., Lippert &amp; Roock, Sharma</li> </ul> <p>Context: System-level structural issues affecting maintainability, evolution, and deployment.</p> <p>References: * Architecture Smells (T. Sharma Preprint) * Does your Architecture Smell? (Designite) * Architectural Technical Debt Identification (Uni-Hamburg) * Architecture Smells Impact Analysis (DiVA Portal)</p>"},{"location":"problem-analysis/reference/03-architecture-smells/#summary-table-issue-type","title":"Summary Table (Issue Type)","text":"Type Description Dependency Issues Cyclic Dependency, Unstable Dependency, Hub-like Dependency (God Component), Implicit Cross-module Dependency. Structure Issues Scattered Functionality, Ambiguous Interface, Connector Envy, Extraneous Connector, Dense Structure."},{"location":"problem-analysis/reference/03-architecture-smells/#by-source","title":"By Source","text":""},{"location":"problem-analysis/reference/03-architecture-smells/#garcia-et-al-connectorcomponent-perspective","title":"Garcia et al. (Connector/Component Perspective)","text":"Type Issue Type Description Connector Envy Structure Components handle communication/connection logic that should be in a dedicated connector. Extraneous Connector Structure Two components communicate through a connector when a direct call would suffice. Ambiguous Interface Structure The interface of a component offers only a single, overly general entry point (e.g., <code>execute(Map params)</code>)."},{"location":"problem-analysis/reference/03-architecture-smells/#lippert-roock-symptom-based","title":"Lippert &amp; Roock (Symptom-Based)","text":"Type Issue Type Description Cyclic Dependency Dependency Components/Packages form a dependency cycle. Unstable Dependency Dependency A stable component depends on a less stable component."},{"location":"problem-analysis/reference/03-architecture-smells/#sharma-dependency-perspective","title":"Sharma (Dependency Perspective)","text":"Type Issue Type Description Hub-like Dependency (God Component) Dependency A component that is central to the system, with too many incoming/outgoing dependencies. Scattered Functionality Structure A single concern is implemented across multiple components. Dense Structure Structure The dependency graph is too dense (high average degree). Implicit Cross-module Dependency Dependency Hidden dependencies not visible in the architecture (e.g., shared database tables). <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/04-anti-patterns/","title":"04 anti patterns","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/04-anti-patterns/#anti-patterns","title":"Anti-patterns","text":"<ul> <li>Source: Brown et al. (1998)</li> </ul> <p>Context: Recurring \"solutions\" that generate negative consequences (Development, Architecture, Management).</p> <p>References: * AntiPatterns: Refactoring Software, Architectures, and Projects in Crisis (UVIC Lecture) * Software Engineering Management Anti-patterns (UVIC)</p> Sub-Category Types Development The Blob, Lava Flow, Functional Decomposition, Poltergeists, Boat Anchor, Golden Hammer, Dead End, Spaghetti Code, Input Kludge, Walking through a Minefield, Cut-and-Paste. Architecture Vendor Lock-in, Stovepipe Enterprise, Stovepipe System, Swiss Army Knife, Design by Committee, Reinventing the Wheel, Cover Your Assets. Management Death March, Analysis Paralysis, Viewgraph Engineering, Mushroom Management, Intellectual Violence, Fire Drill, The Feud, Email is Dangerous, Throw it over the Wall."},{"location":"problem-analysis/reference/04-anti-patterns/#development-anti-patterns","title":"Development Anti-patterns","text":"<ul> <li>The Blob: A God Class that monopolizes processing; other classes are just data holders.</li> <li>Lava Flow: Dead code or design artifacts that persist because no one remembers what they do or fears deleting them.</li> <li>Functional Decomposition: Designing OO software as a series of main routines and subroutines.</li> <li>Poltergeists: Short-lived objects that exist only to invoke methods in other classes.</li> <li>Boat Anchor: Code left in the system \"just in case\" it's needed later (but never is).</li> <li>Golden Hammer: Using a familiar technology/solution for every problem, regardless of suitability.</li> <li>Dead End: Reaching a point where a chosen technology or design prevents further progress.</li> <li>Spaghetti Code: Unstructured, difficult-to-follow control flow.</li> <li>Input Kludge: Ad-hoc handling of user input without proper validation or parsing.</li> <li>Walking through a Minefield: Using a technology that is buggy or poorly supported.</li> <li>Cut-and-Paste Programming: Reusing code by copying it rather than abstracting it.</li> </ul>"},{"location":"problem-analysis/reference/04-anti-patterns/#architecture-anti-patterns","title":"Architecture Anti-patterns","text":"<ul> <li>Vendor Lock-in: Architecture heavily dependent on a specific vendor's proprietary features.</li> <li>Stovepipe Enterprise: Islands of automation; systems within an organization cannot interoperate.</li> <li>Stovepipe System: A system with ad-hoc integration, making it hard to maintain or modify.</li> <li>Swiss Army Knife: A component that attempts to do too many unrelated things.</li> <li>Design by Committee: A complex design resulting from satisfying too many stakeholders' conflicting views.</li> <li>Reinventing the Wheel: Building custom solutions for problems already solved by standard libraries/products.</li> <li>Cover Your Assets: Architecture decisions driven by risk avoidance rather than technical merit.</li> </ul>"},{"location":"problem-analysis/reference/04-anti-patterns/#management-anti-patterns","title":"Management Anti-patterns","text":"<ul> <li>Death March: A project with impossible deadlines or constraints, doomed to fail.</li> <li>Analysis Paralysis: Spending too much time in the analysis phase, delaying implementation.</li> <li>Viewgraph Engineering: Relying on slides/diagrams rather than working software to track progress.</li> <li>Mushroom Management: Keeping developers in the dark and \"feeding them manure\" (lack of communication).</li> <li>Intellectual Violence: Using intimidation or arrogance to suppress technical dissent.</li> <li>Fire Drill: Constant shifting of priorities, treating everything as an emergency.</li> <li>The Feud: Inter-team or interpersonal conflict impeding progress.</li> <li>Email is Dangerous: Misusing email for sensitive or complex communications that require nuance.</li> <li>Throw it over the Wall: Passing work to the next team (e.g., Dev to QA) without communication or ownership.</li> </ul> <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/05-implementation-smells/","title":"05 implementation smells","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/05-implementation-smells/#implementation-smells","title":"Implementation Smells","text":"<ul> <li>Source: Sharma's Taxonomy</li> </ul> <p>Context: Statement/Method level constructs indicating poor implementation.</p> <p>References: * IJMEMS: Code Smell Detection &amp; Classification * Luzkan's Smell Catalog</p> Type Description Logic/Flow Magic Number, Magic String, Complex Condition, Empty Catch Block, Long Statement, Deeply Nested Code, Missing Default in Switch. Organization Hardcoded Reference, Duplicate String Literal, Unused Import/Variable."},{"location":"problem-analysis/reference/05-implementation-smells/#detailed-descriptions","title":"Detailed Descriptions","text":"<ul> <li>Magic Number: Unexplained numeric literals in code.</li> <li>Magic String: Unexplained string literals in code.</li> <li>Complex Condition: Overly complicated boolean expressions in <code>if/while</code>.</li> <li>Empty Catch Block: Catching an exception and doing nothing (swallowing errors).</li> <li>Long Statement: A single line of code that is excessively long or complex.</li> <li>Deeply Nested Code: Excessive nesting of loops and conditionals (Arrow Anti-pattern).</li> <li>Missing Default in Switch: Switch statements that do not handle the default case.</li> <li>Hardcoded Reference: Hardcoding paths or URLs.</li> <li>Duplicate String Literal: Using the same string literal multiple times without a constant.</li> <li>Unused Import/Variable: Cluttering code with unnecessary declarations.</li> </ul> <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/06-test-smells/","title":"06 test smells","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/06-test-smells/#test-smells","title":"Test Smells","text":"<ul> <li>Source: Meszaros (xUnit Patterns) &amp; Others</li> </ul> <p>Context: Issues reducing test maintainability, reliability (flakiness), and speed.</p> <p>References: * xUnit Patterns (Meszaros) * Survey on Test Smells (T. Sharma)</p> Sub-Category Types Code/Behavior Assertion Roulette, Eager Test, Lazy Test, Mystery Guest, General Fixture, Test Maverick, Obscure Test, Conditional Test Logic, Test Logic in Production, Hard-coded Test Data. Project/Process Fragile Test, Flaky Test, Slow Tests, Erratic Test."},{"location":"problem-analysis/reference/06-test-smells/#codebehavior-smells","title":"Code/Behavior Smells","text":"<ul> <li>Assertion Roulette: Multiple assertions in a test without messages; hard to tell which failed.</li> <li>Eager Test: A test verifying too much functionality (multiple scenarios).</li> <li>Lazy Test: Multiple tests checking the same method using the same fixture (could be consolidated).</li> <li>Mystery Guest: The test relies on external resources (files, DB) not visible within the test code.</li> <li>General Fixture: The test setup creates a fixture much larger than what the test actually needs.</li> <li>Test Maverick: A test that sets up its own environment differently from the standard suite.</li> <li>Obscure Test: The test is hard to understand (documentation smell).</li> <li>Conditional Test Logic: Tests containing <code>if</code> or loops (tests should be linear).</li> <li>Test Logic in Production: Production code contains logic specifically for tests (e.g., <code>if (TEST_MODE)...</code>).</li> <li>Hard-coded Test Data: Data embedded in tests making them brittle to change.</li> </ul>"},{"location":"problem-analysis/reference/06-test-smells/#projectprocess-smells","title":"Project/Process Smells","text":"<ul> <li>Fragile Test: Tests that break easily when the SUT (System Under Test) changes slightly.</li> <li>Flaky Test: Tests that pass or fail intermittently without code changes.</li> <li>Slow Tests: Tests that take too long, discouraging frequent execution.</li> <li>Erratic Test: Tests that behave inconsistently due to concurrency or shared state.</li> </ul> <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/07-configuration-smells/","title":"07 configuration smells","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/07-configuration-smells/#configuration-smells","title":"Configuration Smells","text":"<ul> <li>Source: Sharma's Taxonomy</li> </ul> <p>Context: Issues in IaC, XML, JSON, YAML files regarding security and fragility.</p> <p>References: * Configuration Smells: Taxonomy (T. Sharma) * Configuration Smell Detection (NSF/Par)</p> Type Description Security/Consistency Hardcoded Password/Secret, Missing Configuration, Environment Dependent Configuration, Duplicate Configuration Keys, Unencrypted Sensitive Data, Inconsistent Configuration Naming, Overridden Configuration."},{"location":"problem-analysis/reference/07-configuration-smells/#detailed-descriptions","title":"Detailed Descriptions","text":"<ul> <li>Hardcoded Password/Secret: Storing credentials in plain text.</li> <li>Missing Configuration: Required configuration keys are absent.</li> <li>Environment Dependent Configuration: Configs that differ unpredictably between Dev/Prod.</li> <li>Duplicate Configuration Keys: Defining the same key multiple times.</li> <li>Unencrypted Sensitive Data: Sensitive values stored without encryption.</li> <li>Inconsistent Configuration Naming: Naming conventions vary across files/environments.</li> <li>Overridden Configuration: Excessive layering of config files making the final value hard to trace.</li> </ul> <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/08-database-smells/","title":"08 database smells","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/08-database-smells/#database-smells","title":"Database Smells","text":"<ul> <li>Source: Sharma's Taxonomy, \"Smelly Relations\"</li> </ul> <p>Context: Poor RDBMS schema design and inefficient SQL queries.</p> <p>References: * Smelly Relations: Database Schema Quality (Gatech) * Database Smell Taxonomy (T. Sharma) * SpeakerDeck: Smelly Relations</p> Sub-Category Types Schema Multi-purpose Column, Metadata as Data, Tables as Classes, Sturgeon's Law (90% unused), Ad-hoc TE (Type Extension), God Table. Query N+1 Select Problem, Fear of the Unknown (NULL handling), Index Abuse, Spaghetti Query."},{"location":"problem-analysis/reference/08-database-smells/#schema-smells","title":"Schema Smells","text":"<ul> <li>Multi-purpose Column: A column storing different types of data depending on context.</li> <li>Metadata as Data: Storing metadata (e.g., version, type) as row data instead of schema structure.</li> <li>Tables as Classes: Mapping every class directly to a table (ignoring impedance mismatch).</li> <li>Sturgeon's Law: Tables with 90% \"crud\" or unused columns.</li> <li>Ad-hoc TE (Type Extension): Adding columns like <code>attribute1</code>, <code>attribute2</code> for flexibility.</li> <li>God Table: A table with too many columns or too many rows (central hub).</li> </ul>"},{"location":"problem-analysis/reference/08-database-smells/#query-smells","title":"Query Smells","text":"<ul> <li>N+1 Select Problem: Executing N queries to fetch child records for N parent records.</li> <li>Fear of the Unknown: Inconsistent handling of NULL values.</li> <li>Index Abuse: Missing indexes on foreign keys/search columns, or too many unused indexes.</li> <li>Spaghetti Query: Extremely complex SQL queries that are hard to read/maintain.</li> </ul> <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/09-performance-smells/","title":"09 performance smells","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/09-performance-smells/#performance-smells","title":"Performance Smells","text":"<ul> <li>Source: Various (Practitioner Literature)</li> </ul> <p>Context: Patterns known to degrade latency, throughput, or resource efficiency.</p> <p>References: * Performance Anti-Patterns (ScienceDirect) * Hacker News Discussion on Performance * StackOverflow: Synchronization Costs</p> Type Description Resource Usage Excessive Object Creation, Memory Leak, Busy Waiting, Synchronous I/O in Main Thread, Unnecessary Synchronization, Temporary Object Abuse, Session Bloat, Image Bloat, Improper Caching."},{"location":"problem-analysis/reference/09-performance-smells/#detailed-descriptions","title":"Detailed Descriptions","text":"<ul> <li>Excessive Object Creation: Creating unnecessary temporary objects (GC pressure).</li> <li>Memory Leak: Objects are retained longer than necessary.</li> <li>Busy Waiting: Loops that constantly check a condition, consuming CPU.</li> <li>Synchronous I/O in Main Thread: Blocking the UI or main thread for network/disk ops.</li> <li>Unnecessary Synchronization: Locking resources when not needed (contention).</li> <li>Temporary Object Abuse: Recreating heavy objects (e.g., DB connections) repeatedly.</li> <li>Session Bloat: Storing too much data in HTTP sessions.</li> <li>Image Bloat: Serving images larger than the display area.</li> <li>Improper Caching: Caching too much, too little, or failing to invalidate stale data.</li> </ul> <p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/10-grammar-smells/","title":"10 grammar smells","text":"<p>\u2190 Overview</p>"},{"location":"problem-analysis/reference/10-grammar-smells/#grammar-smells","title":"Grammar Smells","text":"<ul> <li>Source: Sharma's Taxonomy</li> </ul> <p>Context: Issues in DSL definitions and parser rules.</p> <p>References: * Grammar Smells (T. Sharma)</p> Type Description DSL/Parser Ambiguous Grammar, Left Recursion, Common Prefix, Useless Rule, Unreachable Rule, Missing Semicolon/Separator Issues, Indentation Hell."},{"location":"problem-analysis/reference/10-grammar-smells/#detailed-descriptions","title":"Detailed Descriptions","text":"<ul> <li>Ambiguous Grammar: A grammar where a string can be parsed in multiple ways.</li> <li>Left Recursion: Grammar rules that recurse on the left side (issues for LL parsers).</li> <li>Common Prefix: Rules sharing the same start (requires backtracking or factoring).</li> <li>Useless Rule: A rule that is defined but never referenced.</li> <li>Unreachable Rule: A rule that can never be matched.</li> <li>Missing Semicolon/Separator Issues: Ambiguities arising from optional delimiters.</li> <li>Indentation Hell: Complex indentation-based block structures (if not handled carefully).</li> </ul> <p>\u2190 Overview</p>"},{"location":"problem-solving/domain-driven-analysis/","title":"DDD Patterns in Jenkins Architecture","text":"<p>This document analyzes the refactored Jenkins architecture and identifies similarities with DDD patterns, referencing Eric Evans' Domain-Driven Design Reference (2015).</p>"},{"location":"problem-solving/domain-driven-analysis/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Background</li> <li>Overview</li> <li>Building Blocks Identified</li> <li>Layered Architecture</li> <li>Modules</li> <li>Infrastructure Layer (Facade Pattern)</li> <li>Intention-Revealing Interfaces (Analysis)</li> <li>Why Tactical Patterns Were Not Applied</li> <li>Why Strategic Design Patterns Were Not Applied</li> <li>Before vs After Comparison</li> <li>Summary</li> <li>Interview Talking Point</li> <li>References</li> </ul>"},{"location":"problem-solving/domain-driven-analysis/#background","title":"Background","text":"<p>While researching how to articulate the refactored structure, I discovered Domain-Driven Design. Analyzing my architecture, I found it aligns with several DDD organizational principles:</p> <ul> <li>Layered Architecture: My 4-layer separation matched DDD's isolation principle</li> <li>Modules: My domain-based libraries matched DDD's cohesive concept grouping</li> </ul>"},{"location":"problem-solving/domain-driven-analysis/#whats-missing-from-full-ddd","title":"What's Missing from Full DDD","text":"<p>DDD's tactical patterns (Entities, Aggregates, Repositories) require stateful domain objects with identity and lifecycle. Jenkins pipelines are stateless: each execution is independent, no objects persist across runs. These patterns simply don't apply.</p> <p>This is not a full DDD implementation. It's a domain-oriented architecture that shares organizational principles with DDD.</p>"},{"location":"problem-solving/domain-driven-analysis/#overview","title":"Overview","text":""},{"location":"problem-solving/domain-driven-analysis/#ddd-pattern-categories","title":"DDD Pattern Categories","text":"<p>Domain-Driven Design (Eric Evans, 2003) organizes patterns into distinct categories:</p> Category Patterns Purpose Building Blocks Layered Architecture, Modules, Services, Entities, Value Objects Code-level organization Strategic Design Bounded Contexts, Context Mapping, Core Domain, Subdomains System-level organization Supple Design Intention-Revealing Interfaces, Side-Effect-Free Functions Design quality"},{"location":"problem-solving/domain-driven-analysis/#patterns-identified-in-this-architecture","title":"Patterns Identified in This Architecture","text":"DDD Pattern Category Alignment Notes Layered Architecture Building Blocks \u2713 Applied 4-layer separation of concerns Modules Building Blocks \u2713 Applied Git/Shell/SSH libraries as cohesive units Infrastructure Service Building Blocks Partial Concept exists, implemented as GoF Facade Intention-Revealing Interfaces Supple Design \u2717 No Names expose implementation (git commands) Entities/Aggregates Building Blocks \u2717 No Not applicable to stateless pipeline scripts Domain Services Building Blocks \u2717 No No domain logic to coordinate Bounded Contexts Strategic Design \u2717 No Single team, single codebase"},{"location":"problem-solving/domain-driven-analysis/#building-blocks-identified","title":"Building Blocks Identified","text":""},{"location":"problem-solving/domain-driven-analysis/#1-layered-architecture","title":"1. Layered Architecture \u2713","text":"<p>The architecture implements a 4-layer structure that aligns with DDD's Layered Architecture pattern:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      LAYER 1: Entry Point                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502   DLXJenkins     \u2502  \u2502    JsJenkins     \u2502  \u2502  PipelineFor     \u2502  \u2502\n\u2502  \u2502  [Unity Entry]   \u2502  \u2502   [JS Entry]     \u2502  \u2502    Jenkins       \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                   \u2502\n                                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 LAYER 2: Orchestration (vars/)                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n\u2502  \u2502   stageLintUnity        \u2502  \u2502  stageInitialization    \u2502          \u2502\n\u2502  \u2502   stageUnityExecution   \u2502  \u2502  stageDeployBuild       \u2502          \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                   \u2502\n                                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 LAYER 3: Infrastructure                            \u2502\n\u2502  Physical: src/service/         Physical: vars/ (CPS Constraint)   \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n\u2502  \u2502   BitbucketApiService   \u2502  \u2502   shellScriptHelper     \u2502          \u2502\n\u2502  \u2502  [HTTP Communication]   \u2502  \u2502  [Facade: Execution +   \u2502          \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502   Logging]              \u2502          \u2502\n\u2502                               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n\u2502                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n\u2502                               \u2502  bitbucketApiHelper     \u2502          \u2502\n\u2502                               \u2502  [Facade: Credentials + \u2502          \u2502\n\u2502                               \u2502   API orchestration]    \u2502          \u2502\n\u2502                               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                   \u2502\n                                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 LAYER 4: Modules                                   \u2502\n\u2502  Physical: src/utils/                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502    GitLibrary     \u2502 \u2502   ShellLibrary    \u2502 \u2502  SSHShellLibrary  \u2502 \u2502\n\u2502  \u2502   23 operations   \u2502 \u2502   15 operations   \u2502 \u2502    8 operations   \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502  Physical: vars/ (CPS Constraint)                                   \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 bitbucketApiLibrary - API request metadata definitions        \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Key isolation achieved: - Entry points depend only on Orchestration - Orchestration depends only on Infrastructure - Infrastructure depends only on Modules - Modules have no upward dependencies</p> Jenkins CPS Constraint (Click to expand)  Jenkins Pipeline applies CPS (Continuation-Passing Style) transformation for fault tolerance. This creates two constraints:  | Constraint | Description | |------------|-------------| | **Serializable** | Class fields must be serializable for state persistence across restarts | | **Pipeline Step Context** | `sh`, `echo`, `withCredentials` must be called from `vars/` (CPS context) |  **Pattern: Indirect call via vars/**  <pre><code>// src/HttpApiService.groovy\nlogger.stepProcessing(\"msg\")  // \u2713 OK - vars/\uc5d0\uc11c echo \uc2e4\ud589\njenkinsfile.sh(\"...\")         // \u274c \uc548 \ub428 - \uc9c1\uc811 \ud638\ucd9c\n</code></pre>  | Component | Location | Reason | |-----------|----------|--------| | **HttpApiService** | src/ | Pure Java (Apache HttpClient). logger\ub294 vars/ \ud1b5\ud574 \uac04\uc811 \ud638\ucd9c | | **shellScriptHelper** | vars/ | `sh()` \uc9c1\uc811 \ud638\ucd9c | | **logger** | vars/ | `echo` \uc9c1\uc811 \ud638\ucd9c |  &gt; \uc0c1\uc138 \uc124\uba85: [CPS Serialization Diagram](cps-serialization-diagram.md)"},{"location":"problem-solving/domain-driven-analysis/#2-modules","title":"2. Modules \u2713","text":"<p>Each utility library functions as a Module with characteristics that align with DDD's definition:</p> <ul> <li>Cohesive concepts: Related operations grouped together</li> <li>Clear naming: Names reflect domain insight (Git operations, Shell operations, API operations)</li> <li>Low coupling: Can be understood independently</li> </ul> Module Location Operations Cohesive Concept GitLibrary src/utils/ 23 All version control operations ShellLibrary src/utils/ 15 Local system execution SSHShellLibrary src/utils/ 8 Remote server operations bitbucketApiLibrary vars/ (CPS) 8 Bitbucket API request definitions <p>Example: GitLibrary as a Module</p> <pre><code>class GitLibrary {\n    // Cohesive set of version control operations\n    static final Closure CheckoutBranch = { String branchName -&gt;\n        [\n            script: \"git checkout ${branchName}\",\n            label: \"Checkout branch '${branchName}'\",\n            returnStdout: true\n        ]\n    }\n\n    static final Closure MergeOriginBranch = { String branchToMerge -&gt;\n        [\n            script: \"git merge origin/${branchToMerge}\",\n            label: \"Merge remote branch 'origin/${branchToMerge}' into current HEAD\",\n            returnStatus: true\n        ]\n    }\n\n    // ... 23 operations total\n}\n</code></pre> <p>Module characteristics achieved: - High cohesion: Only git-related operations - Encapsulation: Internal helpers prefixed with <code>_</code> - Domain vocabulary: <code>checkout</code>, <code>branch</code>, <code>merge</code>, <code>tag</code></p>"},{"location":"problem-solving/domain-driven-analysis/#3-infrastructure-layer-facade-pattern","title":"3. Infrastructure Layer (Facade Pattern)","text":"<p>Layer 3 components are implemented using the Facade pattern from GoF design patterns, rather than DDD Services. This distinction is important:</p> <p>DDD Service definition (from DDD Reference, p.14):</p> <p>\"When a significant process or transformation in the domain is not a natural responsibility of an entity or value object, add an operation to the model as a standalone interface declared as a service.\"</p> <p>Since this architecture has no Entities or Value Objects (stateless environment), the DDD Service pattern doesn't directly apply. Instead, these components serve as technical facades that simplify complex infrastructure operations:</p> Component Pattern Responsibility BitbucketApiService HTTP Client Wrapper Encapsulates Apache HttpClient for API communication shellScriptHelper Facade Combines Library closure execution + Logger integration bitbucketApiHelper Facade Combines credentials management + API service orchestration <p>Example: shellScriptHelper as Facade</p> <pre><code>// Simplifies: Library closure + validation + execution + logging\ndef call(Closure shellScriptClosure, List args = []) {\n    Map shMap = shellScriptClosure(*args)\n    Map validatedShMap = validateShMap(shMap)\n    logger.stepStart(\"${validatedShMap.label}\")\n\n    if (validatedShMap.returnStatus) {\n        return executeReturnStatus(validatedShMap)\n    } else if (validatedShMap.returnStdout) {\n        return executeReturnStdout(validatedShMap)\n    }\n    // ...\n}\n</code></pre> <p>Example: bitbucketApiHelper as Facade</p> <pre><code>// Simplifies: credentials + API service + error handling\ndef call(Map bitbucketApiMap) {\n    BitbucketApiService bitbucketApiService = new BitbucketApiService(this)\n\n    withCredentials([string(credentialsId: 'bitbucket-access-token', variable: 'token')]) {\n        if (bitbucketApiMap.method == 'POST') {\n            return bitbucketApiService.post(bitbucketApiMap.apiUrlString, bitbucketApiMap.requestBody, token)\n        }\n        // ...\n    }\n}\n</code></pre>"},{"location":"problem-solving/domain-driven-analysis/#4-intention-revealing-interfaces-analysis","title":"4. Intention-Revealing Interfaces (Analysis)","text":"<p>DDD Definition: Names should describe effect and purpose, without reference to the means by which they do what they promise.</p> <p>Analysis of current naming:</p> Operation Name What It Reveals Issue <code>GitLibrary.CheckoutBranch</code> <code>git checkout</code> command Exposes implementation <code>GitLibrary.MergeOriginBranch</code> <code>git merge origin/</code> command Exposes implementation <code>GitLibrary.ResetHardHead</code> <code>git reset --hard</code> command Exposes implementation <code>ShellLibrary.PrintJenkinsEnv</code> Prints environment Descriptive, but technical <code>SSHShellLibrary.CopyBuildToHostServer</code> SCP operation Exposes implementation <p>Why this doesn't meet DDD criteria:</p> <p>The current names directly expose the underlying git/shell commands rather than describing the business intent. True Intention-Revealing names would be:</p> Current Intention-Revealing Alternative <code>CheckoutBranch</code> <code>SwitchToBranch</code> or <code>ActivateBranch</code> <code>MergeOriginBranch</code> <code>IntegrateRemoteChanges</code> <code>ResetHardHead</code> <code>DiscardAllLocalChanges</code> <code>CopyBuildToHostServer</code> <code>DeployBuildArtifacts</code> <p>Conclusion: The current naming is descriptive but not intention-revealing by DDD standards. Names follow git/shell command conventions rather than domain language.</p>"},{"location":"problem-solving/domain-driven-analysis/#why-tactical-patterns-were-not-applied","title":"Why Tactical Patterns Were Not Applied","text":"Pattern Description Why Not Applicable Entities Objects with identity and lifecycle Pipeline scripts are stateless Value Objects Immutable objects defined by attributes No complex domain objects needed Aggregates Clusters with consistency boundaries No persistent object relationships Repositories Collection-like access to aggregates No persistent storage of domain objects <p>Stateless vs Stateful:</p> <p>DDD tactical patterns assume stateful domain objects where: - Objects have identity that persists across operations - State changes are tracked and managed - Previous state influences next behavior</p> <p>Jenkins pipelines are stateless: - Each execution is independent - No objects persist across pipeline runs - External systems (Bitbucket, Azure) manage state</p> <pre><code>// Stateless: Each call is independent, no state tracking\nbitbucketApiHelper(\n    bitbucketApiLibrary.createBuildStatusForCommit(Status.COMMIT_STATUS.SUCCESSFUL, '\u2705 Success')\n)\n\n// Stateful would require:\nclass PullRequest {\n    PRId id\n    Status previousStatus\n\n    void updateStatus(newStatus) {\n        if (previousStatus == FAILED &amp;&amp; newStatus == SUCCESS) {\n            notifyRecovery()  // Behavior depends on previous state\n        }\n        previousStatus = newStatus\n    }\n}\n</code></pre>"},{"location":"problem-solving/domain-driven-analysis/#why-strategic-design-patterns-were-not-applied","title":"Why Strategic Design Patterns Were Not Applied","text":""},{"location":"problem-solving/domain-driven-analysis/#bounded-context","title":"Bounded Context","text":"<p>Bounded Context applies when: - Multiple teams with different models - Separate applications or services - Different codebases, databases</p> <p>Not applicable here: - Single team maintains all code - Single codebase (Jenkins shared library) - No need for model translation between contexts</p> <p>Note: The utility libraries (Git, Shell, SSH) are Modules, not Bounded Contexts. They share the same team, codebase, and ubiquitous language.</p>"},{"location":"problem-solving/domain-driven-analysis/#before-vs-after-comparison","title":"Before vs After Comparison","text":"Aspect Before (74fc356) After (ff74ac8) Structure Flat <code>groovy/</code> folder 4-layer <code>sharedLibraries/</code> Git operations Mixed in generalHelper Separated to GitLibrary (23 ops) Shell operations Mixed in generalHelper Separated to ShellLibrary (15 ops) SSH operations Mixed in generalHelper Separated to SSHShellLibrary (8 ops) Stage logic Directly in Jenkinsfile Extracted to vars/stage*.groovy Logging Ad-hoc echo statements Centralized logger.groovy API calls Python script dependency Native Groovy BitbucketApiService Commits 89 308"},{"location":"problem-solving/domain-driven-analysis/#summary","title":"Summary","text":""},{"location":"problem-solving/domain-driven-analysis/#patterns-applied","title":"Patterns Applied","text":"Pattern Category Implementation Layered Architecture DDD Building Blocks 4-layer: Entry \u2192 Orchestration \u2192 Infrastructure \u2192 Module Modules DDD Building Blocks GitLibrary, ShellLibrary, SSHShellLibrary, bitbucketApiLibrary"},{"location":"problem-solving/domain-driven-analysis/#patterns-partially-aligned","title":"Patterns Partially Aligned","text":"Pattern Category Notes Infrastructure Service DDD Building Blocks Concept exists, implemented as GoF Facade pattern"},{"location":"problem-solving/domain-driven-analysis/#patterns-not-applied","title":"Patterns Not Applied","text":"Pattern Category Reason Intention-Revealing Interfaces DDD Supple Design Names expose implementation (git commands) Entities, Aggregates DDD Building Blocks Stateless pipeline environment Domain Services DDD Building Blocks No domain logic requiring coordination between Entities/Value Objects Bounded Contexts DDD Strategic Design Single team, single codebase Context Mapping DDD Strategic Design No multiple contexts to integrate"},{"location":"problem-solving/domain-driven-analysis/#references","title":"References","text":"<ul> <li>Evans, Eric. Domain-Driven Design: Tackling Complexity in the Heart of Software. Addison-Wesley, 2003.</li> <li>Evans, Eric. Domain-Driven Design Reference. Domain Language, Inc., 2015. (CC BY 4.0)</li> <li>Gamma, Erich, et al. Design Patterns: Elements of Reusable Object-Oriented Software. Addison-Wesley, 1994. (Facade pattern)</li> <li>Martin Fowler - Bounded Context</li> </ul>"},{"location":"problem-solving/jenkins-cps-serialization-diagram/","title":"Jenkins CPS Serialization Visualization","text":""},{"location":"problem-solving/jenkins-cps-serialization-diagram/#normal-execution-no-restart","title":"Normal Execution (No Restart)","text":"<pre><code>Pipeline Execution\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Stage 1: Build  \u2502 \u2713 Complete\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Stage 2: Test   \u2502 \u2713 Complete\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Stage 3: Deploy \u2502 \u2713 Complete\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502\n    \u25bc\n  SUCCESS\n</code></pre>"},{"location":"problem-solving/jenkins-cps-serialization-diagram/#when-jenkins-restart-occurs","title":"When Jenkins Restart Occurs","text":"<pre><code>Pipeline Execution\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Stage 1: Build  \u2502 \u2713 Complete\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Stage 2: Test   \u2502 \u23f3 Running...\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502\n    \u2502   \ud83d\udca5 Jenkins Restart!\n    \u2502\n    \u25bc\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551  1. Serialize                                                 \u2551\n\u2551                                                               \u2551\n\u2551  Memory State:                      Disk (program.dat):       \u2551\n\u2551  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2551\n\u2551  \u2502 currentStage = 2    \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u25b6  \u2502 01001010 01100101   \u2502   \u2551\n\u2551  \u2502 testResult = null   \u2502   Save    \u2502 01101110 01101011   \u2502   \u2551\n\u2551  \u2502 buildArtifact = ... \u2502           \u2502 01101001 01101110   \u2502   \u2551\n\u2551  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2551\n\u2551                                                               \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n    \u2502\n    \u2502   \ud83d\udd04 Jenkins Restart Complete\n    \u2502\n    \u25bc\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551  2. Deserialize                                               \u2551\n\u2551                                                               \u2551\n\u2551  Disk (program.dat):               Memory Restored:           \u2551\n\u2551  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2551\n\u2551  \u2502 01001010 01100101   \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u25b6  \u2502 currentStage = 2    \u2502   \u2551\n\u2551  \u2502 01101110 01101011   \u2502  Restore  \u2502 testResult = null   \u2502   \u2551\n\u2551  \u2502 01101001 01101110   \u2502           \u2502 buildArtifact = ... \u2502   \u2551\n\u2551  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2551\n\u2551                                                               \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Stage 2: Test   \u2502 \u25c0\u2500\u2500 Resume from here!\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Stage 3: Deploy \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2502\n    \u25bc\n  SUCCESS\n</code></pre>"},{"location":"problem-solving/jenkins-cps-serialization-diagram/#serializable-vs-non-serializable","title":"Serializable vs Non-Serializable","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Serializable \u2713                               \u2502\n\u2502                    (Can be saved/restored)                      \u2502\n\u2502                                                                 \u2502\n\u2502   String name = \"build-123\"     \u2500\u2500\u25b6  Save \u2500\u2500\u25b6  Restore \u2500\u2500\u25b6 OK  \u2502\n\u2502   int count = 5                 \u2500\u2500\u25b6  Save \u2500\u2500\u25b6  Restore \u2500\u2500\u25b6 OK  \u2502\n\u2502   List&lt;String&gt; files = [...]    \u2500\u2500\u25b6  Save \u2500\u2500\u25b6  Restore \u2500\u2500\u25b6 OK  \u2502\n\u2502   Map&lt;String, Object&gt; config    \u2500\u2500\u25b6  Save \u2500\u2500\u25b6  Restore \u2500\u2500\u25b6 OK  \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Non-Serializable \u2717                           \u2502\n\u2502                    (Cannot be saved/restored)                   \u2502\n\u2502                                                                 \u2502\n\u2502   Socket connection = ...       \u2500\u2500\u25b6  Save \u2500\u2500\u25b6  \ud83d\udca5 ERROR        \u2502\n\u2502   InputStream stream = ...      \u2500\u2500\u25b6  Save \u2500\u2500\u25b6  \ud83d\udca5 ERROR        \u2502\n\u2502   Database db = ...             \u2500\u2500\u25b6  Save \u2500\u2500\u25b6  \ud83d\udca5 ERROR        \u2502\n\u2502   Iterator iter = ...           \u2500\u2500\u25b6  Save \u2500\u2500\u25b6  \ud83d\udca5 ERROR        \u2502\n\u2502                                                                 \u2502\n\u2502   Reason: \"Current connection state\" cannot be saved           \u2502\n\u2502           to a file and restored later                         \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"problem-solving/jenkins-cps-serialization-diagram/#application-in-this-codebase","title":"Application in This Codebase","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  HttpApiService (src/service/)                                  \u2502\n\u2502                                                                 \u2502\n\u2502  class HttpApiService {                                         \u2502\n\u2502      def jenkinsfile  \u25c0\u2500\u2500 Must be Serializable                 \u2502\n\u2502      def logger       \u25c0\u2500\u2500 Must be Serializable                 \u2502\n\u2502                                                                 \u2502\n\u2502      def executeRequest(...) {                                  \u2502\n\u2502          HttpClient httpClient = HttpClients.createDefault()    \u2502\n\u2502          //       \u25b2                                             \u2502\n\u2502          //       \u2502                                             \u2502\n\u2502          //  Local variable - OK                                \u2502\n\u2502          //  Disappears when method ends                        \u2502\n\u2502          //  Jenkins doesn't need to save it                    \u2502\n\u2502      }                                                          \u2502\n\u2502  }                                                              \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  shellScriptHelper (vars/)                                      \u2502\n\u2502                                                                 \u2502\n\u2502  def call(Closure shellScriptClosure, List args = []) {         \u2502\n\u2502      sh(shMap)  \u25c0\u2500\u2500 Direct pipeline step call                  \u2502\n\u2502  }              \u2502                                               \u2502\n\u2502                 \u2502                                               \u2502\n\u2502                 \u2514\u2500\u2500 Must be in vars/ to call pipeline           \u2502\n\u2502                     steps from CPS context                      \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"problem-solving/jenkins-cps-serialization-diagram/#pipeline-step-execution-context","title":"Pipeline Step Execution Context","text":"<p>The second CPS constraint: Where the pipeline step is called matters.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Rules                                                          \u2502\n\u2502                                                                 \u2502\n\u2502  vars/ \u2192 direct pipeline step call     \u2713 OK                    \u2502\n\u2502  src/  \u2192 direct pipeline step call     \u2717 Not allowed           \u2502\n\u2502  src/  \u2192 vars/ wrapper \u2192 pipeline step \u2713 OK                    \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"problem-solving/jenkins-cps-serialization-diagram/#pattern-indirect-call-via-vars","title":"Pattern: Indirect Call via vars/","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                                 \u2502\n\u2502  src/HttpApiService.groovy (Outside CPS context)                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502\n\u2502  \u2502 logger.stepProcessing(\"msg\")            \u2502                   \u2502\n\u2502  \u2502         \u2502                               \u2502                   \u2502\n\u2502  \u2502         \u25bc                               \u2502                   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2502\n\u2502            \u2502                                                    \u2502\n\u2502            \u2502  Call                                              \u2502\n\u2502            \u25bc                                                    \u2502\n\u2502  vars/logger.groovy (Inside CPS context)                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502\n\u2502  \u2502 void stepProcessing(String description) \u2502                   \u2502\n\u2502  \u2502     echo \"\ud83c\udfc3 ${description}\"  \u2713 OK     \u2502                   \u2502\n\u2502  \u2502           \u25b2                             \u2502                   \u2502\n\u2502  \u2502           \u2502                             \u2502                   \u2502\n\u2502  \u2502     echo executes here                  \u2502                   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"problem-solving/jenkins-cps-serialization-diagram/#what-doesnt-work","title":"What Doesn't Work","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                                 \u2502\n\u2502  src/HttpApiService.groovy (Outside CPS context)                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502\n\u2502  \u2502 jenkinsfile.sh(\"echo hello\")  \u2717        \u2502                   \u2502\n\u2502  \u2502              \u2502                          \u2502                   \u2502\n\u2502  \u2502              \u25bc                          \u2502                   \u2502\n\u2502  \u2502         \ud83d\udca5 Problem                      \u2502                   \u2502\n\u2502  \u2502                                         \u2502                   \u2502\n\u2502  \u2502  sh() called directly from src/         \u2502                   \u2502\n\u2502  \u2502  \u2192 Pipeline step outside CPS context    \u2502                   \u2502\n\u2502  \u2502  \u2192 Jenkins cannot handle properly       \u2502                   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2502\n\u2502                                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"problem-solving/jenkins-cps-serialization-diagram/#correct-pattern-in-this-codebase","title":"Correct Pattern in This Codebase","text":"<pre><code>// vars/logger.groovy (Inside CPS context)\nvoid stepProcessing(String description) {\n    echo \"\ud83c\udfc3 ${description}\"  // \u2713 echo called here - OK\n}\n\n// src/HttpApiService.groovy (Outside CPS context)\nclass HttpApiService {\n    def logger\n\n    HttpApiService(def jenkinsfile) {\n        this.logger = jenkinsfile.logger\n    }\n\n    def doSomething() {\n        logger.stepProcessing(\"msg\")  // \u2713 Delegates to vars/ - OK\n        // jenkinsfile.sh(\"...\")      // \u2717 Direct call - Not allowed\n    }\n}\n</code></pre>"},{"location":"problem-solving/jenkins-cps-serialization-diagram/#component-placement","title":"Component Placement","text":"Component Location Reason HttpApiService src/service/ Apache HttpClient (pure Java). logger called indirectly via vars/ shellScriptHelper vars/ Direct <code>sh()</code> call bitbucketApiHelper vars/ Direct <code>withCredentials()</code> call logger vars/ Direct <code>echo</code> call"},{"location":"problem-solving/jenkins-cps-serialization-diagram/#summary","title":"Summary","text":"Constraint Description Serializable Objects must be savable as bytes for restoration after restart Pipeline Step Context <code>sh</code>, <code>echo</code>, <code>withCredentials</code>, etc. can only be called directly from <code>vars/</code> Scenario Result All variables are Serializable Pipeline continues after Jenkins restart \u2713 Non-Serializable variable exists <code>NotSerializableException</code> error \ud83d\udca5 Direct pipeline step call from src/ CPS problem \ud83d\udca5 Indirect call via vars/ wrapper from src/ OK \u2713"},{"location":"problem-solving/logger-system-design-integration/","title":"3-Level Logger System Design &amp; Integration","text":"<p>Hierarchical logging system design for consistent logging in Jenkins Pipeline</p>"},{"location":"problem-solving/logger-system-design-integration/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Design Background</li> <li>Problem: Issues with Existing Logging<ul> <li>Problem Summary</li> <li>Lack of Consistency</li> <li>Lack of Structure: Cognitive Chunking Impossible</li> <li>Jenkins Logging System Limitations</li> <li>Code Duplication (DRY Violation)</li> </ul> </li> <li>Solution: Discovering Chunking Units (Steps Group)<ul> <li>What is Steps Group?</li> <li>3-Level Logger Design</li> <li>Design Result: Logging Responsibility Distribution by Layer</li> </ul> </li> <li>Architecture Integration</li> <li>Position within 4-Layer Architecture</li> <li>Library-Helper Auto Logging Integration<ul> <li>Embedding Logging Metadata in Library</li> <li>Helper Auto Logging with Metadata</li> </ul> </li> <li>Integration with shellScriptHelper</li> <li>Before/After Comparison</li> </ul>"},{"location":"problem-solving/logger-system-design-integration/#1-design-background","title":"1. Design Background","text":""},{"location":"problem-solving/logger-system-design-integration/#11-problem-issues-with-existing-logging","title":"1.1 Problem: Issues with Existing Logging","text":""},{"location":"problem-solving/logger-system-design-integration/#111-problem-summary","title":"1.1.1 Problem Summary","text":"# Problem Description 1 Lack of Consistency Different logging formats in each file 2 Lack of Structure No cognitive chunking unit besides Stage 3 Jenkins Output Constraints Format customization impossible due to CPS/Sandbox 4 Code Duplication <code>logMessage()</code> function copied across multiple files"},{"location":"problem-solving/logger-system-design-integration/#112-lack-of-consistency","title":"1.1.2 Lack of Consistency","text":"<p>Different logging methods in each file:</p> File Logging Method Problem <code>generalHelper.groovy</code> <code>logMessage()</code> function Self-implemented <code>jsHelper.groovy</code> <code>logMessage()</code> function Same copy as generalHelper (DRY violation) <code>Jenkinsfile</code> Direct <code>echo</code> call No format"},{"location":"problem-solving/logger-system-design-integration/#113-lack-of-structure-cognitive-chunking-impossible","title":"1.1.3 Lack of Structure: Cognitive Chunking Impossible","text":"<p>Problem: In the entire Pipeline, except for <code>Stage</code>, there is no conceptual distinction useful for human recognition</p> <p>In cognitive psychology, Chunking is a strategy for processing information by grouping it into meaningful units. The clearer the boundary, the faster and easier it is to receive information.</p> Current State Problem Stage \u2192 (all logs listed flat) Dozens of lines of logs without intermediate units Individual Steps listed Cannot distinguish logical task groups When error occurs Difficult to trace \"where did the error occur?\""},{"location":"problem-solving/logger-system-design-integration/#114-jenkins-logging-system-limitations","title":"1.1.4 Jenkins Logging System Limitations","text":""},{"location":"problem-solving/logger-system-design-integration/#1141-same-echo-call-simultaneous-output-to-two-places","title":"1.1.4.1 Same echo Call \u2192 Simultaneous Output to Two Places","text":"Stage View (actual screenshot) Console Output (example) Log visible in Pipeline Stage UI Same log example visible in Console Log <p>Core Problem: A single <code>echo</code> call outputs to both Stage View and Console Output, and neither can customize the format</p>"},{"location":"problem-solving/logger-system-design-integration/#1142-output-flow","title":"1.1.4.2 Output Flow","text":"<pre><code>flowchart LR\n    subgraph Groovy[\"Pipeline Script\"]\n        ECHO[\"echo 'message'\"]\n        SH[\"sh 'command'\"]\n    end\n\n    subgraph Jenkins[\"Jenkins Internal\"]\n        CPS[\"CPS Transform\"]\n        LOG[\"Console Logger\"]\n    end\n\n    subgraph Output[\"Output (Fixed Format)\"]\n        STAGE[\"Stage View\"]\n        CONSOLE[\"Console Output\"]\n    end\n\n    ECHO --&gt; CPS\n    SH --&gt; CPS\n    CPS --&gt; LOG\n    LOG --&gt; STAGE\n    LOG --&gt; CONSOLE\n\n    style CPS fill:#ff6b6b,stroke:#333\n    style LOG fill:#ff6b6b,stroke:#333</code></pre>"},{"location":"problem-solving/logger-system-design-integration/#1143-constraints","title":"1.1.4.3 Constraints","text":"Constraint Description Fixed format Timestamp + <code>[Pipeline]</code> marker + message mixed Flat structure All <code>echo</code>, <code>sh</code> commands listed at the same level No customization Jenkins Content Security Policy enforces UI output format No hierarchy Difficult to find specific tasks in long logs"},{"location":"problem-solving/logger-system-design-integration/#1144-jenkins-content-security-policy-constraints-reference","title":"1.1.4.4 Jenkins Content Security Policy Constraints (Reference)","text":"<p>Jenkins applies a restrictive Content Security Policy by default to prevent XSS attacks:</p> <p>Do not use inline JavaScript (JS) in the Jenkins GUI, i.e., JS embedded in HTML output.</p> <p>\u2014 Jenkins Developer: Content-Security-Policy Compatibility</p> <ul> <li>Default CSP: <code>default-src 'none'</code> - blocks scripts, fonts, iframes, etc.</li> <li>Cannot customize Console Output UI (requires system property modification with admin privileges)</li> <li><code>echo</code> and <code>println</code> are processed identically internally by Jenkins (reference)</li> </ul>"},{"location":"problem-solving/logger-system-design-integration/#115-code-duplication-dry-violation","title":"1.1.5 Code Duplication (DRY Violation)","text":"<pre><code>// generalHelper.groovy line 35-44\nvoid logMessage(String message) { ... }\n\n// jsHelper.groovy line 7-16 (exact same copy)\nvoid logMessage(String message) { ... }\n</code></pre>"},{"location":"problem-solving/logger-system-design-integration/#12-solution-discovering-chunking-units-steps-group","title":"1.2 Solution: Discovering Chunking Units (Steps Group)","text":""},{"location":"problem-solving/logger-system-design-integration/#121-what-is-steps-group","title":"1.2.1 What is Steps Group?","text":"<p>A group where multiple Steps come together to form a meaningful unit of work (Task).</p> <pre><code>Stage: Jenkins Initialization\n\u2502\n\u251c\u2500\u2500 Steps Group: \"Set Up Environment Variables\"  \u2190 Meaningful unit of work\n\u2502   \u251c\u2500\u2500 Step: Configure Report Directory\n\u2502   \u251c\u2500\u2500 Step: Extract ticket number\n\u2502   \u2514\u2500\u2500 Step: Set build parameters\n\u2502\n\u2514\u2500\u2500 Steps Group: \"Send Build Status\"             \u2190 Meaningful unit of work\n    \u251c\u2500\u2500 Step: Prepare API request\n    \u2514\u2500\u2500 Step: POST to Bitbucket API\n</code></pre>"},{"location":"problem-solving/logger-system-design-integration/#122-3-level-logger-design","title":"1.2.2 3-Level Logger Design","text":"<p>Jenkins Provides vs What's Needed:</p> Jenkins Default Actually Needed Stage Level: <code>stage('name') { ... }</code> Stage Level (None) Steps Group Level \u2190 Newly introduced Step Level: <code>sh</code>, <code>echo</code>, <code>withCredentials</code>, etc. Step Level <p>Conclusion: Steps Group level is needed between Stage and Step</p> <p>3-Level Structure:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Level 1: Stage                                              \u2502\n\u2502 ===== STAGE Starting: [ Jenkins Initialization ] =====      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Level 2: Steps Group                                        \u2502\n\u2502 --- STEPS Starting Group: [ Set Up Environment ] ---        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Level 3: Step (by status)                                   \u2502\n\u2502 \u27a1\ufe0f Step Starting: [ Configure Report Directory ]...         \u2502\n\u2502 \ud83d\udcac Step Info: [ REPORT_DIR: /workspace/PRJob ]              \u2502\n\u2502 \ud83c\udfc3 Step Processing: [ Fetching origin branches ]            \u2502\n\u2502 \u2705 Step Completed: [ Configure Report Directory ]           \u2502\n\u2502 \u26a0\ufe0f Step Warning: [ Branch not found, using default ]        \u2502\n\u2502 \u274c Step Failed: [ Git fetch failed ]                        \u2502\n\u2502 \ud83d\udd25 Step Error: [ Exception occurred ]                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Step Status Classification:</p> Status Emoji Usage Starting \u27a1\ufe0f Task start notification Info \ud83d\udcac Informational message (variable values, settings, etc.) Processing \ud83c\udfc3 Task in progress Success \u2705 Task completed successfully Warning \u26a0\ufe0f Warning (can continue) Failed \u274c Task failed (recoverable) Error \ud83d\udd25 Serious error (pipeline stops) <p>Logger API:</p> <pre><code>// Level 1: Stage\nlogger.stageStart(stageName)\nlogger.stageEnd(stageName)\n\n// Level 2: Steps Group\nlogger.stepsGroupStart(groupName)\nlogger.stepsGroupEnd(groupName)\n\n// Level 3: Step (by status)\nlogger.stepStart(description)\nlogger.stepInfo(description)\nlogger.stepProcessing(description)\nlogger.stepSuccess(description)\nlogger.stepWarning(description)\nlogger.stepFailed(description)\nlogger.stepError(description)\nlogger.stepError(description, Throwable)  // Including stack trace\n</code></pre>"},{"location":"problem-solving/logger-system-design-integration/#123-design-result-logging-responsibility-distribution-by-layer","title":"1.2.3 Design Result: Logging Responsibility Distribution by Layer","text":"<p>Introduced a 3-Level chunking-based logging system to the Pipeline domain and integrated with the existing 4-Layer Architecture to implement a systematic solution where each layer only handles logging responsibility appropriate to its role.</p> Component Role Logging Responsibility Logger 3-Level chunking system (Stage/Steps Group/Step) Output format, hierarchy structure definition Library Cognitive classification unit for specific functions within domain Define <code>label</code> appropriate for that function Helper Domain logic orchestration Call logger according to orchestration flow Stage Business workflow Define Steps Group boundaries <p>See Section 2: Architecture Integration for detailed implementation</p>"},{"location":"problem-solving/logger-system-design-integration/#2-architecture-integration","title":"2. Architecture Integration","text":""},{"location":"problem-solving/logger-system-design-integration/#21-position-within-4-layer-architecture","title":"2.1 Position within 4-Layer Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Layer 1: Entry Point (Jenkinsfile)                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Layer 2: Orchestration (vars/stage*.groovy)                 \u2502\n\u2502          \u2193 uses                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Layer 3: Business Logic (src/service/)                      \u2502\n\u2502          \u2193 uses                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Layer 4: Infrastructure                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 src/utils/      \u2502 src/resource/   \u2502 vars/ (Cross)   \u2502   \u2502\n\u2502  \u2502 *Library.groovy \u2502 Status.groovy   \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502   \u2502\n\u2502  \u2502                 \u2502                 \u2502 \u2502 logger      \u2502 \u2502   \u2502\n\u2502  \u2502                 \u2502                 \u2502 \u2502 bitbucket   \u2502 \u2502   \u2502\n\u2502  \u2502                 \u2502                 \u2502 \u2502 ApiLibrary  \u2502 \u2502   \u2502\n\u2502  \u2502                 \u2502                 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Logger's Position: Layer 4 (Infrastructure) - Cross-Cutting Concerns</p>"},{"location":"problem-solving/logger-system-design-integration/#22-library-helper-auto-logging-integration","title":"2.2 Library-Helper Auto Logging Integration","text":"<p>Logger is used system-wide as a Cross-Cutting Concern: - Used by all Stage modules - shellScriptHelper, bitbucketApiHelper internally use logger (auto logging) - Single entry point for unified logging format</p>"},{"location":"problem-solving/logger-system-design-integration/#221-embedding-logging-metadata-in-library","title":"2.2.1 Embedding Logging Metadata in Library","text":""},{"location":"problem-solving/logger-system-design-integration/#a-shell-script-logging-integration","title":"(a) Shell Script Logging Integration","text":"<pre><code>flowchart LR\n    subgraph Libraries[\"Shell Libraries\"]\n        GIT[GitLibrary]\n        SHL[ShellLibrary]\n        SSHL[SSHShellLibrary]\n    end\n\n    subgraph Helper[\"shellScriptHelper\"]\n        VALIDATE[validateShMap]\n        EXEC[execute]\n    end\n\n    subgraph Logger[\"logger\"]\n        START[stepStart]\n        SUCCESS[stepSuccess]\n        FAILED[stepFailed]\n        RESULT[stepShellExecutedResult]\n    end\n\n    GIT --&gt;|\"{script, label}\"| VALIDATE\n    SHL --&gt;|\"{script, label}\"| VALIDATE\n    SSHL --&gt;|\"{script, label}\"| VALIDATE\n\n    VALIDATE --&gt; START\n    VALIDATE --&gt; EXEC\n    EXEC --&gt;|success| SUCCESS\n    EXEC --&gt;|failure| FAILED\n    EXEC --&gt;|result| RESULT</code></pre> <p>Core Design: Each Library's closure includes <code>label</code> metadata for Helper to auto-log</p> <pre><code>// GitLibrary.groovy - Each closure includes script + label\nstatic final Closure FetchOriginReturnStatus = {\n    [\n        script: 'git fetch origin',\n        label: 'Fetch all remote branches from origin',  // \u2190 Logging metadata\n        returnStatus: true\n    ]\n}\n\nstatic final Closure CheckoutBranch = { String branchName -&gt;\n    [\n        script: \"git checkout ${branchName}\",\n        label: \"Checkout branch '${branchName}'\",  // \u2190 Parameterized label\n        returnStdout: true\n    ]\n}\n</code></pre>"},{"location":"problem-solving/logger-system-design-integration/#b-bitbucket-api-logging-integration","title":"(b) Bitbucket API Logging Integration","text":"<pre><code>flowchart LR\n    subgraph Library[\"bitbucketApiLibrary\"]\n        BUILD[createBuildStatus]\n        REPORT[createTestReport]\n    end\n\n    subgraph Helper[\"bitbucketApiHelper\"]\n        CALL[call]\n        HTTP[HttpApiService]\n    end\n\n    subgraph Logger[\"logger\"]\n        START[stepStart]\n        SUCCESS[stepSuccess]\n        ERROR[stepError]\n    end\n\n    BUILD --&gt;|\"{apiUrl, body, method}\"| CALL\n    REPORT --&gt;|\"{apiUrl, body, method}\"| CALL\n\n    CALL --&gt; START\n    CALL --&gt; HTTP\n    HTTP --&gt;|success| SUCCESS\n    HTTP --&gt;|failure| ERROR</code></pre>"},{"location":"problem-solving/logger-system-design-integration/#same-pattern-applied","title":"Same Pattern Applied","text":"Library Metadata Usage GitLibrary <code>script</code>, <code>label</code> Shell command + log message ShellLibrary <code>script</code>, <code>label</code> Shell command + log message SSHShellLibrary <code>script</code>, <code>label</code> SSH command + log message bitbucketApiLibrary <code>apiUrlString</code>, <code>requestBody</code>, <code>method</code> API request info"},{"location":"problem-solving/logger-system-design-integration/#222-helper-auto-logging-with-metadata","title":"2.2.2 Helper Auto Logging with Metadata","text":"<p>shellScriptHelper: Reads <code>label</code> from Library and automatically calls logger</p> <pre><code>// shellScriptHelper.groovy\ndef call(Closure shellScriptClosure, List args = []) {\n    Map shMap = shellScriptClosure(*args)\n    Map validatedShMap = validateShMap(shMap)\n\n    // Read label for auto logging\n    logger.stepStart(\"'${validatedShMap.script}' '${validatedShMap.label}' (Execute)\")\n\n    if (validatedShMap.returnStatus) {\n        return executeReturnStatus(validatedShMap)  // Success/failure logging inside\n    } else if (validatedShMap.returnStdout) {\n        return executeReturnStdout(validatedShMap)  // Result logging inside\n    }\n    // ...\n}\n</code></pre> <p>bitbucketApiHelper: Same pattern for API execution + auto logging</p> <pre><code>// bitbucketApiHelper.groovy\ndef call(Map bitbucketApiMap) {\n    logger.stepStart(\"bitbucketApiHelper execution started\")\n\n    // Execute API with Map received from bitbucketApiLibrary\n    if (bitbucketApiMap.method == 'POST') {\n        return bitbucketApiService.post(\n            bitbucketApiMap.apiUrlString,\n            bitbucketApiMap.requestBody,\n            bitbucketAccessToken\n        )\n    }\n\n    logger.stepSuccess(\"bitbucketApiHelper execution completed\")\n}\n</code></pre>"},{"location":"problem-solving/logger-system-design-integration/#23-integration-with-shellscripthelper","title":"2.3 Integration with shellScriptHelper","text":"<p>shellScriptHelper uses logger internally for auto logging:</p> <pre><code>sequenceDiagram\n    participant Stage as stageProjectPrepare\n    participant SSH as shellScriptHelper\n    participant LOG as logger\n    participant SH as Jenkins sh()\n\n    Stage-&gt;&gt;SSH: execute(GitLibrary.FetchOrigin)\n    SSH-&gt;&gt;LOG: stepStart(\"Fetching origin\")\n    SSH-&gt;&gt;SH: sh(\"git fetch origin\")\n    SH--&gt;&gt;SSH: result\n    alt Success\n        SSH-&gt;&gt;LOG: stepSuccess(\"Origin fetched\")\n    else Failure\n        SSH-&gt;&gt;LOG: stepFailed(\"Fetch failed\")\n    end\n    SSH--&gt;&gt;Stage: result</code></pre> <p>Integration Benefits: - No need to write logging code every time in Stage module - Auto start/success/failure logging when executing Shell commands - Consistent format guaranteed</p>"},{"location":"problem-solving/logger-system-design-integration/#3-beforeafter-comparison","title":"3. Before/After Comparison","text":""},{"location":"problem-solving/logger-system-design-integration/#stage-log-blue-ocean-ui","title":"Stage Log (Blue Ocean UI)","text":"Before After"},{"location":"problem-solving/logger-system-design-integration/#console-log","title":"Console Log","text":"<p>Note: Console screenshot could not be captured, substituting with text.</p>"},{"location":"problem-solving/logger-system-design-integration/#before-scattered-echo","title":"Before (scattered echo)","text":"<pre><code>[Pipeline] echo\n2025-03-20T10:23:45.123Z Fetching origin...\n[Pipeline] sh\n2025-03-20T10:23:45.456Z + git fetch origin\n[Pipeline] echo\n2025-03-20T10:23:46.789Z REPORT_DIR: /workspace/PRJob/feature-branch\n[Pipeline] echo\n2025-03-20T10:23:47.012Z Sending build status to Bitbucket\n</code></pre> <p>Problems: All messages at same level, no structure, difficult to trace errors</p>"},{"location":"problem-solving/logger-system-design-integration/#after-3-level-logger","title":"After (3-Level Logger)","text":"<pre><code>===== STAGE Starting: [ Jenkins Initialization ] =====\n--- STEPS Starting Group: [ Set Up Environment Variables ] ---\n\u27a1\ufe0f Step Starting: [ Configure Report Directory ]...\n\ud83d\udcac Step Info: [ REPORT_DIR: /workspace/PRJob/feature-branch ]\n\u2705 Step Completed: [ Configure Report Directory ]\n--- STEPS Completed Group: [ Set Up Environment Variables ] ---\n===== STAGE Completed: [ Jenkins Initialization ] =====\n</code></pre>"},{"location":"problem-solving/logger-system-design-integration/#change-summary","title":"Change Summary","text":"Item Before After Logging function location generalHelper, jsHelper (copied) logger.groovy (single) Format consistency None 100% Error traceability Difficult Immediate identification"},{"location":"problem-solving/logger-system-design-integration/#reference","title":"Reference","text":"<ul> <li>Phase 2 Changelog - Detailed implementation process record</li> <li>highlights.md - Logger System Integration section</li> <li>refactoring-result-snapshot.md - Facade Pattern explanation</li> </ul>"},{"location":"problem-solving/pull-request-documentation/","title":"Pull Request Documentation","text":"<p>Documentation attached to the Pull Request for Jenkins Shared Library refactoring.</p>"},{"location":"problem-solving/solution-by-feature/","title":"Solution by Feature","text":"<p>Feature-by-feature breakdown of the refactoring changes.</p> <p>For layer-by-layer architecture analysis, see solution-by-layer.md. For high-level overview, see README.md.</p>"},{"location":"problem-solving/solution-by-feature/#reference-commits","title":"Reference Commits","text":"State Commit Hash Date Baseline (Before) <code>74fc356</code> 2025-03-20 Final (After) <code>ff74ac8</code> 2025-05-12"},{"location":"problem-solving/solution-by-feature/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Bitbucket API Migration</li> <li>Shell Script Libraries</li> <li>Stage Modularization</li> <li>Testability</li> <li>Logger System Integration</li> <li>Reference</li> </ul>"},{"location":"problem-solving/solution-by-feature/#1-bitbucket-api-migration","title":"1. Bitbucket API Migration","text":"<p>Migrated from Python subprocess to Native Groovy/Java HTTP Client.</p>"},{"location":"problem-solving/solution-by-feature/#11-folder-structure-comparison","title":"1.1 Folder Structure Comparison","text":"<pre><code>Before (74fc356)                          After (ff74ac8)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                         \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\ndevops-jenkins-linux/                     devops-jenkins-linux/\n\u251c\u2500\u2500 DLXJenkins/                           \u251c\u2500\u2500 DLXJenkins/\n\u2502   \u2514\u2500\u2500 Jenkinsfile \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502   \u2514\u2500\u2500 Jenkinsfile \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u251c\u2500\u2500 groovy/                     \u2502         \u2514\u2500\u2500 sharedLibraries/                          \u2502\n\u2502   \u2514\u2500\u2500 generalHelper.groovy \u2190\u2500\u2500\u2524             \u251c\u2500\u2500 vars/                                 \u2502\n\u2514\u2500\u2500 python/                     \u2502             \u2502   \u251c\u2500\u2500 bitbucketApiHelper.groovy \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n    \u2514\u2500\u2500 send_bitbucket_build_   \u2502             \u2502   \u2514\u2500\u2500 bitbucketApiLibrary.groovy \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n        status.py \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2514\u2500\u2500 src/service/general/                  \u2502\n                                                  \u2514\u2500\u2500 HttpApiService.groovy \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                     (formerly BitbucketApiService)\n</code></pre>"},{"location":"problem-solving/solution-by-feature/#12-before-74fc356","title":"1.2 Before (<code>74fc356</code>)","text":"<pre><code>sequenceDiagram\n    participant JF as Jenkinsfile\n    participant GH as generalHelper.groovy\n    participant SH as sh (Shell)\n    participant PY as Python Script\n    participant BB as Bitbucket API\n\n    JF-&gt;&gt;GH: sendBuildStatus(workspace, 'INPROGRESS', commitHash)\n    GH-&gt;&gt;SH: sh \"python send_bitbucket_build_status.py ...\"\n    SH-&gt;&gt;PY: spawn process\n    PY-&gt;&gt;PY: Prepare requests.post()\n    PY-&gt;&gt;BB: HTTP POST /commit/{hash}/statuses/build\n    BB--&gt;&gt;PY: 200 OK\n    PY--&gt;&gt;SH: exit 0\n    SH--&gt;&gt;GH: return\n    GH--&gt;&gt;JF: return</code></pre> <p>Code Path: - <code>DLXJenkins/Jenkinsfile</code> \u2192 <code>groovy/generalHelper.groovy:sendBuildStatus()</code> \u2192 <code>python/send_bitbucket_build_status.py</code></p> <p>Problems: - Python process spawn overhead - External dependency (requests library) - Distributed error handling</p>"},{"location":"problem-solving/solution-by-feature/#13-after-ff74ac8","title":"1.3 After (<code>ff74ac8</code>)","text":"<pre><code>sequenceDiagram\n    participant JF as Jenkinsfile\n    participant BAL as bitbucketApiLibrary\n    participant BAH as bitbucketApiHelper\n    participant HAS as HttpApiService\n    participant HC as Apache HttpClient\n    participant BB as Bitbucket API\n\n    JF-&gt;&gt;BAL: createBuildStatusForCommit(status, description)\n    BAL--&gt;&gt;JF: return {apiUrlString, requestBody, method}\n    JF-&gt;&gt;BAH: bitbucketApiHelper(apiMap)\n    BAH-&gt;&gt;HAS: new HttpApiService(this)\n    BAH-&gt;&gt;HAS: post(apiUrlString, requestBody, token)\n    HAS-&gt;&gt;HAS: executeRequest(HttpPost, token)\n    HAS-&gt;&gt;HC: httpClient.execute(request)\n    HC-&gt;&gt;BB: HTTP POST /commit/{hash}/statuses/build\n    BB--&gt;&gt;HC: 200 OK\n    HC--&gt;&gt;HAS: CloseableHttpResponse\n    HAS--&gt;&gt;BAH: {statusCode, body}\n    BAH--&gt;&gt;JF: return result</code></pre> <p>Note: <code>HttpApiService</code> was initially named <code>BitbucketApiService</code>, later renamed for generalization.</p> <p>Code Path: <pre><code>Jenkinsfile (post block)\n  \u2192 bitbucketApiLibrary.createBuildStatusForCommit()  // returns Map\n  \u2192 bitbucketApiHelper(Map)                           // entry point\n    \u2192 HttpApiService.post()                           // HTTP execution\n      \u2192 executeRequest()                              // error handling\n</code></pre></p> <p>Improvements: - HTTP processing within JVM (no process spawn) - Structured error handling (Exception hierarchy) - Reusable API Service class</p>"},{"location":"problem-solving/solution-by-feature/#14-design-decisions","title":"1.4 Design Decisions","text":""},{"location":"problem-solving/solution-by-feature/#problem-situation","title":"Problem Situation","text":"<ul> <li>Time-consuming to diagnose Bitbucket API communication failures when Jenkins service URL's third-party certificate expired</li> <li>Inconsistent error handling across Python scripts</li> <li>No distinction between network error types</li> </ul>"},{"location":"problem-solving/solution-by-feature/#solution-centralized-error-handling","title":"Solution: Centralized Error Handling","text":"<p><code>HttpApiService.executeRequest()</code> classifies all HTTP request errors by type:</p> Exception Cause Log Message <code>UnknownHostException</code> DNS/URL issue \"Unable to resolve host\" <code>ConnectException</code> TCP connection failure \"Failed to establish TCP connection\" <code>SocketTimeoutException</code> Network timeout \"Connection timed out\" <code>SSLHandshakeException</code> Certificate error \"TLS Handshake failed - possible certificate error\" <code>ConnectionClosedException</code> Premature connection closure \"Connection closed prematurely\" <code>IOException</code> General I/O error \"I/O error occurred\""},{"location":"problem-solving/solution-by-feature/#structure","title":"Structure","text":"<pre><code>flowchart LR\n    BAL[bitbucketApiLibrary&lt;br/&gt;API request definition]\n    BAH[bitbucketApiHelper&lt;br/&gt;API call entry point]\n    HAS[HttpApiService&lt;br/&gt;HTTP + error handling]\n    LOG[logger&lt;br/&gt;Immediate output]\n\n    BAL --&gt; BAH --&gt; HAS --&gt; LOG</code></pre>"},{"location":"problem-solving/solution-by-feature/#2-shell-script-libraries","title":"2. Shell Script Libraries","text":"<p>Library system abstracting shell commands using Closure pattern. Three domain-specific Libraries: Git, Shell, SSH.</p>"},{"location":"problem-solving/solution-by-feature/#21-file-structure","title":"2.1 File Structure","text":"<pre><code>sharedLibraries/\n\u251c\u2500\u2500 vars/\n\u2502   \u2514\u2500\u2500 shellScriptHelper.groovy      \u2190 Closure execution + logging integration\n\u2502       \u251c\u2500\u2500 call(Closure, List args)\n\u2502       \u251c\u2500\u2500 validateShMap(Map)\n\u2502       \u251c\u2500\u2500 executeReturnStatus(Map)\n\u2502       \u251c\u2500\u2500 executeReturnStdout(Map)\n\u2502       \u2514\u2500\u2500 executeReturnVoid(Map)\n\u2502\n\u2514\u2500\u2500 src/utils/\n    \u251c\u2500\u2500 GitLibrary.groovy (258 lines)     \u2190 Git command Closures (23)\n    \u251c\u2500\u2500 ShellLibrary.groovy (210 lines)   \u2190 General shell command Closures (15)\n    \u2514\u2500\u2500 SSHShellLibrary.groovy (99 lines) \u2190 SSH/SCP remote command Closures (8)\n</code></pre>"},{"location":"problem-solving/solution-by-feature/#22-closure-pattern-structure","title":"2.2 Closure Pattern Structure","text":"<pre><code>classDiagram\n    class shellScriptHelper {\n        +call(Closure, List args)\n        -validateShMap(Map)\n        -executeReturnStatus(Map)\n        -executeReturnStdout(Map)\n        -executeReturnVoid(Map)\n    }\n\n    class GitLibrary {\n        &lt;&lt;static&gt;&gt;\n        +Closure FetchOrigin\n        +Closure FetchBranch\n        +Closure GetRemoteBranchHash\n        +Closure CheckoutBranch\n        +Closure MergeOriginBranch\n        +Closure LfsFetchAndCheckout\n        ... (23 Closures)\n    }\n\n    class ShellLibrary {\n        &lt;&lt;static&gt;&gt;\n        +Closure PrintJenkinsEnv\n        +Closure GroovyLint\n        +Closure LintUnity\n        +Closure GetUnityExecutable\n        +Closure CreateBitbucketBuildReport\n        ... (15 Closures)\n    }\n\n    class SSHShellLibrary {\n        &lt;&lt;static&gt;&gt;\n        +Closure CleanMergedPRBranchFromHostServer\n        +Closure CopyBuildToHostServer\n        +Closure UpdateBuildURL\n        +Closure CheckSSHConnectivity\n        ... (8 Closures)\n    }\n\n    shellScriptHelper --&gt; GitLibrary : uses\n    shellScriptHelper --&gt; ShellLibrary : uses\n    shellScriptHelper --&gt; SSHShellLibrary : uses</code></pre>"},{"location":"problem-solving/solution-by-feature/#23-before-74fc356","title":"2.3 Before (<code>74fc356</code>)","text":"<pre><code>sequenceDiagram\n    participant JF as Jenkinsfile\n    participant SH as sh (Shell)\n\n    JF-&gt;&gt;SH: sh 'git fetch origin'\n    SH--&gt;&gt;JF: return\n    JF-&gt;&gt;SH: sh \"git checkout ${branch}\"\n    SH--&gt;&gt;JF: return\n    JF-&gt;&gt;SH: sh 'git reset --hard'\n    SH--&gt;&gt;JF: return\n    JF-&gt;&gt;SH: sh 'git clean -fd'\n    SH--&gt;&gt;JF: return\n    JF-&gt;&gt;SH: sh \"git reset --hard origin/${branch}\"\n    SH--&gt;&gt;JF: return\n    JF-&gt;&gt;SH: sh 'git pull'\n    SH--&gt;&gt;JF: return</code></pre> <p>Problems: - Same git commands duplicated across multiple pipelines - No error handling - No logging - Untestable</p>"},{"location":"problem-solving/solution-by-feature/#24-after-ff74ac8","title":"2.4 After (<code>ff74ac8</code>)","text":"<pre><code>sequenceDiagram\n    participant Caller\n    participant SSH as shellScriptHelper\n    participant LIB as *Library (Git/Shell/SSH)\n    participant LOG as logger\n    participant SH as sh\n\n    Caller-&gt;&gt;SSH: shellScriptHelper(GitLibrary.CheckoutBranch, ['feature-branch'])\n    SSH-&gt;&gt;LIB: CheckoutBranch('feature-branch')\n    LIB--&gt;&gt;SSH: {script: \"git checkout feature-branch\", label: \"...\", returnStdout: true}\n    SSH-&gt;&gt;SSH: validateShMap(paramsMap)\n    SSH-&gt;&gt;LOG: stepStart('[ShellScript] Checkout branch')\n    SSH-&gt;&gt;SH: sh([script: \"git checkout feature-branch\", ...])\n    SH--&gt;&gt;SSH: \"Switched to branch 'feature-branch'\"\n    SSH-&gt;&gt;LOG: stepShellExecutedResult(output)\n    SSH--&gt;&gt;Caller: return \"Switched to branch 'feature-branch'\"</code></pre> <p>Improvements: - Shell command reuse through Closure pattern - Automatic logging integration - Consistent error handling - Centralized validation logic</p>"},{"location":"problem-solving/solution-by-feature/#25-closure-list-by-library","title":"2.5 Closure List by Library","text":"GitLibrary (23 Closures) - Git Version Control  | Closure | Parameters | Return Type | Purpose | |---------|------------|-------------|---------| | `FetchOrigin` | - | void | Fetch origin | | `FetchBranch` | branchName | void | Fetch specific branch | | `GetRemoteBranchHash` | branchName | stdout | Remote branch commit hash | | `CloneRepository` | gitUrl, projectDir | void | Clone repository | | `ShowCurrentBranch` | - | stdout | Current branch name | | `RemoveIndexLock` | - | void | Remove .git/index.lock | | `ResetHardHead` | - | stdout | Hard reset to HEAD | | `CleanUntracked` | - | stdout | Delete untracked files | | `CheckoutBranch` | branchName | stdout | Checkout branch | | `ResetHardOriginBranch` | branchName | stdout | Reset to origin branch | | `Pull` | - | stdout | Git pull | | `GetOriginDefaultBranch` | - | stdout | Default branch name | | `CheckOriginBranchExists` | branchName | status | Check remote branch exists | | `CheckBranchExists` | targetBranch | status | Check local branch exists | | `CheckUpToDateWithRemote` | branchName | status | Check sync with remote | | `CheckIsRemoteBranchAncestor` | remoteBranchName | status | Check ancestor branch | | `MergeOriginBranch` | branchToMerge | status | Merge remote branch | | `LfsFetchAndCheckout` | - | status | LFS file fetch &amp; checkout |   ShellLibrary (15 Closures) - General Shell Commands  | Closure | Parameters | Return Type | Purpose | |---------|------------|-------------|---------| | `PrintJenkinsEnv` | - | stdout | Print environment variables | | `FindPRJobDirectory` | workingDir, prBranch | stdout | Search PR Job directory | | `FindProjectDirectory` | workingDir, projectType | status | Search project directory | | `DockerInfo` | - | stdout | Print Docker info | | `GroovyLint` | reportFile, configFile, targetDir, desc | status | Groovy linting | | `GetUnityExecutable` | workspace, projectDir | stdout | Unity executable path | | `CreateLintingResultsDir` | workingDir | status | Create linting results directory | | `CopyWebGLBuilder` | projectDir | status | Copy WebGL Builder | | `CopyLintConfig` | workingDir, projectDir | status | Copy .editorconfig | | `LintUnity` | workingDir, projectDir, reportDir | status | Unity project linting | | `ExecutePythonStatusReport` | workingDir, projectDir, reportDir, status, commit | stdout | Python status report | | `CreateBitbucketBuildReport` | workspace, commit, logPath, debugMode | status | Bitbucket build report | | `CreateBitbucketTestReport` | workspace, commitHash, reportDir | status | Bitbucket test report |   SSHShellLibrary (8 Closures) - SSH/SCP Remote Commands  | Closure | Parameters | Return Type | Purpose | |---------|------------|-------------|---------| | `CleanMergedPRBranchFromHostServer` | folderName, ticketNumber, sshKey, hostUrl | stdout | Clean PR branch artifacts | | `CreateDirectoryAndSetPermission` | folderName, sshKey, hostUrl | status | Create remote directory | | `CopyBuildToHostServer` | folderName, sshKey, hostUrl, projectDir | status | SCP build transfer | | `UpdateBuildURL` | folderName, sshKey, hostUrl | status | Update build URL | | `CreateDirectoryAndSetPermissionForEconestogaDlxServer` | folderName, sshKey, econestogaUrl | status | Econestoga server directory creation | | `CopyBuildToEconestogaDlxServer` | folderName, sshKey, econestogaUrl, projectDir | status | Econestoga server SCP transfer | | `UpdateBuildURLForEconestogaDlxServer` | folderName, sshKey, econestogaUrl | status | Econestoga URL update | | `CheckSSHConnectivity` | sshKey, hostUrl | stdout | SSH connection test |"},{"location":"problem-solving/solution-by-feature/#26-closure-map-schema","title":"2.6 Closure Map Schema","text":"<pre><code>[\n    script: String,        // (Required) Shell script to execute\n    label: String,         // (Required) Description shown in Jenkins build log\n    returnStdout: Boolean, // (Optional) Return stdout\n    returnStatus: Boolean, // (Optional) Return exit code\n    returnStderr: Boolean, // (Optional) Return stderr\n    encoding: String       // (Optional) Encoding (default: UTF-8)\n]\n</code></pre> <p>Constraint: Only one of <code>returnStdout</code>, <code>returnStatus</code>, <code>returnStderr</code> can be true</p>"},{"location":"problem-solving/solution-by-feature/#27-design-decisions","title":"2.7 Design Decisions","text":""},{"location":"problem-solving/solution-by-feature/#pattern-identification","title":"Pattern Identification","text":"<p>Analysis of all <code>sh</code> calls across pipelines revealed three domains:</p> Domain Library Purpose Git GitLibrary Version control commands (fetch, checkout, merge, etc.) Shell ShellLibrary General system commands (lint, copy, mkdir, etc.) SSH SSHShellLibrary Remote server commands (scp, ssh, etc.)"},{"location":"problem-solving/solution-by-feature/#logger-system-integration","title":"Logger System Integration","text":"<p>Clear return type rules enable automatic logging in <code>shellScriptHelper</code>:</p> <pre><code>flowchart LR\n    LIB[*Library&lt;br/&gt;Closure Map]\n    SSH[shellScriptHelper&lt;br/&gt;Execute + Validate]\n    LOG[logger&lt;br/&gt;Auto logging]\n\n    LIB --&gt; SSH --&gt; LOG</code></pre> <ul> <li>Success: Call <code>stepSuccess()</code></li> <li>Failure: Call <code>stepError()</code> (pipeline abort)</li> <li>Warning: Call <code>stepWarning()</code> (specific status codes)</li> </ul>"},{"location":"problem-solving/solution-by-feature/#3-stage-modularization","title":"3. Stage Modularization","text":""},{"location":"problem-solving/solution-by-feature/#31-folder-structure-comparison-linting-stage-example","title":"3.1 Folder Structure Comparison (Linting Stage Example)","text":"<pre><code>Before (74fc356)                                    After (ff74ac8)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\ndevops-jenkins-linux/                               devops-jenkins-linux/\n\u251c\u2500\u2500 DLXJenkins/                                     \u251c\u2500\u2500 DLXJenkins/\n\u2502   \u251c\u2500\u2500 Jenkinsfile                                 \u2502   \u251c\u2500\u2500 Jenkinsfile\n\u2502   \u2502   stage('Linting') {Inline/Duplicated}        \u2502   \u2502   stage('Linting') { stageLintUnity() }\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment                       \u2502   \u2514\u2500\u2500 JenkinsfileDeployment\n\u2502       stage('Linting') {Inline/Duplicated}        \u2502       stage('Linting') { stageLintUnity() }\n\u251c\u2500\u2500 JsJenkins/                                      \u251c\u2500\u2500 JsJenkins/\n\u2502   \u251c\u2500\u2500 Jenkinsfile                                 \u2502   \u251c\u2500\u2500 Jenkinsfile\n\u2502   \u2502   stage('Linting') {Inline/Duplicated}        \u2502   \u2502   stage('Linting') { stageLintJs() } *\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment                       \u2502   \u2514\u2500\u2500 JenkinsfileDeployment\n\u2502       stage('Linting') {Inline/Duplicated}        \u2502       stage('Linting') { stageLintJs() } *\n\u251c\u2500\u2500 PipelineForJenkins/                             \u251c\u2500\u2500 PipelineForJenkins/\n\u2502   \u2514\u2500\u2500 Jenkinsfile                                 \u2502   \u2514\u2500\u2500 Jenkinsfile\n\u2502       stage('Lint Groovy Code') {                 \u2502       stage('Lint Groovy Code') {\n\u2502           Inline/Duplicated }                     \u2502           stageLintGroovyJenkinsfile() }\n\u2502                                                   \u2502\n\u2514\u2500\u2500 groovy/                                         \u2514\u2500\u2500 sharedLibraries/vars/\n    \u251c\u2500\u2500 generalHelper.groovy                            \u251c\u2500\u2500 stageLintUnity.groovy\n    \u2514\u2500\u2500 unityHelper.groovy                              \u251c\u2500\u2500 stageLintJs.groovy *\n                                                        \u2514\u2500\u2500 stageLintGroovyJenkinsfile.groovy\n</code></pre> <p>*stageLintJs is not yet developed</p>"},{"location":"problem-solving/solution-by-feature/#32-linting-stage-example","title":"3.2 Linting Stage Example","text":""},{"location":"problem-solving/solution-by-feature/#before-74fc356-50-lines","title":"Before (<code>74fc356</code>) - ~50 lines","text":"<pre><code>sequenceDiagram\n    participant JF as Jenkinsfile\n    participant SH as sh\n    participant PY as Python\n\n    JF-&gt;&gt;SH: sh 'mkdir -p linting_results'\n    JF-&gt;&gt;SH: sh \"cp -f .editorconfig ...\"\n    JF-&gt;&gt;SH: sh \"Linting.bash ${PROJECT_DIR} ${REPORT_DIR}\"\n    SH--&gt;&gt;JF: exitCode\n\n    alt exitCode != 0\n        JF-&gt;&gt;JF: echo 'Error linting'\n        alt exitCode == 2\n            JF-&gt;&gt;SH: sh \"python linting_error_report.py ... ${fail}\"\n            SH-&gt;&gt;PY: spawn\n            PY--&gt;&gt;SH: exit\n        end\n        JF-&gt;&gt;JF: catchError { error(\"Linting failed\") }\n    else exitCode == 0\n        JF-&gt;&gt;SH: sh \"python linting_error_report.py ... ${pass}\"\n        SH-&gt;&gt;PY: spawn\n        PY--&gt;&gt;SH: exit\n    end</code></pre> <p>Problems: - Same Stage logic Inline/Duplicated across 5 pipelines - Modifications require changes in all 5 places - No logging, untestable</p>"},{"location":"problem-solving/solution-by-feature/#after-ff74ac8-1-line","title":"After (<code>ff74ac8</code>) - 1 line","text":"<pre><code>sequenceDiagram\n    participant JF as Jenkinsfile\n    participant SLU as stageLintUnity\n    participant LOG as logger\n    participant SSH as shellScriptHelper\n\n    JF-&gt;&gt;SLU: stageLintUnity()\n    SLU-&gt;&gt;LOG: stageStart('Linting')\n    SLU-&gt;&gt;LOG: stepsGroupStart('Setup')\n    SLU-&gt;&gt;SSH: shellScriptHelper(...)\n    SSH--&gt;&gt;SLU: return\n    SLU-&gt;&gt;LOG: stepsGroupEnd('Setup')\n    SLU-&gt;&gt;LOG: stepsGroupStart('Execute Lint')\n    SLU-&gt;&gt;SSH: shellScriptHelper(...)\n    SSH--&gt;&gt;SLU: exitCode\n    SLU-&gt;&gt;LOG: stepsGroupEnd('Execute Lint')\n    SLU-&gt;&gt;LOG: stageEnd('Linting')\n    SLU--&gt;&gt;JF: return</code></pre> <p>Improvements: - Stage logic separated into module files (<code>stage*.groovy</code>) - Pipeline calls replaced with 1-line invocation - Automatic Logger system integration - Single Source of Truth</p>"},{"location":"problem-solving/solution-by-feature/#33-complete-stage-modularization-design","title":"3.3 Complete Stage Modularization Design","text":"Before/After Stage Mapping (Click to expand) <pre><code>Before (74fc356)                                    After (ff74ac8)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nDLXJenkins/Jenkinsfile                              DLXJenkins/Jenkinsfile\n\u251c\u2500\u2500 stage('Prepare WORKSPACE')                      \u251c\u2500\u2500 stage('Jenkins Initialization') { stageInitialization() }\n\u251c\u2500\u2500 stage('Linting')                                \u251c\u2500\u2500 stage('Prepare Project') { stageProjectPrepare() }\n\u251c\u2500\u2500 stage('EditMode Tests')                         \u251c\u2500\u2500 stage('Linting') { stageLintUnity() }\n\u251c\u2500\u2500 stage('PlayMode Tests in Editor')               \u251c\u2500\u2500 stage('Unity Execution') { stageUnityExecution() }\n\u251c\u2500\u2500 stage('Code Coverage Send Reports')             \u2514\u2500\u2500 stage('Send Build Results') { stageSendBuildResults() }\n\u2514\u2500\u2500 stage('Build Project')\n                                                    DLXJenkins/JenkinsfileDeployment\nDLXJenkins/JenkinsfileDeployment                    \u251c\u2500\u2500 stage('Cleanup PR Branch Artifacts') { stageCleanupPRBranchArtifacts() }\n\u251c\u2500\u2500 stage('Delete Merged Branch')                   \u251c\u2500\u2500 stage('Jenkins Initialization') { stageInitialization() }\n\u251c\u2500\u2500 stage('Prepare WORKSPACE')                      \u251c\u2500\u2500 stage('Prepare Project') { stageProjectPrepare() }\n\u251c\u2500\u2500 stage('Linting')                                \u251c\u2500\u2500 stage('Linting') { stageLintUnity() }\n\u251c\u2500\u2500 stage('EditMode Tests')                         \u251c\u2500\u2500 stage('Unity Execution') { stageUnityExecution() }\n\u251c\u2500\u2500 stage('PlayMode Tests In Editor')               \u251c\u2500\u2500 stage('Deploy Build') { stageDeployBuild() }\n\u251c\u2500\u2500 stage('Build Project')                          \u2514\u2500\u2500 stage('Send Build Results') { stageSendBuildResults() }\n\u2514\u2500\u2500 stage('Deploy Build')\n\ngroovy/                                             sharedLibraries/vars/\n\u251c\u2500\u2500 generalHelper.groovy                            \u251c\u2500\u2500 stageInitialization.groovy\n\u251c\u2500\u2500 jsHelper.groovy                                 \u251c\u2500\u2500 stageProjectPrepare.groovy\n\u2514\u2500\u2500 unityHelper.groovy                              \u251c\u2500\u2500 stageLintUnity.groovy\n                                                    \u251c\u2500\u2500 stageLintGroovyJenkinsfile.groovy\n                                                    \u251c\u2500\u2500 stageStaticAnalysis.groovy\n                                                    \u251c\u2500\u2500 stageUnityExecution.groovy\n                                                    \u251c\u2500\u2500 stageDeployBuild.groovy\n                                                    \u251c\u2500\u2500 stageCleanupPRBranchArtifacts.groovy\n                                                    \u2514\u2500\u2500 stageSendBuildResults.groovy\n</code></pre>"},{"location":"problem-solving/solution-by-feature/#4-testability","title":"4. Testability","text":"<p>One of the core goals of refactoring was to transition to a structure that enables unit testing.</p>"},{"location":"problem-solving/solution-by-feature/#41-before-helper-python-script-structure","title":"4.1 Before: Helper + Python Script Structure","text":"<p>2 untestable patterns existed:</p> <p>Pattern 1: Direct <code>sh()</code> calls in Helper</p> <pre><code>// groovy/generalHelper.groovy (Before - commit 74fc356)\nvoid checkoutBranch(String prBranch) {\n    sh(script: \"git checkout ${prBranch}\", returnStdout: true)  // Direct Jenkins DSL call\n    echo \"Checked out branch: ${prBranch}\"                       // Direct Jenkins DSL call\n}\n</code></pre> File Lines Role generalHelper.groovy 403 lines 21 functions, 8 domains mixed jsHelper.groovy 408 lines JS build, Python wrappers unityHelper.groovy 337 lines Unity build Total 1,148 lines Testable: 1 function <p>Pattern 2: API calls via Python scripts</p> <pre><code># python/send_bitbucket_build_status.py (Before)\nimport requests\nimport os\n\naccess_token = os.getenv('BITBUCKET_ACCESS_TOKEN')\nurl = f'{pr_repo}/commit/{args[\"pr-commit\"]}/statuses/build'\nresponse = requests.post(url, data=build_status, headers=headers)\n</code></pre> <p>Reasons for Being Untestable:</p> Before Structure Problem Helper: Direct <code>sh()</code> call Requires Jenkins DSL, cannot mock Python: <code>os.getenv()</code> Environment variable dependency, difficult to isolate Python: <code>requests.post()</code> Direct HTTP execution, complex mocking Jenkins: <code>sh \"python3 ...\"</code> External process call, integration test only"},{"location":"problem-solving/solution-by-feature/#42-after-library-service-separation","title":"4.2 After: Library + Service Separation","text":"<p>Core Change: \"Definition\" and \"Execution\" separation + Dependency Injection</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Library (src/utils/)                                                \u2502\n\u2502 \u2192 Shell command \"definition\" (returns Map)                          \u2502\n\u2502 \u2192 No Jenkins dependency                                             \u2502\n\u2502 \u2192 \u2705 100% unit testable                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Service (src/service/)                                              \u2502\n\u2502 \u2192 Business logic + API calls                                        \u2502\n\u2502 \u2192 Mock-friendly constructor (receives context, uses only logger)    \u2502\n\u2502 \u2192 \u2705 Testable with mocks                                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Helper (vars/)                                                      \u2502\n\u2502 \u2192 Command \"execution\" (sh calls)                                    \u2502\n\u2502 \u2192 Jenkins DSL orchestration                                         \u2502\n\u2502 \u2192 \u26a0\ufe0f Integration test                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"problem-solving/solution-by-feature/#library-shell-command-definition-map-return","title":"Library: Shell Command Definition (Map Return)","text":"<pre><code>// src/utils/GitLibrary.groovy\nclass GitLibrary {\n    static final Closure CheckoutBranch = { String branchName -&gt;\n        [\n            script: \"git checkout ${branchName}\",\n            label: \"Checkout branch '${branchName}'\",\n            returnStdout: true\n        ]\n    }\n}\n</code></pre>"},{"location":"problem-solving/solution-by-feature/#service-api-call-logic-mock-friendly-constructor","title":"Service: API Call Logic (Mock-friendly Constructor)","text":"<pre><code>// src/service/general/HttpApiService.groovy\nclass HttpApiService {\n    def jenkinsfile\n    def logger  // Only dependency actually used\n\n    HttpApiService(def jenkinsfile) {\n        this.jenkinsfile = jenkinsfile\n        this.logger = jenkinsfile.logger\n    }\n\n    def post(String apiUrlString, String requestBodyJson, String bearerToken) {\n        HttpPost httpPost = new HttpPost(apiUrlString)\n        return executeRequest(httpPost, bearerToken)\n    }\n}\n</code></pre> <p>Why \"Mock-friendly\": The constructor receives pipeline context, but internally only uses <code>logger</code>. For testing, simply pass a mock object:</p> <pre><code>def mockJenkinsfile = [logger: mockLogger]\ndef service = new HttpApiService(mockJenkinsfile)\n// Now service is fully testable without Jenkins environment\n</code></pre>"},{"location":"problem-solving/solution-by-feature/#43-test-code-examples","title":"4.3 Test Code Examples","text":"<p>Library Test - Pure unit test without Jenkins:</p> <pre><code>// GitLibrarySpec.groovy\nclass GitLibrarySpec extends Specification {\n    def \"CheckoutBranch - branch name correctly inserted into script\"() {\n        when:\n        def result = GitLibrary.CheckoutBranch('feature/JIRA-123')\n\n        then:\n        result.script == \"git checkout feature/JIRA-123\"\n        result.label == \"Checkout branch 'feature/JIRA-123'\"\n        result.returnStdout == true\n    }\n}\n</code></pre>"},{"location":"problem-solving/solution-by-feature/#44-before-vs-after-api-testability-comparison","title":"4.4 Before vs After: API Testability Comparison","text":"Item Before (Python) After (HttpApiService) Structure 9 CLI scripts 1 Service class Test Method Integration only Unit + Integration Mock Complexity High (process isolation) Low (mock logger only) Reusability Low (copy-paste) High (DI) Lines of Code ~1,484 lines 172 lines"},{"location":"problem-solving/solution-by-feature/#5-logger-system-integration","title":"5. Logger System Integration","text":"<p>For detailed design documentation including problem analysis, solution discovery, and architecture integration, see logger-system-design-integration.md.</p>"},{"location":"problem-solving/solution-by-feature/#summary","title":"Summary","text":"Aspect Implementation Structure 3-Level hierarchy: Stage \u2192 Steps Group \u2192 Step Visual Indicators Emoji-based status (\u2705 \u27a1\ufe0f \u26a0\ufe0f \u274c \ud83d\udd25) Integration Auto-logging via shellScriptHelper and bitbucketApiHelper Benefit Consistent format, immediate error tracing"},{"location":"problem-solving/solution-by-feature/#beforeafter","title":"Before/After","text":"Before (<code>74fc356</code>) After (<code>ff74ac8</code>) Scattered <code>echo</code> calls Centralized <code>logger.groovy</code> No hierarchy Stage \u2192 Steps Group \u2192 Step Inconsistent format Emoji + delimiter based formatting Error location unclear Immediate identification"},{"location":"problem-solving/solution-by-feature/#6-reference","title":"6. Reference","text":""},{"location":"problem-solving/solution-by-feature/#repository","title":"Repository","text":"<ul> <li>GitHub: <code>https://github.com/JindoKimKor/devops-jenkins-linux</code></li> </ul>"},{"location":"problem-solving/solution-by-feature/#related-documents","title":"Related Documents","text":"<ul> <li>solution-by-layer.md - Layer-by-layer architecture analysis</li> <li>logger-system-design-integration.md - Logger System design details</li> <li>domain-driven-analysis.md - DDD pattern analysis</li> </ul>"},{"location":"problem-solving/solution-by-layer/","title":"Solution by Layer","text":"<p>Layer-by-layer architecture analysis of the refactored codebase.</p> <p>For feature-by-feature breakdown, see solution-by-feature.md. For high-level overview, see README.md.</p>"},{"location":"problem-solving/solution-by-layer/#reference-commit","title":"Reference Commit","text":"State Commit Hash Date Final <code>ff74ac8</code> 2025-05-12"},{"location":"problem-solving/solution-by-layer/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Overview</li> <li>Complete File Structure</li> <li>Folder-by-Folder Analysis</li> <li>Design Patterns Applied</li> <li>Current State Summary</li> <li>Reference</li> </ul>"},{"location":"problem-solving/solution-by-layer/#1-overview","title":"1. Overview","text":""},{"location":"problem-solving/solution-by-layer/#11-file-statistics","title":"1.1 File Statistics","text":"Category Files Lines (approx) Status sharedLibraries/vars/ 13 1,104 NEW - Pipeline stages sharedLibraries/src/ 5 1,047 NEW - Core business logic groovy/ 3 1,824 Legacy (being migrated) DLXJenkins/ 2 286 Refactored JsJenkins/ 2 743 Being Refactored PipelineForJenkins/ 1 185 Being Refactored python/ 15 2,069 Legacy (to be eliminated) Bash/ 2 330 Shell scripts tests/ 5 200 NEW - Unit tests TOTAL 48 7,788"},{"location":"problem-solving/solution-by-layer/#12-architecture-summary","title":"1.2 Architecture Summary","text":"<p>The refactored codebase implements a 4-Layer Architecture with clear separation of concerns:</p> <pre><code>flowchart TB\n    subgraph Layer1[\"Layer 1: Entry Point\"]\n        JF[Jenkinsfile]\n    end\n\n    subgraph Layer2[\"Layer 2: Orchestration (vars/)\"]\n        STAGES[Stage Functions]\n    end\n\n    subgraph Layer3[\"Layer 3: Services\"]\n        subgraph L3_SRC[\"src/service/\"]\n            HTTP[HttpApiService]\n        end\n        subgraph L3_VARS[\"vars/ (CPS Constraint)\"]\n            SSH[shellScriptHelper]\n            BAH[bitbucketApiHelper]\n        end\n    end\n\n    subgraph Layer4[\"Layer 4: Utilities (src/utils/ + src/resource/)\"]\n        GIT[GitLibrary]\n        SHELL[ShellLibrary]\n        SSHLIB[SSHShellLibrary]\n        STATUS[Status Constants]\n        subgraph L4_CC[\"Cross-Cutting (vars/)\"]\n            LOGGER[logger]\n            BAL[bitbucketApiLibrary]\n        end\n    end\n\n    JF --&gt; STAGES\n    STAGES --&gt; SSH\n    STAGES --&gt; BAH\n    STAGES -.-&gt; LOGGER\n    SSH --&gt; GIT\n    SSH --&gt; SHELL\n    SSH --&gt; SSHLIB\n    SSH -.-&gt; LOGGER\n    BAH --&gt; BAL\n    BAH --&gt; HTTP\n    STAGES --&gt; STATUS\n    HTTP --&gt; STATUS</code></pre>"},{"location":"problem-solving/solution-by-layer/#2-complete-file-structure","title":"2. Complete File Structure","text":"<pre><code>devops-linux-jenkins/\n\u2502\n\u251c\u2500\u2500 sharedLibraries/                                    [18 files - Core Library]\n\u2502   \u251c\u2500\u2500 vars/                                           [13 files - Pipeline Functions]\n\u2502   \u2502   \u251c\u2500\u2500 logger.groovy                                   - Centralized logging\n\u2502   \u2502   \u251c\u2500\u2500 shellScriptHelper.groovy                        - Shell execution wrapper\n\u2502   \u2502   \u251c\u2500\u2500 bitbucketApiHelper.groovy                       - Bitbucket API facade\n\u2502   \u2502   \u251c\u2500\u2500 bitbucketApiLibrary.groovy                      - API request builder\n\u2502   \u2502   \u251c\u2500\u2500 stageInitialization.groovy                      - Pipeline initialization\n\u2502   \u2502   \u251c\u2500\u2500 stageProjectPrepare.groovy                      - Project preparation\n\u2502   \u2502   \u251c\u2500\u2500 stageLintUnity.groovy                           - Unity linting\n\u2502   \u2502   \u251c\u2500\u2500 stageLintGroovyJenkinsfile.groovy               - Groovy linting\n\u2502   \u2502   \u251c\u2500\u2500 stageUnityExecution.groovy                      - Unity test execution\n\u2502   \u2502   \u251c\u2500\u2500 stageStaticAnalysis.groovy                      - SonarQube analysis\n\u2502   \u2502   \u251c\u2500\u2500 stageSendBuildResults.groovy                    - Build result reporting\n\u2502   \u2502   \u251c\u2500\u2500 stageDeployBuild.groovy                         - Build deployment\n\u2502   \u2502   \u2514\u2500\u2500 stageCleanupPRBranchArtifacts.groovy            - PR cleanup\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 src/                                            [5 files - Library Source]\n\u2502       \u251c\u2500\u2500 resource/\n\u2502       \u2502   \u2514\u2500\u2500 Status.groovy                               - Status constants\n\u2502       \u2502\n\u2502       \u251c\u2500\u2500 service/general/\n\u2502       \u2502   \u2514\u2500\u2500 HttpApiService.groovy                       - HTTP client\n\u2502       \u2502\n\u2502       \u2514\u2500\u2500 utils/\n\u2502           \u251c\u2500\u2500 GitLibrary.groovy                           - Git operations (23 closures)\n\u2502           \u251c\u2500\u2500 ShellLibrary.groovy                         - Shell operations (15 closures)\n\u2502           \u2514\u2500\u2500 SSHShellLibrary.groovy                      - SSH operations (8 closures)\n\u2502\n\u251c\u2500\u2500 DLXJenkins/                                         [2 files - Unity Pipeline]\n\u2502   \u251c\u2500\u2500 Jenkinsfile\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment\n\u2502\n\u251c\u2500\u2500 JsJenkins/                                          [2 files - JavaScript Pipeline]\n\u2502   \u251c\u2500\u2500 Jenkinsfile\n\u2502   \u2514\u2500\u2500 JenkinsfileDeployment\n\u2502\n\u251c\u2500\u2500 PipelineForJenkins/                                 [1 file - Self Pipeline]\n\u2502   \u2514\u2500\u2500 Jenkinsfile\n\u2502\n\u251c\u2500\u2500 groovy/                                             [3 files - Legacy Helpers]\n\u2502   \u251c\u2500\u2500 generalHelper.groovy                                - Being migrated\n\u2502   \u251c\u2500\u2500 jsHelper.groovy                                     - Being migrated\n\u2502   \u2514\u2500\u2500 unityHelper.groovy                                  - Being migrated\n\u2502\n\u251c\u2500\u2500 python/                                             [15 files - Legacy Scripts]\n\u2502   \u2514\u2500\u2500 (to be eliminated)\n\u2502\n\u2514\u2500\u2500 tests/                                              [5 files - Unit Tests]\n    \u251c\u2500\u2500 GeneralHelperSpec.groovy\n    \u2514\u2500\u2500 src/\n        \u251c\u2500\u2500 resource/\n        \u2502   \u251c\u2500\u2500 JenkinsFile.groovy                          - Mock interface\n        \u2502   \u2514\u2500\u2500 StatusSpec.groovy\n        \u2514\u2500\u2500 utils/\n            \u2514\u2500\u2500 GitLibrarySpec.groovy                       - Git closure tests\n</code></pre>"},{"location":"problem-solving/solution-by-layer/#3-folder-by-folder-analysis","title":"3. Folder-by-Folder Analysis","text":""},{"location":"problem-solving/solution-by-layer/#31-sharedlibrariesvars-pipeline-stage-functions","title":"3.1 sharedLibraries/vars/ - Pipeline Stage Functions","text":"<p>The <code>vars/</code> directory in Jenkins Global Shared Library defines global functions callable directly from pipelines.</p> File Lines Purpose <code>stageInitialization.groovy</code> 103 Environment setup, send INPROGRESS status <code>stageProjectPrepare.groovy</code> 186 Git workspace preparation, branch sync <code>stageLintUnity.groovy</code> 67 Unity C# linting <code>stageLintGroovyJenkinsfile.groovy</code> 96 Groovy/Jenkinsfile linting <code>stageUnityExecution.groovy</code> 99 Unity test execution (EditMode/PlayMode/Coverage/WebGL) <code>stageStaticAnalysis.groovy</code> 87 SonarQube analysis <code>stageSendBuildResults.groovy</code> 39 Build result publishing <code>stageDeployBuild.groovy</code> 72 SSH deployment <code>stageCleanupPRBranchArtifacts.groovy</code> 62 PR artifact cleanup"},{"location":"problem-solving/solution-by-layer/#loggergroovy-3-level-hierarchical-logging","title":"logger.groovy - 3-Level Hierarchical Logging","text":"<pre><code>flowchart TB\n    subgraph Level1[\"Level 1: Stage\"]\n        SS[stageStart]\n        SE[stageEnd]\n    end\n\n    subgraph Level2[\"Level 2: Steps Group\"]\n        SGS[stepsGroupStart]\n        SGE[stepsGroupEnd]\n    end\n\n    subgraph Level3[\"Level 3: Step\"]\n        SSTART[stepStart \u27a1\ufe0f]\n        SINFO[stepInfo \ud83d\udcac]\n        SPROC[stepProcessing \ud83c\udfc3]\n        SSUC[stepSuccess \u2705]\n        SWARN[stepWarning \u26a0\ufe0f]\n        SFAIL[stepFailed \u274c]\n        SERR[stepError \ud83d\udd25]\n    end\n\n    SS --&gt; SGS\n    SGS --&gt; SSTART\n    SGS --&gt; SINFO\n    SGS --&gt; SPROC\n    SGS --&gt; SSUC\n    SGS --&gt; SWARN\n    SGS --&gt; SFAIL\n    SGS --&gt; SERR\n    SGE --&gt; SE</code></pre>"},{"location":"problem-solving/solution-by-layer/#shellscripthelpergroovy-validated-shell-execution","title":"shellScriptHelper.groovy - Validated Shell Execution","text":"<pre><code>flowchart LR\n    subgraph Input\n        CL[Closure from Library]\n        ARGS[Arguments List]\n    end\n\n    subgraph Validation\n        V1[Non-null script]\n        V2[Non-null label]\n        V3[Mutually exclusive flags]\n    end\n\n    subgraph Execution\n        RS[returnStatus \u2192 int]\n        RO[returnStdout \u2192 String]\n        RV[returnVoid \u2192 void]\n    end\n\n    subgraph Output\n        LOG[Logger Integration]\n        RES[Result]\n    end\n\n    CL --&gt; V1\n    ARGS --&gt; V1\n    V1 --&gt; V2\n    V2 --&gt; V3\n    V3 --&gt; RS\n    V3 --&gt; RO\n    V3 --&gt; RV\n    RS --&gt; LOG\n    RO --&gt; LOG\n    RV --&gt; LOG\n    LOG --&gt; RES</code></pre>"},{"location":"problem-solving/solution-by-layer/#32-sharedlibrariessrc-core-business-logic","title":"3.2 sharedLibraries/src/ - Core Business Logic","text":"<p>* CPS Constraint Note: <code>logger.groovy</code>, <code>shellScriptHelper.groovy</code>, <code>bitbucketApiHelper.groovy</code>, <code>bitbucketApiLibrary.groovy</code> are located in <code>vars/</code> instead of <code>src/</code> due to Jenkins CPS (Continuation Passing Style) serialization constraints. These files use Jenkins DSL methods (<code>echo</code>, <code>sh</code>, <code>withCredentials</code>) that require CPS-compatible execution context.</p>"},{"location":"problem-solving/solution-by-layer/#321-vars-helpers-cps-constrained","title":"3.2.1 vars/ Helpers (CPS-constrained)*","text":"File Lines Purpose Design Pattern <code>logger.groovy</code> 83 3-level hierarchical logging Facade <code>shellScriptHelper.groovy</code> 105 Validated shell execution Command/Adapter <code>bitbucketApiHelper.groovy</code> 36 Bitbucket API facade Facade <code>bitbucketApiLibrary.groovy</code> 69 API request builder Builder"},{"location":"problem-solving/solution-by-layer/#loggergroovy-3-level-hierarchical-logging_1","title":"logger.groovy - 3-Level Hierarchical Logging","text":""},{"location":"problem-solving/solution-by-layer/#322-srcutils-command-libraries","title":"3.2.2 src/utils/ - Command Libraries","text":""},{"location":"problem-solving/solution-by-layer/#gitlibrarygroovy-23-closures","title":"GitLibrary.groovy (23 Closures)","text":"Category Closures Fetch FetchOrigin, FetchBranch Branch ShowCurrentBranch, CheckoutBranch, GetOriginDefaultBranch, CheckOriginBranchExists, CheckBranchExists Status CheckUpToDateWithRemote, CheckIsRemoteBranchAncestor Reset/Clean ResetHardHead, CleanUntracked, RemoveIndexLock Clone/Pull CloneRepository, Pull, ResetHardOriginBranch Merge MergeOriginBranch LFS LfsListUntrackedFiles, LfsFetchAndCheckout Hash GetRemoteBranchHash"},{"location":"problem-solving/solution-by-layer/#shelllibrarygroovy-15-closures","title":"ShellLibrary.groovy (15 Closures)","text":"Category Closures Environment PrintJenkinsEnv Directory FindPRJobDirectory, FindProjectDirectory, CreateLintingResultsDir Docker DockerInfo, GroovyLint Unity GetUnityExecutable, LintUnity, CopyWebGLBuilder, CopyLintConfig Reporting ExecutePythonStatusReport, CreateBitbucketBuildReport, CreateBitbucketTestReport"},{"location":"problem-solving/solution-by-layer/#sshshelllibrarygroovy-8-closures","title":"SSHShellLibrary.groovy (8 Closures)","text":"Closure Purpose CheckSSHConnectivity Test SSH connection CreateDirectoryAndSetPermission Create remote directory CopyBuildToHostServer SCP build artifacts UpdateBuildURL Execute remote script CleanMergedPRBranchFromHostServer Remove PR artifacts CreateDirectoryAndSetPermissionForEconestogaDlxServer Econestoga server setup CopyBuildToEconestogaDlxServer Econestoga deployment UpdateBuildURLForEconestogaDlxServer Econestoga URL update"},{"location":"problem-solving/solution-by-layer/#323-srcservice-business-logic-services","title":"3.2.3 src/service/ - Business Logic Services","text":""},{"location":"problem-solving/solution-by-layer/#httpapiservicegroovy-172-lines","title":"HttpApiService.groovy (172 lines)","text":"<pre><code>flowchart TB\n    subgraph API[\"HttpApiService\"]\n        GET[get]\n        POST[post]\n        PUT[put]\n        DELETE[delete]\n    end\n\n    subgraph Execution\n        EXEC[executeRequest]\n    end\n\n    subgraph ErrorHandling[\"Error Handling\"]\n        UH[UnknownHostException]\n        CE[ConnectException]\n        ST[SocketTimeoutException]\n        SSL[SSLHandshakeException]\n        CC[ConnectionClosedException]\n        IO[IOException]\n    end\n\n    subgraph Response\n        RES[\"[statusCode, success, body]\"]\n    end\n\n    GET --&gt; EXEC\n    POST --&gt; EXEC\n    PUT --&gt; EXEC\n    DELETE --&gt; EXEC\n    EXEC --&gt; UH\n    EXEC --&gt; CE\n    EXEC --&gt; ST\n    EXEC --&gt; SSL\n    EXEC --&gt; CC\n    EXEC --&gt; IO\n    EXEC --&gt; RES</code></pre>"},{"location":"problem-solving/solution-by-layer/#324-srcresource-constants","title":"3.2.4 src/resource/ - Constants","text":""},{"location":"problem-solving/solution-by-layer/#statusgroovy","title":"Status.groovy","text":"<pre><code>class Status {\n    static final Map&lt;String, String&gt; STAGE_STATUS = [\n        'SUCCESS', 'UNSTABLE', 'FAILURE', 'ABORTED', 'SKIPPED'\n    ]\n    static final Map&lt;String, String&gt; BUILD_STATUS = [\n        'SUCCESS', 'UNSTABLE', 'FAILURE', 'ABORTED', 'NOT_BUILT'\n    ]\n    static final Map&lt;String, String&gt; COMMIT_STATUS = [\n        'SUCCESSFUL', 'INPROGRESS', 'FAILED', 'STOPPED'\n    ]\n}\n</code></pre>"},{"location":"problem-solving/solution-by-layer/#33-dlxjenkins-pipeline-definitions-refactored","title":"3.3 DLXJenkins/ - Pipeline Definitions (Refactored)","text":"<pre><code>@Library('global-trusted-shared-library@main') _\n\nimport resource.Status\nimport utils.GitLibrary\n\npipeline {\n    stages {\n        stage('Jenkins Initialization') { steps { stageInitialization() } }\n        stage('Project Preparation') { steps { stageProjectPrepare() } }\n        stage('Linting') { steps { stageLintUnity() } }\n        stage('EditMode Tests') { steps { stageUnityExecution('EditMode') } }\n        stage('PlayMode Tests') { steps { stageUnityExecution('PlayMode') } }\n        stage('Build Project') { steps { stageUnityExecution('Webgl') } }\n        stage('Send Build Results') { steps { stageSendBuildResults() } }\n    }\n    post {\n        always {\n            script {\n                dir(env.PROJECT_DIR) {\n                    shellScriptHelper(GitLibrary.ShowCurrentBranch)\n                    shellScriptHelper(GitLibrary.ResetHardHead)\n                    shellScriptHelper(GitLibrary.CleanUntracked)\n                    shellScriptHelper(GitLibrary.CheckoutBranch, [env.DESTINATION_BRANCH])\n                }\n            }\n        }\n        success { bitbucketApiHelper(bitbucketApiLibrary.createBuildStatusForCommit(...)) }\n        failure { bitbucketApiHelper(bitbucketApiLibrary.createBuildStatusForCommit(...)) }\n    }\n}\n</code></pre> <p>Characteristics: - No business logic (all delegated to vars/ functions) - Declarative pipeline structure - Consistent pattern: <code>steps { stageFunctionName() }</code></p>"},{"location":"problem-solving/solution-by-layer/#4-design-patterns-applied","title":"4. Design Patterns Applied","text":"<p>Source: Gang of Four (GoF) - \"Design Patterns: Elements of Reusable Object-Oriented Software\" (1994) by Erich Gamma, Richard Helm, Ralph Johnson, and John Vlissides</p>"},{"location":"problem-solving/solution-by-layer/#41-command-pattern-behavioral","title":"4.1 Command Pattern (Behavioral)","text":"<p>Definition: Encapsulates a request as an object, allowing parameterization and queuing of requests.</p> <p>Where: GitLibrary, ShellLibrary, SSHShellLibrary</p> <p>Why it applies: Each Closure encapsulates a shell command as an object (Map with script, label, returnType). The <code>shellScriptHelper</code> (Invoker) executes these commands without knowing their implementation details.</p> <pre><code>flowchart LR\n    subgraph Client[\"Client (stage*.groovy)\"]\n        CALL[\"shellScriptHelper(&lt;br/&gt;GitLibrary.CheckoutBranch,&lt;br/&gt;['main'])\"]\n    end\n\n    subgraph Command[\"Command (GitLibrary)\"]\n        CLOSURE[\"Closure CheckoutBranch&lt;br/&gt;\u2192 returns Map\"]\n    end\n\n    subgraph Invoker[\"Invoker (shellScriptHelper)\"]\n        VALIDATE[\"validateShMap()\"]\n        EXECUTE[\"execute*()\"]\n    end\n\n    subgraph Receiver[\"Receiver (Jenkins)\"]\n        SH[\"sh(map)\"]\n    end\n\n    Client --&gt;|\"passes Command\"| Invoker\n    Invoker --&gt;|\"calls\"| Command\n    Command --&gt;|\"returns Map\"| Invoker\n    Invoker --&gt;|\"delegates to\"| Receiver</code></pre>"},{"location":"problem-solving/solution-by-layer/#42-facade-pattern-structural","title":"4.2 Facade Pattern (Structural)","text":"<p>Definition: Provides a simplified interface to a complex subsystem, reducing dependencies between clients and the subsystems they interact with.</p> <p>Where: logger, shellScriptHelper</p> <p>Why it applies: These helpers hide the complexity of Jenkins DSL (<code>echo</code>, <code>sh</code>, <code>error</code>) and internal logic (validation, routing, formatting) behind simple function calls.</p> <pre><code>flowchart TB\n    subgraph Client[\"Client (stage*.groovy)\"]\n        STAGE[\"stageProjectPrepare()&lt;br/&gt;stageLintUnity()&lt;br/&gt;stageDeployBuild()\"]\n    end\n\n    subgraph Facade[\"Facade (vars/)\"]\n        LOG[\"logger&lt;br/&gt;.stepStart()&lt;br/&gt;.stepError()&lt;br/&gt;.stepInfo()\"]\n        SSH[\"shellScriptHelper&lt;br/&gt;(Closure, args)\"]\n    end\n\n    subgraph Subsystem[\"Subsystem (Hidden)\"]\n        ECHO[\"Jenkins echo()\"]\n        SH[\"Jenkins sh()\"]\n        ERR[\"Jenkins error()\"]\n        VALID[\"validateShMap()\"]\n        ROUTE[\"executeReturn*()\"]\n    end\n\n    Client --&gt;|\"uses simple API\"| Facade\n    LOG --&gt;|\"delegates\"| ECHO\n    LOG --&gt;|\"delegates\"| ERR\n    SSH --&gt;|\"internally uses\"| VALID\n    SSH --&gt;|\"internally uses\"| ROUTE\n    SSH --&gt;|\"delegates\"| SH</code></pre>"},{"location":"problem-solving/solution-by-layer/#43-adapter-pattern-structural","title":"4.3 Adapter Pattern (Structural)","text":"<p>Definition: Converts the interface of a class into another interface clients expect, allowing incompatible interfaces to work together.</p> <p>Where: shellScriptHelper</p> <p>Why it applies: Converts <code>(Closure, args)</code> interface that Client uses into <code>Map</code> interface that Jenkins <code>sh()</code> expects.</p> <pre><code>flowchart LR\n    subgraph Client[\"Client (stage*.groovy)\"]\n        CALL[\"shellScriptHelper(&lt;br/&gt;ShellLibrary.CreateLintingResultsDir,&lt;br/&gt;['workDir'])\"]\n    end\n\n    subgraph Adapter[\"Adapter (shellScriptHelper)\"]\n        CONVERT[\"Closure(*args) \u2192 Map\"]\n    end\n\n    subgraph Target[\"Target (Jenkins sh)\"]\n        SH[\"sh(Map)\"]\n    end\n\n    subgraph Adaptee[\"Adaptee (ShellLibrary)\"]\n        CLOSURE[\"Closure returns Map\"]\n    end\n\n    Client --&gt;|\"(Closure, args)\"| Adapter\n    Adapter --&gt;|\"calls\"| Adaptee\n    Adaptee --&gt;|\"returns Map\"| Adapter\n    Adapter --&gt;|\"Map\"| Target</code></pre> <p>Note: <code>shellScriptHelper</code> is both Adapter and Facade. Adapter for interface conversion, Facade for hiding internal complexity (validation, routing, logging).</p>"},{"location":"problem-solving/solution-by-layer/#5-current-state-summary","title":"5. Current State Summary","text":"Principle Implementation Separation of Concerns vars/: orchestration, service/: business logic, utils/: commands, resource/: constants Reusability 46 shell commands available to all stages, single logger instance Maintainability Change logging \u2192 edit logger.groovy only, Add Git op \u2192 add 1 closure Testability Mock-friendly constructors, Spock framework integration"},{"location":"problem-solving/solution-by-layer/#6-reference","title":"6. Reference","text":""},{"location":"problem-solving/solution-by-layer/#repository","title":"Repository","text":"<ul> <li>GitHub: <code>https://github.com/JindoKimKor/devops-jenkins-linux</code></li> </ul>"},{"location":"problem-solving/solution-by-layer/#related-documents","title":"Related Documents","text":"<ul> <li>solution-by-feature.md - Feature-by-feature breakdown</li> <li>logger-system-design-integration.md - Logger System design</li> <li>domain-driven-analysis.md - DDD pattern analysis</li> </ul>"},{"location":"problem-solving/solution-overview/","title":"Problem Solving Overview","text":"<p>Entry point for the problem-solving documentation.</p> <p>For high-level project overview, see README.md.</p> <p></p>"},{"location":"problem-solving/solution-overview/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Background</li> <li>Reference Commits</li> <li>Applied Industry Conventions</li> <li>Design Patterns (GoF)</li> <li>DDD Concepts</li> <li>Document Navigation</li> <li>Results Explanation (What)</li> <li>Implementation Process (How)</li> <li>Deep Dive Analysis</li> <li>Reference</li> </ul>"},{"location":"problem-solving/solution-overview/#1-background","title":"1. Background","text":""},{"location":"problem-solving/solution-overview/#11-purpose","title":"1.1 Purpose","text":"<p>This documentation is a post-refactoring analysis of intuitive problem-solving done during VARLab Co-op.</p> What I Did What This Document Does Refactored 5 monolithic pipelines into 4-Layer Architecture Classify and define those intuitive fixes using industry conventions Designed 3-Level Logger System Analyze why the design worked and how it integrates with the architecture <p>Goal: Transform experience-based understanding into systematic, reusable knowledge</p> <ul> <li>Learn how problems I \"felt\" are formally named and classified</li> <li>Validate solutions against established principles (Design Patterns, DDD)</li> <li>Understand integration points that made the architecture work</li> </ul>"},{"location":"problem-solving/solution-overview/#2-reference-commits","title":"2. Reference Commits","text":"State Commit Hash Date Before (Baseline) <code>74fc356</code> 2025-03-20 After (Final) <code>ff74ac8</code> 2025-05-12 <p>Duration: 54 days (Library setup 35 days, Core refactoring ~2 weeks)</p>"},{"location":"problem-solving/solution-overview/#3-applied-industry-conventions","title":"3. Applied Industry Conventions","text":""},{"location":"problem-solving/solution-overview/#31-design-patterns-gof","title":"3.1 Design Patterns (GoF)","text":"<p>Patterns identified in the refactored architecture:</p> Pattern Where Applied Purpose Command GitLibrary, ShellLibrary, SSHShellLibrary Encapsulate shell commands as Closure objects Facade logger, shellScriptHelper Hide Jenkins DSL complexity behind simple API Adapter shellScriptHelper Convert (Closure, args) \u2192 Map for Jenkins sh() <p>Data Source: solution-by-layer.md Section 4</p>"},{"location":"problem-solving/solution-overview/#32-ddd-concepts","title":"3.2 DDD Concepts","text":"<p>Post-refactoring analysis found alignment with some DDD organizational principles:</p> Pattern Alignment Notes Layered Architecture \u2713 Applied 4-layer separation (Entry \u2192 Orchestration \u2192 Infrastructure \u2192 Module) Modules \u2713 Applied GitLibrary, ShellLibrary, SSHShellLibrary as cohesive units Infrastructure Service Partial Concept exists, implemented as GoF Facade <p>Not a full DDD implementation due to stateless pipeline environment.</p> <p>Data Source: domain-driven-analysis.md</p>"},{"location":"problem-solving/solution-overview/#4-document-navigation","title":"4. Document Navigation","text":""},{"location":"problem-solving/solution-overview/#41-results-explanation-what","title":"4.1 Results Explanation (What)","text":"Document Description solution-by-feature.md Feature-by-feature breakdown: API Migration, Shell Libraries, Stage Modularization, Testability, Logger solution-by-layer.md Layer-by-layer architecture analysis, Design Patterns"},{"location":"problem-solving/solution-overview/#42-implementation-process-how","title":"4.2 Implementation Process (How)","text":"Phase Document Key Achievements 0 phase-0/.../changelog.md Library infrastructure, vars/ folder 1 phase-1/.../changelog.md ShellScript Helper, Stage modularization 2 phase-2/.../changelog.md 3-Level Logger (Stage/StepsGroup/Step) 3 phase-3/.../changelog.md HttpApiService, GitLibrary, ShellLibrary 4 phase-4/.../changelog.md All Stage modules, SSHShellLibrary"},{"location":"problem-solving/solution-overview/#43-deep-dive-analysis","title":"4.3 Deep Dive Analysis","text":"Document Description logger-system-design-integration.md 3-Level Logger design: Problem \u2192 Solution \u2192 Architecture integration domain-driven-analysis.md DDD pattern analysis: Layered Architecture, Modules (applied), Intention-Revealing Interfaces (not applied)"},{"location":"problem-solving/solution-overview/#5-reference","title":"5. Reference","text":""},{"location":"problem-solving/solution-overview/#repository","title":"Repository","text":"<ul> <li>GitHub: devops-jenkins-linux</li> </ul>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/","title":"Phase 0: Global Trusted Shared Library Setup","text":""},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#basic-information","title":"Basic Information","text":"Item Value Baseline <code>74fc356</code> (2025-03-20) Final <code>3c6422c</code> (2025-04-24) Total Commits 40 Duration 2025-03-21 ~ 2025-04-24 (approximately 1 month)"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Goal</li> <li>Commit List (by Phase)</li> <li>Phase-by-Phase Detailed Analysis</li> <li>3.1 Phase 1: Shared Library Folder Structure Exploration</li> <li>3.2 Phase 2: Shared Library Call Test</li> <li>3.3 Phase 3: Service Layer Construction</li> <li>3.4 Phase 4: Global Library Configuration Test</li> <li>3.5 Phase 5: Full Implementation</li> <li>Before/After Comparison</li> <li>Design Decisions</li> <li>Next Steps</li> </ol>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#1-goal","title":"1. Goal","text":"<p>Build Jenkins Global Trusted Shared Library foundation</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#2-commit-list-by-phase","title":"2. Commit List (by Phase)","text":"Phase Content Commit Count 1 Shared Library Folder Structure Exploration (2025-03-21) 4 2 Shared Library Call Test (2025-03-27) 6 3 Service Layer Construction (2025-03-31 ~ 2025-04-01) 8 4 Global Library Configuration Test (2025-04-13) 3 5 Full Implementation (2025-04-21 ~ 2025-04-24) 22 Phase 1: Shared Library Folder Structure Exploration (4 commits) Date Commit Message 2025-03-21 <code>bfab15f</code> Test Shared Library 2025-03-21 <code>62c03c2</code> Fix shared library path 2025-03-21 <code>c509fa0</code> Fixed shared library path 2025-03-21 <code>3be0817</code> Final Try Phase 2: Shared Library Call Test (6 commits) Date Commit Message 2025-03-27 <code>144fe00</code> test 2025-03-27 <code>eacdcce</code> test 2025-03-27 <code>7aa3ff4</code> Fixed 2025-03-27 <code>04ea7e0</code> test 2025-03-27 <code>8f14918</code> ests 2025-03-27 <code>8d17c86</code> asdf Phase 3: Service Layer Construction (8 commits) Date Commit Message 2025-03-31 <code>e9d184b</code> Add new package GitLFSHelper 2025-03-31 <code>29fb14d</code> Add new package GitLFSHelper 2025-04-01 <code>76e5586</code> Added GitLFSHelper to its test 2025-04-01 <code>1b7981c</code> Use different mocking framework for unit testing 2025-04-01 <code>a6d6547</code> Refactor CheckIfLightAndReflectionFilesExist to be a shared library 2025-04-01 <code>107ab3a</code> Re-categorize GitLFSHelper and LightAndReflectionFileChecker 2025-04-01 <code>19a296f</code> Modified Infrastructure of Shared Library 2025-04-01 <code>abbac32</code> Modified BuildProjectService.groovy Phase 4: Global Library Configuration Test (3 commits) Date Commit Message 2025-04-13 <code>18f9bbb</code> Try to assign the shared library files to the correct location 2025-04-13 <code>d68c0c7</code> test global library 2025-04-13 <code>e15ea80</code> test Phase 5: Full Implementation (22 commits) Date Commit Message 2025-04-21 <code>d0ed2e2</code> Global Library Test 2025-04-21 <code>cdf4b36</code> test 2025-04-21 <code>09adc72</code> test 2025-04-21 <code>2324c2e</code> teest 2025-04-21 <code>befd0f0</code> test 2025-04-21 <code>cb42797</code> test 2025-04-21 <code>eb45331</code> test 2025-04-21 <code>7c15211</code> Test 2025-04-21 <code>c47b663</code> Delete Load Shared Library Stage after managing Global Trusted Library Configuration worked 2025-04-21 <code>c33334c</code> Renamed my-simple-lib to global-trusted-shared-library 2025-04-21 <code>0af1ac2</code> Refactoring DLX-PR pipeline implementing the Global Trusted Shared Library 2025-04-21 <code>323823c</code> Try a different way to use 'new' operator 2025-04-21 <code>183feab</code> Modifed other way to call new operator in PR-DLX pipeline 2025-04-21 <code>6df93e4</code> Implement Global Trusted Shared Library for Deployment-DLX pipeline 2025-04-21 <code>5ccb037</code> Implement Global Trusted Shared Library for JavaScript Deployment Pipeline 2025-04-23 <code>77c024a</code> Delete Optional filter to test executing pipeline run by repo push trigger 2025-04-24 <code>99708f4</code> vars test 2025-04-24 <code>9f2cc5d</code> vars test 2025-04-24 <code>91cf049</code> vars Test with Library branch change 2025-04-24 <code>fa0a5be</code> Revert \"Delete Optional filter to test executing pipeline run by repo push trigger\" 2025-04-24 <code>ddb5bd0</code> Revert \"vars test\" 2025-04-24 <code>3c6422c</code> Revert \"vars test\""},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#3-phase-by-phase-detailed-analysis","title":"3. Phase-by-Phase Detailed Analysis","text":""},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#31-phase-1-shared-library-folder-structure-exploration-core-1543","title":"3.1 Phase 1: Shared Library Folder Structure Exploration (CORE-1543)","text":"View Details <p>Duration: 2025-03-21 (4 commits)</p> <p>Goal: Establish folder structure for Jenkins Shared Library introduction</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#problem-solving-process","title":"Problem Solving Process","text":"Commit Attempt Problem Solution <code>bfab15f</code> Created <code>sharedLibraries/resource/StageResults.groovy</code> Jenkins doesn't recognize class - <code>62c03c2</code> Moved <code>sharedLibraries/resource/</code> \u2192 <code>src/resource/</code> Still not recognized Jenkins recognizes <code>src/</code> folder as classpath <code>c509fa0</code> Moved <code>src/resource/</code> \u2192 <code>sharedLibraries/src/resource/</code> - Need <code>sharedLibraries/src/</code> structure under repository <code>3be0817</code> Refactored <code>StageResults</code> \u2192 <code>ResultStatus</code> - Separated Stage status and Build status, specified <code>static final</code> type"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#code-changes","title":"Code Changes","text":"<p>Before (<code>bfab15f</code>): <pre><code>// sharedLibraries/resource/StageResults.groovy\npackage resource\n\nclass StageResults {\n    static def stageResults = [\n        'SUCCESS': 'SUCCESS',\n        'FAILURE': 'FAILURE',\n        'ABORTED': 'ABORTED',\n        'SKIPPED': 'SKIPPED'\n    ]\n}\n</code></pre></p> <p>After (<code>3be0817</code>): <pre><code>// sharedLibraries/src/resource/ResultStatus.groovy\npackage resource\n\nclass ResultStatus {\n    static final Map&lt;String, String&gt; STAGE_STATUS = [\n        'SUCCESS': 'SUCCESS',\n        'FAILURE': 'FAILURE',\n        'ABORTED': 'ABORTED',\n        'SKIPPED': 'SKIPPED'\n    ]\n\n    static final Map&lt;String, String&gt; BUILD_STATUS = [\n        'SUCCESS': 'SUCCESS',\n        'UNSTABLE': 'UNSTABLE',\n        'FAILURE': 'FAILURE',\n        'ABORTED': 'ABORTED',\n        'NOT_BUILT': 'NOT_BUILT'\n    ]\n}\n</code></pre></p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#32-phase-2-shared-library-call-test-core-1526","title":"3.2 Phase 2: Shared Library Call Test (CORE-1526)","text":"View Details <p>Duration: 2025-03-27 (6 commits)</p> <p>Goal: Test how to call Shared Library classes from Jenkinsfile</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#test-content","title":"Test Content","text":"<p>Added/modified various <code>call()</code> methods to <code>ResultStatus.groovy</code>:</p> <pre><code>// Attempt 1: void method\nvoid Call() {\n    each \"Here\"\n}\n\n// Attempt 2: parameter + return\nvoid call(String param) {\n    return param\n}\n\n// Attempt 3: constructor + instance variable\nprivate String test\n\nResultStatus(String test) {\n    this.test = test\n}\n\nvoid call() {\n    return this.test\n}\n</code></pre> <p>Learning Points: - Scripts in <code>vars/</code> folder can be called directly via <code>call()</code> method - Classes in <code>src/</code> folder are used via <code>new ClassName()</code> or <code>import</code></p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#33-phase-3-service-layer-construction-core-1547","title":"3.3 Phase 3: Service Layer Construction (CORE-1547)","text":"View Details <p>Duration: 2025-03-31 ~ 2025-04-01 (8 commits)</p> <p>Goal: Build Service class for Git LFS problem resolution</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#problem-situation","title":"Problem Situation","text":"<ol> <li>Git LFS File Missing: LFS-managed files (images, audio) not checked out during pipeline execution</li> <li>Unity Lighting File Missing: WebGL build lighting breaks without <code>LightingData.asset</code>, <code>ReflectionProbe-0.exr</code> files</li> </ol>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#solution-process","title":"Solution Process","text":"Commit Changes <code>e9d184b</code> Created <code>GitLFSHelper.groovy</code> - Auto pull logic for LFS files <code>a6d6547</code> Created <code>CheckIfLightAndReflectionFilesExist.groovy</code> - Lighting file verification <code>107ab3a</code> Folder structure reorganization: <code>service/general/prepareWorkspace/</code>, <code>service/unity/buildProject/</code> <code>19a296f</code> Integrated Helper \u2192 Service: <code>PrepareWorkspaceService</code>, <code>BuildProjectService</code>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#code-changes_1","title":"Code Changes","text":"<p>GitLFSHelper Core Logic (<code>e9d184b</code>): <pre><code>void checkAndPullUntrackedLFSFiles() {\n    try {\n        // Check files managed by LFS but not yet downloaded\n        String missingFiles = script.sh(\n            script: \"git lfs ls-files | awk '\\$2 == \\\"-\\\" {print \\$3}'\",\n            returnStdout: true\n        ).trim()\n\n        if (missingFiles) {\n            script.echo \"Untracked large files detected: ${missingFiles}\"\n            script.sh 'git lfs pull'\n        }\n    } catch (Exception e) {\n        script.echo \"Failed to check for untracked LFS files: ${e.message}\"\n    }\n}\n</code></pre></p> <p>Folder Structure Evolution: <pre><code>Attempt 1: service/general/GitLFSHelper.groovy\nAttempt 2: service/general/prepareWorkspace/GitLFSHelper.groovy\nAttempt 3: service/unity/buildProject/LightAndReflectionFileChecker.groovy\nFinal:     service/general/PrepareWorkspaceService.groovy\n           service/unity/BuildProjectService.groovy\n</code></pre></p> <p>Learning Points: - Integrated Helper classes into Service classes for domain-based responsibility separation - Inject <code>script</code> object via constructor to access Jenkins Pipeline context</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#34-phase-4-global-library-configuration-test","title":"3.4 Phase 4: Global Library Configuration Test","text":"View Details <p>Duration: 2025-04-13 (3 commits)</p> <p>Goal: Test Jenkins Global Library Configuration settings</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#test-content_1","title":"Test Content","text":"Commit Change Purpose <code>18f9bbb</code> Deleted all files in sharedLibraries (-99 lines) Test if file location affects Global Library recognition <code>d68c0c7</code> Restored files (+99 lines) Verify recognition after restoration <code>e15ea80</code> Deleted again (-99 lines) Test different configuration combinations <p>Learning Points: - Configuration needed in Jenkins &gt; Manage Jenkins &gt; Configure System &gt; Global Pipeline Libraries - Specify Library name, Git Repository URL, Default Version (branch) - Learned that Library type and Version Control is possible through Library settings</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#35-phase-5-full-implementation-implement-global-trusted-shared-library","title":"3.5 Phase 5: Full Implementation (Implement-Global-Trusted-Shared-Library)","text":"View Details <p>Duration: 2025-04-21 ~ 2025-04-24 (22 commits)</p> <p>Goal: Apply Global Trusted Shared Library to 5 pipelines</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#implementation-steps","title":"Implementation Steps","text":""},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#step-1-vars-test-d0ed2e2","title":"Step 1: vars/ Test (<code>d0ed2e2</code>)","text":"<pre><code>// sharedLibraries/vars/sayHello.groovy\ndef call(String name = 'World') {\n    echo \"Hello, ${name}! This message came from the global library.\"\n}\n</code></pre> <p>Verified <code>@Library('my-simple-lib@main') _</code> works in Jenkins Global Configuration.</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#step-2-delete-load-shared-library-stage-c47b663","title":"Step 2: Delete Load Shared Library Stage (<code>c47b663</code>)","text":"<p>Before (-63 lines): <pre><code>def sharedLib\ndef resultStatus\n\nstage('Load Shared Library') {\n    steps {\n        script {\n            def LIBRARY_PATH = 'sharedLibraries'\n            sh \"\"\"\n                cd ${WORKSPACE}/${LIBRARY_PATH} &amp;&amp; \\\n                (rm -rf .git || true) &amp;&amp; \\\n                git init &amp;&amp; \\\n                git add --all &amp;&amp; \\\n                git commit -m 'init'\n            \"\"\"\n            def repoPath = sh(returnStdout: true, script: 'pwd').trim() + \"/${LIBRARY_PATH}\"\n            sharedLib = library identifier: 'local-lib@master',\n                    retriever: modernSCM([$class: 'GitSCMSource', remote: \"${repoPath}\"]),\n                    changelog: false\n        }\n    }\n}\n\n// Usage\nresultStatus = sharedLib.resource.ResultStatus\ncurrentBuild.result = resultStatus.BUILD_STATUS.ABORTED\n</code></pre></p> <p>After (+6 lines): <pre><code>@Library('my-simple-lib@main') _\n\nimport resource.ResultStatus\n\n// Usage\ncurrentBuild.result = ResultStatus.BUILD_STATUS.ABORTED\n</code></pre></p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#step-3-new-operator-syntax-fix-323823c","title":"Step 3: new Operator Syntax Fix (<code>323823c</code>)","text":"<p>Before (Local Library approach): <pre><code>prepareWorkspaceService = sharedLib.service.general.PrepareWorkspaceService\nprepareWorkspaceServiceClass = prepareWorkspaceService.new(this)\n</code></pre></p> <p>After (Global Library approach): <pre><code>import service.general.PrepareWorkspaceService\n\nPrepareWorkspaceService prepareWorkspaceService = new PrepareWorkspaceService(this)\n</code></pre></p> <p>Problem: With Local Library, <code>sharedLib.xxx.ClassName</code> returns a wrapped form rather than a Class object, requiring <code>.new()</code> syntax. With Global Library, direct <code>import</code> allows standard Groovy syntax.</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#step-4-applied-to-5-pipelines","title":"Step 4: Applied to 5 Pipelines","text":"Commit Pipeline Change Amount <code>c47b663</code> PipelineForJenkins/Jenkinsfile -63 lines, +6 lines <code>0af1ac2</code> DLXJenkins/Jenkinsfile -47 lines, +11 lines <code>6df93e4</code> DLXJenkins/JenkinsfileDeployment -53 lines <code>5ccb037</code> JsJenkins/Jenkinsfile, JenkinsfileDeployment -86 lines"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#4-beforeafter-comparison","title":"4. Before/After Comparison","text":""},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#code-change-amount","title":"Code Change Amount","text":"Item Before After Change Shared Library Loading ~30 lines/pipeline 1 line -29 lines Class Usage Syntax <code>sharedLib.xxx.Class</code> <code>import xxx.Class</code> Standard Groovy new Operator <code>Class.new(this)</code> <code>new Class(this)</code> Standard Groovy"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#folder-structure","title":"Folder Structure","text":"<pre><code>Before                              After\n\u2500\u2500\u2500\u2500\u2500\u2500                              \u2500\u2500\u2500\u2500\u2500\n(No Shared Library)                 sharedLibraries/\n                                    \u251c\u2500\u2500 src/\n                                    \u2502   \u251c\u2500\u2500 resource/\n                                    \u2502   \u2502   \u2514\u2500\u2500 ResultStatus.groovy\n                                    \u2502   \u2514\u2500\u2500 service/\n                                    \u2502       \u251c\u2500\u2500 general/\n                                    \u2502       \u2502   \u2514\u2500\u2500 PrepareWorkspaceService.groovy\n                                    \u2502       \u2514\u2500\u2500 unity/\n                                    \u2502           \u2514\u2500\u2500 BuildProjectService.groovy\n                                    \u2514\u2500\u2500 vars/\n                                        \u2514\u2500\u2500 sayHello.groovy\n</code></pre>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#5-design-decisions","title":"5. Design Decisions","text":""},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#51-why-global-trusted-library","title":"5.1 Why Global Trusted Library?","text":"Approach Advantages Disadvantages Local Library No separate configuration needed Requires git init/commit every execution, non-standard syntax Global Library Standard import syntax, version control possible Requires Jenkins configuration Global Trusted No sandbox restrictions (<code>@NonCPS</code>, file I/O possible) Security caution needed"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#52-why-trusted-is-needed","title":"5.2 Why Trusted is Needed","text":"<p>Features to be implemented in subsequent Phases: - <code>@NonCPS</code> annotation usage (CPS transformation bypass) - File I/O operations - Direct Apache HttpClient usage</p> <p>These features are unavailable in regular Shared Library due to sandbox restrictions.</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#53-version-control","title":"5.3 Version Control","text":"<pre><code>@Library('global-trusted-shared-library@main') _           // main branch\n@Library('global-trusted-shared-library@Refactor-with-TDD') _  // development branch\n@Library('global-trusted-shared-library@v1.0.0') _         // tag version\n</code></pre> <p>Branch/tag specification enables per-pipeline Library version management.</p>"},{"location":"problem-solving/phase-0-global-trusted-shared-library-setup/changelog/#6-next-steps","title":"6. Next Steps","text":"<p>\u2192 Phase 1: ShellScript Modularization &amp; Initialization Stage</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/","title":"Phase 1: ShellScript Modularization &amp; Initialization Stage","text":""},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#basic-information","title":"Basic Information","text":"Item Value Start <code>3c6422c</code> (2025-04-24, Phase 0 ended) Final <code>d699fac</code> (2025-04-26) Total Commits 12 Duration 2025-04-25 (1 day)"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Goal</li> <li>Commit List</li> <li>Step-by-Step Detailed Analysis</li> <li>3.1 Step 1: Initialization Stage Initial Implementation</li> <li>3.2 Step 2: ShellScript Modularization</li> <li>3.3 Step 3: Package Structure and Annotation Modifications</li> <li>3.4 Step 4: Naming Convention Establishment and Logging Improvement</li> <li>New Files</li> <li>Architecture Significance</li> <li>Core Patterns</li> <li>Benefits</li> <li>Next Steps</li> </ol>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#1-goal","title":"1. Goal","text":"<p>Separate Shell script execution logic from pipeline code and modularize common initialization logic into Stage</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#2-commit-list","title":"2. Commit List","text":"Date Commit Message 2025-04-25 <code>fe1a82a</code> Initialization initial test 2025-04-25 <code>5f079ff</code> Added PRBRANCH git origin fetch in Initialization stage 2025-04-25 <code>44c4d06</code> Added git origin fetch and get shell latest commit commands in Intialization groovy with error handling 2025-04-25 <code>8be55ee</code> ShellScripting Modulized 2025-04-25 <code>d492539</code> initialization.groovy has been updated to Initialization.groovy with the initial letter capitalized 2025-04-25 <code>8ef6fef</code> Shell Script Data Class and Improve ShellScriptHelper 2025-04-25 <code>58a41e0</code> Move import ShellParams Package in Jenkinsfile 2025-04-25 <code>0b9e4a8</code> Fixed the way to do Package and use it 2025-04-25 <code>40bf3c4</code> Removed Canonical annotation 2025-04-25 <code>d12ef93</code> Added logic for TICKET NUMBER and FOLDER NAME and test initial lowercase Stage class name 2025-04-25 <code>d501f2d</code> Try initial lowercase groovy file name in vars folder 2025-04-25 <code>d3613c8</code> Improved log in Initialization stage and ShellScript Helper"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#3-step-by-step-detailed-analysis","title":"3. Step-by-Step Detailed Analysis","text":""},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#31-step-1-initialization-stage-initial-implementation","title":"3.1 Step 1: Initialization Stage Initial Implementation","text":"View Details <p>Commits: <code>fe1a82a</code> ~ <code>44c4d06</code> (3 commits)</p> <p>Goal: Create first Stage module in vars/ folder and implement Git initialization logic</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#work-by-commit","title":"Work by Commit","text":"Commit Work File Changes <code>fe1a82a</code> Created Initialization.groovy, tested calling from Jenkinsfile +<code>vars/Initialization.groovy</code> <code>5f079ff</code> Added git origin fetch for PR_BRANCH Modified <code>vars/Initialization.groovy</code> <code>44c4d06</code> Added git fetch origin, shell latest commit commands, implemented error handling <code>vars/Initialization.groovy</code> +41 lines <p>Result: - Created <code>vars/Initialization.groovy</code> file - Includes basic git fetch and error handling</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#32-step-2-shellscript-modularization","title":"3.2 Step 2: ShellScript Modularization","text":"View Details <p>Commits: <code>8be55ee</code> ~ <code>8ef6fef</code> (3 commits)</p> <p>Goal: Separate Shell execution logic into separate Helper and create data class</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#work-by-commit_1","title":"Work by Commit","text":"Commit Work File Changes <code>8be55ee</code> Separated shell logic from Initialization, created shellUtils.groovy +<code>vars/shellUtils.groovy</code> (52 lines) <code>d492539</code> Tested file name capitalization (initialization \u2192 Initialization) Modified Jenkinsfile <code>8ef6fef</code> Created ShellParams data class, refactored to ShellScriptHelper +<code>src/utils/ShellParams.groovy</code>, +<code>vars/ShellScriptHelper.groovy</code>, -<code>vars/shellUtils.groovy</code> <p>Architecture Change: <pre><code>Before: vars/Initialization.groovy (includes shell logic)\nAfter:  vars/Initialization.groovy\n        vars/ShellScriptHelper.groovy (handles shell execution)\n        src/utils/ShellParams.groovy (parameter data class)\n</code></pre></p> <p>Learning Points: - Files in vars/ folder can be called directly from Jenkins - Classes in src/ folder are used via import</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#33-step-3-package-structure-and-annotation-modifications","title":"3.3 Step 3: Package Structure and Annotation Modifications","text":"View Details <p>Commits: <code>58a41e0</code> ~ <code>40bf3c4</code> (3 commits)</p> <p>Goal: Resolve Groovy package import issues and Jenkins CPS compatibility</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#problem-solving-process","title":"Problem Solving Process","text":"Commit Attempt Problem Solution <code>58a41e0</code> Moved ShellParams import location Import issue in vars Moved to Jenkinsfile <code>0b9e4a8</code> Fixed package path Wrong package declaration Fixed to <code>utils.ShellParams</code> <code>40bf3c4</code> Removed @Canonical annotation Jenkins CPS compatibility issue Implemented manual constructor/getter <p>Code Change: <pre><code>// Before: Groovy @Canonical annotation\n@Canonical\nclass ShellParams {\n    String script\n    String label\n}\n\n// After: Manual implementation (Jenkins CPS compatible)\nclass ShellParams {\n    String script\n    String label\n\n    ShellParams(String script, String label) {\n        this.script = script\n        this.label = label\n    }\n}\n</code></pre></p> <p>Learning Points: - Jenkins Pipeline's CPS transformation is incompatible with some Groovy annotations - <code>@Canonical</code>, <code>@Immutable</code>, etc. need to be replaced with manual implementation</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#34-step-4-naming-convention-establishment-and-logging-improvement","title":"3.4 Step 4: Naming Convention Establishment and Logging Improvement","text":"View Details <p>Commits: <code>d12ef93</code> ~ <code>d3613c8</code> (3 commits)</p> <p>Goal: Establish vars/ file naming conventions and improve logging</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#work-by-commit_2","title":"Work by Commit","text":"Commit Work File Changes <code>d12ef93</code> Added TICKET_NUMBER/FOLDER_NAME logic, renamed Initialization \u2192 stageInitialization <code>vars/Initialization.groovy</code> \u2192 <code>vars/stageInitialization.groovy</code> <code>d501f2d</code> Renamed ShellScriptHelper \u2192 helperShellScript <code>vars/ShellScriptHelper.groovy</code> \u2192 <code>vars/helperShellScript.groovy</code> <code>d3613c8</code> Improved logging messages, organized output format Modified both files <p>Naming Convention Established: <pre><code>vars/ File Naming Convention:\n- Stage modules: stage{StageName}.groovy (e.g., stageInitialization.groovy)\n- Helpers: helper{HelperName}.groovy (e.g., helperShellScript.groovy)\n</code></pre></p> <p>Result: - <code>stageInitialization.groovy</code>: Stage module - <code>helperShellScript.groovy</code>: Shell execution helper</p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#4-new-files","title":"4. New Files","text":""},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#41-sharedlibrariessrcutilsshellparamsgroovy-43-lines","title":"4.1 <code>sharedLibraries/src/utils/ShellParams.groovy</code> (43 lines)","text":"<p>Parameter data class for Shell command execution <pre><code>class ShellParams {\n    String script\n    String label\n    boolean returnStdout = false\n    boolean returnStatus = false\n}\n</code></pre></p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#42-sharedlibrariesvarshelpershellscriptgroovy-100-lines","title":"4.2 <code>sharedLibraries/vars/helperShellScript.groovy</code> (100 lines)","text":"<p>Shell script execution helper - Executes sh commands in a standardized way <pre><code>def execute(Map params) {\n    // params: script, label, returnStdout, returnStatus\n    // Integrated logging, error handling\n}\n</code></pre></p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#43-sharedlibrariesvarsstageinitializationgroovy-41-lines","title":"4.3 <code>sharedLibraries/vars/stageInitialization.groovy</code> (41 lines)","text":"<p>Pipeline initialization Stage - Environment variable setup, Git information collection <pre><code>def call() {\n    echo \"\u25b6\ufe0f Stage '${env.STAGE_NAME}' Starting\"\n    // Initialize environment variables like TICKET_NUMBER, FOLDER_NAME\n    // Git origin fetch\n}\n</code></pre></p>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#5-architecture-significance","title":"5. Architecture Significance","text":""},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#51-layer-2-4-established","title":"5.1 Layer 2 &amp; 4 Established","text":"<pre><code>sharedLibraries/\n\u251c\u2500\u2500 vars/                    # Layer 2: Orchestration\n\u2502   \u251c\u2500\u2500 helperShellScript.groovy      # Helper\n\u2502   \u2514\u2500\u2500 stageInitialization.groovy    # Stage Module\n\u2514\u2500\u2500 src/\n    \u2514\u2500\u2500 utils/               # Layer 4: Utilities\n        \u2514\u2500\u2500 ShellParams.groovy\n</code></pre>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#52-separation-of-concerns-begins","title":"5.2 Separation of Concerns Begins","text":"<ul> <li>Before: sh commands written directly in Jenkinsfile</li> <li>After: sh execution abstracted in vars/, integrated logging/error handling</li> </ul>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#6-core-patterns","title":"6. Core Patterns","text":""},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#61-shell-execution-standardization","title":"6.1 Shell Execution Standardization","text":"<pre><code>// Before (inside Jenkinsfile)\nsh 'git fetch origin'\n\n// After (using vars/helperShellScript.groovy)\nhelperShellScript.execute([\n    script: 'git fetch origin',\n    label: 'Fetch origin branches'\n])\n</code></pre>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#62-stage-modularization","title":"6.2 Stage Modularization","text":"<pre><code>// Before (logic written inside Jenkinsfile)\nstage('Initialization') {\n    steps {\n        script {\n            // 10-20 lines of initialization code\n        }\n    }\n}\n\n// After (calling vars/stageInitialization.groovy)\nstage('Initialization') {\n    steps {\n        stageInitialization()\n    }\n}\n</code></pre>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#7-benefits","title":"7. Benefits","text":"<ol> <li>Code Reuse: All pipelines use the same Shell execution logic</li> <li>Consistent Logging: Automatically outputs label during Shell execution</li> <li>Integrated Error Handling: Same error handling for all Shell executions</li> <li>Testability: Separated modules can be unit tested</li> </ol>"},{"location":"problem-solving/phase-1-shellscript-modularization-and-initialization-stage/changelog/#8-next-steps","title":"8. Next Steps","text":"<p>\u2192 Phase 2: 3-Level Logger System Implementation</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/","title":"Phase 2: 3-Level Logger System Implementation","text":""},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#basic-information","title":"Basic Information","text":"Item Value Start <code>d699fac</code> (2025-04-26, Phase 1 ended) Final <code>9c245c1</code> (2025-04-27) Total Commits 11 Duration 2025-04-26 (1 day)"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Goal</li> <li>Commit List</li> <li>Step-by-Step Detailed Analysis</li> <li>3.1 Step 1: vars Call Method Test</li> <li>3.2 Step 2: Logger Initial Implementation and CPS Issue Resolution</li> <li>3.3 Step 3: Logger Completion and Integration</li> <li>3-Level Logging Pattern</li> <li>New File</li> <li>Usage Examples</li> <li>Error Handling</li> <li>Architecture Significance</li> <li>Benefits</li> <li>Next Steps</li> </ol>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#1-goal","title":"1. Goal","text":"<p>Design and implement a 3-level logger system for consistent logging output during pipeline execution</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#2-commit-list","title":"2. Commit List","text":"Date Commit Message 2025-04-26 <code>aa7c86e</code> Improved logging and test vars 2025-04-26 <code>5ca3a49</code> Re-test vars 2025-04-26 <code>63abf6b</code> re-test vars no call method 2025-04-26 <code>238838a</code> Logger test 2025-04-26 <code>45d7588</code> Delete private access limiter in logger groovy regarding Jenkins pipeline access field member variables, CPS 2025-04-26 <code>0f782a5</code> Try to fix logger field variables scope issue 2025-04-26 <code>cdb1984</code> Second try to fix logger field variables scope issue, CPS 2025-04-26 <code>2267005</code> Try logging without the field variables 2025-04-26 <code>a4eb7ee</code> initial logger implemented 2025-04-26 <code>44ffef5</code> Fixed using incorrect shellScriptHelper name 2025-04-26 <code>d699fac</code> Fixed throw error handling"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#3-step-by-step-detailed-analysis","title":"3. Step-by-Step Detailed Analysis","text":""},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#31-step-1-vars-call-method-test","title":"3.1 Step 1: vars Call Method Test","text":"View Details <p>Commits: <code>aa7c86e</code> ~ <code>63abf6b</code> (3 commits)</p> <p>Goal: Test how scripts in vars/ folder are called</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#work-by-commit","title":"Work by Commit","text":"Commit Work File Changes <code>aa7c86e</code> Improved logging, created varsTest.groovy to test vars calling +<code>vars/varsTest.groovy</code>, modified <code>vars/stageInitialization.groovy</code> <code>5ca3a49</code> Re-tested vars Modified <code>vars/stageInitialization.groovy</code> <code>63abf6b</code> Tested vars without call() method Modified <code>vars/stageInitialization.groovy</code> <p>Test Purpose: - Verify how Groovy files in vars/ folder are called by Jenkins - Understand behavior differences with/without <code>call()</code> method</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#32-step-2-logger-initial-implementation-and-cps-issue-resolution","title":"3.2 Step 2: Logger Initial Implementation and CPS Issue Resolution","text":"View Details <p>Commits: <code>238838a</code> ~ <code>2267005</code> (5 commits)</p> <p>Goal: Create logger.groovy and resolve Jenkins CPS compatibility issues</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#problem-solving-process","title":"Problem Solving Process","text":"Commit Attempt Problem Solution <code>238838a</code> Created logger.groovy, used private static final fields - Initial implementation <code>45d7588</code> Removed private access modifier CPS cannot access private fields Deleted private keyword <code>0f782a5</code> Field variable scope modification attempt 1 Still inaccessible Tried different approach <code>cdb1984</code> Field variable scope modification attempt 2 CPS transformation issue persists Tried structure change <code>2267005</code> Completely removed field variables - Resolved by using strings directly <p>Code Change: <pre><code>// Before: Using field variables (CPS issue occurred)\nprivate static final String STAGE_MARKER = '===== STAGE'\nvoid stageStart(String stageName) {\n    echo \"${STAGE_MARKER} Starting: [${stageName}] ${STAGE_MARKER}\"\n}\n\n// After: Removed field variables (CPS compatible)\nvoid stageStart(String stageName) {\n    echo \"===== STAGE Starting: [${stageName}] =====\"\n}\n</code></pre></p> <p>Learning Points: - Jenkins Pipeline CPS has compatibility issues with <code>private</code>, <code>static final</code> fields - In vars/ files, using strings directly in methods is more stable than field variables</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#33-step-3-logger-completion-and-integration","title":"3.3 Step 3: Logger Completion and Integration","text":"View Details <p>Commits: <code>a4eb7ee</code> ~ <code>d699fac</code> (3 commits)</p> <p>Goal: Final logger implementation and integration with existing code</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#work-by-commit_1","title":"Work by Commit","text":"Commit Work File Changes <code>a4eb7ee</code> Final logger.groovy implementation, renamed helperShellScript \u2192 shellScriptHelper, integrated logger in stageInitialization <code>vars/logger.groovy</code> +29 lines, <code>vars/helperShellScript.groovy</code> \u2192 <code>vars/shellScriptHelper.groovy</code> <code>44ffef5</code> Fixed shellScriptHelper call name Modified <code>vars/stageInitialization.groovy</code> <code>d699fac</code> Fixed throw error handling, improved stepError method Modified <code>vars/logger.groovy</code>, <code>vars/shellScriptHelper.groovy</code>, <code>vars/stageInitialization.groovy</code> <p>Final Logger API: <pre><code>// Stage Level\nvoid stageStart(String stageName)\nvoid stageEnd(String stageName)\n\n// Steps Group Level\nvoid stepsGroupStart(String groupName)\nvoid stepsGroupEnd(String groupName)\n\n// Step Level\nvoid stepStart(String description)\nvoid stepSuccess(String description)\nvoid stepFailed(String description)\nvoid stepError(String description)\n</code></pre></p> <p>Final Naming Convention Established: <pre><code>vars/ File Naming Convention (Final):\n- Stage modules: stage{StageName}.groovy\n- Helpers: {helperName}Helper.groovy \u2192 starts with lowercase\n- Logger: logger.groovy\n</code></pre></p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#4-3-level-logging-pattern","title":"4. 3-Level Logging Pattern","text":""},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#41-level-1-stage-highest","title":"4.1 Level 1: Stage (Highest)","text":"<pre><code>===== STAGE Starting: [ StageName ] =====\n===== STAGE Completed: [ StageName ] =====\n</code></pre>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#42-level-2-steps-group-middle","title":"4.2 Level 2: Steps Group (Middle)","text":"<pre><code>--- STEPS Starting Group: [ GroupName ] ---\n--- STEPS Completed Group: [ GroupName ] ---\n</code></pre>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#43-level-3-step-lowest","title":"4.3 Level 3: Step (Lowest)","text":"<pre><code>\u27a1\ufe0f Step Starting: [ description ]...\n\ud83d\udcac Step Info: [ description ]\n\ud83c\udfc3 Step Processing: [ description ]\n\ud83d\udca1 Step Shell Executed Result: [ result ]\n\u2705 Step Completed: [ description ]\n\u26a0\ufe0f Step Warning: [ description ]\n\u274c Step Failed: [ description ]\n\ud83d\udd25 Step Error: [ description ]\n</code></pre>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#5-new-file-sharedlibrariesvarsloggergroovy-63-lines","title":"5. New File: <code>sharedLibraries/vars/logger.groovy</code> (63 lines)","text":"<pre><code>// Stage Level\nvoid stageStart(String stageName)\nvoid stageEnd(String stageName)\n\n// Steps Group Level\nvoid stepsGroupStart(String groupName)\nvoid stepsGroupEnd(String groupName)\n\n// Step Level\nvoid stepStart(String description)\nvoid stepInfo(String description)\nvoid stepProcessing(String description)\nvoid stepShellExecutedResult(String description)\nvoid stepSuccess(String description)\nvoid stepWarning(String description)\nvoid stepFailed(String description)\nvoid stepError(String description, Throwable err)\nvoid stepError(String description)  // Overload: without Throwable\n</code></pre>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#6-usage-examples","title":"6. Usage Examples","text":""},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#61-usage-within-stage","title":"6.1 Usage Within Stage","text":"<pre><code>def call() {\n    logger.stageStart(env.STAGE_NAME)\n\n    logger.stepsGroupStart('Git Repository Setup')\n\n    logger.stepStart('Fetching origin branches')\n    sh 'git fetch origin'\n    logger.stepSuccess('Origin branches fetched')\n\n    logger.stepsGroupEnd('Git Repository Setup')\n\n    logger.stageEnd(env.STAGE_NAME)\n}\n</code></pre>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#62-console-output-example","title":"6.2 Console Output Example","text":"<pre><code>===== STAGE Starting: [ Initialization ] =====\n--- STEPS Starting Group: [ Git Repository Setup ] ---\n\u27a1\ufe0f Step Starting: [ Fetching origin branches ]...\n\u2705 Step Completed: [ Origin branches fetched ]\n--- STEPS Completed Group: [ Git Repository Setup ] ---\n===== STAGE Completed: [ Initialization ] =====\n</code></pre>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#7-error-handling","title":"7. Error Handling","text":""},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#71-steperror-with-throwable","title":"7.1 stepError with Throwable","text":"<pre><code>void stepError(String description, Throwable err) {\n    StringWriter sw = new StringWriter()\n    PrintWriter pw = new PrintWriter(sw)\n    err.printStackTrace(pw)\n    String stackTrace = sw.toString()\n    println \"\ud83d\udd25\ud83d\udd25\ud83d\udd25 Full Stack Trace for Error \\n[${description}]\\n${stackTrace}\"\n    error(\"\ud83d\udd25 Step Error: \\n[ ${description} ] - Error: ${err.getMessage()}\")\n}\n</code></pre>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#72-usage-example","title":"7.2 Usage Example","text":"<pre><code>try {\n    // Dangerous operation\n} catch (Exception e) {\n    logger.stepError('Failed to execute critical operation', e)\n}\n</code></pre>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#8-architecture-significance","title":"8. Architecture Significance","text":""},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#81-standard-interface-established","title":"8.1 Standard Interface Established","text":"<p>Using the same logging pattern across all Stages and Steps \u2192 Consistent CI/CD log output</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#82-ease-of-debugging","title":"8.2 Ease of Debugging","text":"<ul> <li>Automatic Stack trace output</li> <li>Clear indication of start/completion for each step</li> <li>Status differentiation with emojis (\u2705 Success, \u26a0\ufe0f Warning, \u274c Failed, \ud83d\udd25 Error)</li> </ul>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#83-jenkins-blue-ocean-compatible","title":"8.3 Jenkins Blue Ocean Compatible","text":"<p>Step-by-step logging makes progress tracking easier in Blue Ocean UI</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#9-benefits","title":"9. Benefits","text":"<ol> <li>Consistency: Same log format across all pipelines</li> <li>Readability: Visual distinction with emojis and separators</li> <li>Debugging: Detailed stack trace on error occurrence</li> <li>Maintainability: Only one place to modify when changing log format</li> </ol>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#10-next-steps","title":"10. Next Steps","text":"<p>\u2192 Phase 3: Bitbucket API &amp; Shell Library Integration</p>"},{"location":"problem-solving/phase-2-3-level-logger-system-implementation/changelog/#reference","title":"Reference","text":"<ul> <li>logger-system-design-integration.md - Logger System design document (Problem analysis \u2192 Solution \u2192 Implementation)</li> </ul>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/","title":"Phase 3: Bitbucket API &amp; Shell Library Integration","text":""},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#basic-information","title":"Basic Information","text":"Item Value Start <code>9c245c1</code> (2025-04-27, Phase 2 ended) Final <code>48f4295</code> (2025-05-05) Total Commits 84 Duration 2025-05-01 ~ 2025-05-05 (5 days)"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Goal</li> <li>Commit List (by Phase)</li> <li>Phase-by-Phase Detailed Analysis</li> <li>3.1 Phase 1: Jenkins Environment Test and Bitbucket API Initial Implementation</li> <li>3.2 Phase 2: Bitbucket API HTTP Communication Implementation and Debugging</li> <li>3.3 Phase 3: ShellScript Helper Refactoring</li> <li>3.4 Phase 4: Git Shell Scripts Implementation and stageProjectPrepare</li> <li>3.5 Phase 5: GitLibrary/ShellLibrary Separation and BitbucketApiService</li> <li>3.6 Phase 6: Shell Library Cleanup and Completion</li> <li>New Files</li> <li>4-Layer Architecture Established</li> <li>Core Patterns</li> <li>Bitbucket API Integration</li> <li>Benefits</li> <li>Next Steps</li> </ol>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#1-goal","title":"1. Goal","text":"<ol> <li>Bitbucket Cloud API integration for automatic build status reporting</li> <li>Abstract Git/Shell commands into reusable libraries</li> <li>Establish src/service/, src/utils/ layer architecture</li> </ol>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#2-commit-list-by-phase","title":"2. Commit List (by Phase)","text":"Phase Content Commit Count 1 Jenkins Environment Test and Bitbucket API Initial Implementation (2025-05-01) 7 2 Bitbucket API HTTP Communication Implementation and Debugging (2025-05-02 first half) 21 3 ShellScript Helper Refactoring (2025-05-02 second half) 8 4 Git Shell Scripts Implementation and stageProjectPrepare (2025-05-03) 26 5 GitLibrary/ShellLibrary Separation and BitbucketApiService (2025-05-04) 16 6 Shell Library Cleanup and Completion (2025-05-05) 6 Phase 1: Jenkins Environment Test and Bitbucket API Initial Implementation (7 commits) Date Commit Message 2025-05-01 <code>dd02d58</code> Add print jenkins environment 2025-05-01 <code>ea2d6bc</code> repo:push test 2025-05-01 <code>612b8e9</code> repo:push test 2025-05-01 <code>4fce553</code> Replace PR_BRANCH with GIT_BRANCH 2025-05-01 <code>ab3b6a6</code> Corrected PR_BRANCH to GIT_BRANCH 2025-05-01 <code>8b062fc</code> Delete necessary function to get full commit hash because full commit hash can be grabed as same value in Jenkins Initial Environment named 'GIT_COMMIT: Jenkins Log-763 2025-05-01 <code>12dcf8d</code> Implemented sendBuildStatusForCommit method to send build status to Bitbucket Cloud API. - Implemented it in low level to handle the details of the API request. - Implemented try-catch-finally block to handle exceptions. - Implemented withCredentials block to handle authentication. - Implemented try-with-resources block to handle resources. - Implemented logger to log the status of the build. - Implemented logger to log the response from the API. - Implemented logger to log the error message from the API. Phase 2: Bitbucket API HTTP Communication Implementation and Debugging (21 commits) Date Commit Message 2025-05-02 <code>e62b93f</code> Added package imports to apiHelper.groovy 2025-05-02 <code>43a73e0</code> Fixed Compail error 2025-05-02 <code>d17333e</code> Try to fix Compile Error 2025-05-02 <code>6e519c7</code> Add print StackTrace Error message code 2025-05-02 <code>d60a705</code> Try to print stacktrace error message 2025-05-02 <code>ef6406c</code> Add more logging for HTTP Request 2025-05-02 <code>a3011db</code> Added error type for HTTP request 2025-05-02 <code>ea71fb8</code> Try a new way to implement bitbucket api 2025-05-02 <code>97fe87b</code> Use StringBuilder not steam Collectors 2025-05-02 <code>dc76f45</code> Refactor SendBuildStatusForCommit Bitbucket API with HttpClient Class 2025-05-02 <code>72beb1f</code> Improve error logging 2025-05-02 <code>a761924</code> Fixed Compiler Error 2025-05-02 <code>aeae874</code> slightly touch StackTrace logging output 2025-05-02 <code>39725c6</code> Refactor Bitbucket API call 2025-05-02 <code>cd080f8</code> Added missing package importing in bitbucketApi groovy 2025-05-02 <code>a4bcc06</code> Added missing package in BitbucketApiClient groovy 2025-05-02 <code>4a9fe5b</code> Try to fix closing chuck expected error during Bitbucket API Communication 2025-05-02 <code>d0af7e3</code> Try to fix closing chunk expected second attempt 2025-05-02 <code>34e90c3</code> Missing variable declaralation 2025-05-02 <code>37980ea</code> slightly touch up logging message 2025-05-02 <code>cff33c3</code> Polishing Logging Phase 3: ShellScript Helper Refactoring (8 commits) Date Commit Message 2025-05-02 <code>9eaf277</code> Refactor try-out for ShellScript 2025-05-02 <code>7d4222a</code> Refactor ShellScriptHelper and Create ShellScripts as list of shellscript, delete ShellParams groovy 2025-05-02 <code>3678a3f</code> Try to fix Compaile Error 2025-05-02 <code>5a27ee0</code> Try to fix Compaile Error 2025-05-02 <code>555a11b</code> Try to fix Compaile Error 2025-05-02 <code>668d621</code> Fixed shellScriptHelper Implementation 2025-05-02 <code>3fc2917</code> Modified Data Type check and Empty Condition logic in validateShMap function, for GString 2025-05-02 <code>ee64f56</code> Mark unnecessary Jenkins Environment and Create a new Stage Phase 4: Git Shell Scripts Implementation and stageProjectPrepare (26 commits) Date Commit Message 2025-05-03 <code>ff92c62</code> Test isDirectory function 2025-05-03 <code>c862433</code> Test fileExists function instead of isDirectory 2025-05-03 <code>220bb9e</code> Fixed incorrect rutern data type for fileExists function 2025-05-03 <code>5585b83</code> new stageCheckoutSourceCode groovy Checkpoint 2025-05-03 <code>9c44606</code> Fixed GIT_SHOW_CUREENT_BRANCH Closure 2025-05-03 <code>cf092a4</code> Fixed ShellScripts.groovy to return the current branch name 2025-05-03 <code>aba6b68</code> Fixed GIT_SHOW_CURRENT_BRANCH Closure to return the current branch name 2025-05-03 <code>6dbf4e0</code> Fixed GIT_SHOW_CURRENT_BRANCH 2025-05-03 <code>7551ee8</code> Git test with pwd property 2025-05-03 <code>c479cb6</code> Fixed incorrect implementation for sh step and correct javadoc for ShellScripts groovy 2025-05-03 <code>8dda64b</code> Fixing GIT_SHOW_CURRENT_BRANCH Closure 2025-05-03 <code>1858dcf</code> Upgrade Shell Script Label 2025-05-03 <code>ca2cbb1</code> sh returnstdout test 2025-05-03 <code>da273ac</code> Improved logging 2025-05-03 <code>55a0fbe</code> Refactor a part of cloneOrUpdateRepo and test 2025-05-03 <code>9bf0779</code> Commented out the error log for the returnStdout option in shellScriptHelper.groovy, due to the better error handling in the sh step. 2025-05-03 <code>3e84f96</code> Implement Git source code checkout and synchronization logic - Created GIT_CHECK_ORIGIN_BRANCH_EXISTS to check if a branch exists on the 'origin' remote repository. - Created GIT_GET_ORIGIN_DEFAULT_BRANCH to get the default branch name for the 'origin' remote repository. - Changed the way to handle the error in shellScriptHelper.groovy, due to the better error handling in the sh step. - Implemented the Git Clone and Checkout logic in stageCheckoutSourceCode.groovy. - Implemented a part of the Synchronize with Default Branch logic in stageCheckoutSourceCode.groovy. 2025-05-03 <code>9b13c46</code> New shell scripts and updated existing shell scripts: - Created GIT_CHECK_ORIGIN_BRANCH_EXISTS to check if a branch exists on the 'origin' remote repository. - Fixed to use single quotes instead of triple quotes for shell scripts for GIT_GET_ORIGIN_DEFAULT_BRANCH. - Implemented GIT_CHECK_BRANCH_EXISTS to check if a branch exists locally or on the 'origin' remote. 2025-05-03 <code>ae9c014</code> Pipeline stage name change, Git sync check addition, and success logic modification - Rename stageCheckoutSourceCode to stageProjectPrepare - Created GIT_CHECK_UP_TO_DATE_WITH_REMOTE to check if the local branch is up to date with the remote branch - Rename stage names in Jenkinsfile - Modified how to handle successful logic in executeReturnStatus 2025-05-03 <code>ecf3e97</code> Add unstaged changes to previous commit 2025-05-03 <code>2bf21e7</code> Improved shell script helper function - Delete unused shell script helper function - Simplify ShellScriptHelper logging messages 2025-05-03 <code>89c1cca</code> Created / Implemented GIT_CHECK_IS_REMOTE_BRANCH_ANCESTOR shell script helper function 2025-05-03 <code>c995312</code> Implemented new shell script helper functions in stageProjectPrepare - Created GIT_CHECK_IS_REMOTE_BRANCH_ANCESTOR shell script helper function - Created GIT_MERGE_ORIGIN_BRANCH shell script helper function - Created GIT_LFS_FETCH_AND_CHECKOUT shell script helper function 2025-05-03 <code>432a130</code> Improved shell script logging 2025-05-03 <code>8eb0779</code> Commented out Prepare Workspace refacted into Jenkins Initialization and Project Preparation stages 2025-05-03 <code>7439856</code> Replace COMMIT_HASH with GIT_COMMIT Phase 5: GitLibrary/ShellLibrary Separation and BitbucketApiService (16 commits) Date Commit Message 2025-05-04 <code>8d6a236</code> Refactored Stages Implemented and Deleted Previous 2025-05-04 <code>aeeef99</code> Refactoring: ShellScripts into Libraries and Integration: - ShellScripts was refactored into GitLibrary and ShellLibrary - Implemented the refactored Libraries in stageProjectPrepare and stageInitialization 2025-05-04 <code>9702e3f</code> quick fixed incorrect class name usage 2025-05-04 <code>c637009</code> Implementation of Bitbucket API and Refactored related functions - Created BitbucketApiService and BitbucketApiLibrary - Created bitbucketApiHelper - Refactored stageInitialization 2025-05-04 <code>504cbdd</code> Add missing Class declaration 2025-05-04 <code>551c40d</code> Implmented not using BitbucketApiLibrary 2025-05-04 <code>3b38c6b</code> Add missing pakcage import 2025-05-04 <code>9454891</code> Try to fix 2025-05-04 <code>91ef0c6</code> Delete not use package import 2025-05-04 <code>f1c0a8e</code> Try to fix bitbucket API function 2025-05-04 <code>c8cd439</code> try to use function 2025-05-04 <code>97dd803</code> createBuildStatusForCommit 2025-05-04 <code>2dda24f</code> Try to fix api function variables 2025-05-04 <code>94ba7ec</code> Fixed calling incorrec method name 2025-05-04 <code>b6d8f82</code> Fixed Method Exception 2025-05-04 <code>efa5c44</code> Improved Http request logic and logging Phase 6: Shell Library Cleanup and Completion (6 commits) Date Commit Message 2025-05-05 <code>3278c38</code> Rename all Shell Library Clsoure for name convention 2025-05-05 <code>341252c</code> Implement dockerInfo shellscript into shellLibrary 2025-05-05 <code>26c2199</code> Add missing package import in PipelineForJenkins jenkinsfile 2025-05-05 <code>2c5eb16</code> Implement GroovyLint ShellScript into ShellLibrary 2025-05-05 <code>99387da</code> Added Missing Property for GroovyLint 2025-05-05 <code>48f4295</code> Take unnecessary log message in ShellLibrary GroovyLint script property"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#3-phase-by-phase-detailed-analysis","title":"3. Phase-by-Phase Detailed Analysis","text":""},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#31-phase-1-jenkins-environment-test-and-bitbucket-api-initial-implementation","title":"3.1 Phase 1: Jenkins Environment Test and Bitbucket API Initial Implementation","text":"View Details <p>Duration: 2025-05-01 (7 commits)</p> <p>Goal: Understand Jenkins environment variables and initial Bitbucket Cloud API implementation</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#step-1-jenkins-environment-variable-test-dd02d58-ab3b6a6","title":"Step 1: Jenkins Environment Variable Test (<code>dd02d58</code> ~ <code>ab3b6a6</code>)","text":"Commit Work <code>dd02d58</code> Jenkins environment variable output test <code>ea2d6bc</code> ~ <code>612b8e9</code> repo:push event test <code>4fce553</code> ~ <code>ab3b6a6</code> Replace PR_BRANCH with GIT_BRANCH"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#step-2-bitbucket-api-initial-implementation-8b062fc-12dcf8d","title":"Step 2: Bitbucket API Initial Implementation (<code>8b062fc</code> ~ <code>12dcf8d</code>)","text":"Commit Work <code>8b062fc</code> Delete full commit hash function (use GIT_COMMIT environment variable) <code>12dcf8d</code> Implement <code>sendBuildStatusForCommit</code> method: try-catch-finally, withCredentials, logger integration <p>Learning Points: - Jenkins provides full commit hash via <code>GIT_COMMIT</code> environment variable - Access commit info via environment variable without separate shell command</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#32-phase-2-bitbucket-api-http-communication-implementation-and-debugging","title":"3.2 Phase 2: Bitbucket API HTTP Communication Implementation and Debugging","text":"View Details <p>Duration: 2025-05-02 first half (21 commits)</p> <p>Goal: Implement and debug Bitbucket Cloud REST API HTTP communication</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#problem-solving-process","title":"Problem Solving Process","text":"Commit Attempt Problem Solution <code>e62b93f</code> Added package import - Added import to apiHelper.groovy <code>43a73e0</code> ~ <code>d17333e</code> Initial implementation Compile Error Fixed syntax errors <code>6e519c7</code> ~ <code>d60a705</code> Error logging StackTrace not visible Added print StackTrace code <code>ef6406c</code> ~ <code>a3011db</code> HTTP logging Need request/response verification Added error type logging <code>ea71fb8</code> ~ <code>97fe87b</code> HttpClient implementation Stream Collectors issue Changed to StringBuilder <code>dc76f45</code> Refactoring - Organized into HttpClient Class <code>72beb1f</code> ~ <code>aeae874</code> Error logging improvement Compiler Error Fixed and improved StackTrace output <code>39725c6</code> ~ <code>a4bcc06</code> API call refactoring Missing package Added import <code>4a9fe5b</code> ~ <code>d0af7e3</code> HTTP communication \"closing chunk expected\" Fixed chunk transfer method <code>34e90c3</code> ~ <code>cff33c3</code> Finalization Missing variable declaration Cleaned up logging <p>Learning Points: - Java 11+ HttpClient is usable in Jenkins Pipeline - StringBuilder is more stable than Stream Collectors in Jenkins CPS</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#33-phase-3-shellscript-helper-refactoring","title":"3.3 Phase 3: ShellScript Helper Refactoring","text":"View Details <p>Duration: 2025-05-02 second half (8 commits)</p> <p>Goal: Refactor ShellScript execution helper and remove ShellParams</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#problem-solving-process_1","title":"Problem Solving Process","text":"Commit Work Problem Solution <code>9eaf277</code> ShellScript refactoring attempt - Started structure change <code>7d4222a</code> Convert ShellScripts to list, delete ShellParams - Switched to Map-based <code>3678a3f</code> ~ <code>555a11b</code> Fix Compile Error Syntax error Fixed after 3 attempts <code>668d621</code> shellScriptHelper implementation complete - Final implementation <code>3fc2917</code> Fix validateShMap function GString type handling Improved type check logic <code>ee64f56</code> Clean up unnecessary env vars, create new Stage - Added stageCheckoutSourceCode <p>Code Change: <pre><code>// Before: ShellParams class\nShellParams params = new ShellParams(script: 'git fetch', label: 'Fetch')\n\n// After: Using Map\nshellScriptHelper.execute([script: 'git fetch', label: 'Fetch'])\n</code></pre></p> <p>Learning Points: - Groovy GString and String are handled as different types - Simple Map is more flexible than classes in Jenkins Pipeline</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#34-phase-4-git-shell-scripts-implementation-and-stageprojectprepare","title":"3.4 Phase 4: Git Shell Scripts Implementation and stageProjectPrepare","text":"View Details <p>Duration: 2025-05-03 (26 commits)</p> <p>Goal: Abstract Git commands as Closures and implement stageProjectPrepare Stage</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#step-1-file-existence-check-function-test-ff92c62-220bb9e","title":"Step 1: File Existence Check Function Test (<code>ff92c62</code> ~ <code>220bb9e</code>)","text":"Commit Attempt Problem Solution <code>ff92c62</code> isDirectory function test - Test <code>c862433</code> Changed to fileExists function - Alternative attempt <code>220bb9e</code> Fixed return type Wrong return type Fixed"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#step-2-stagecheckoutsourcecode-and-git-closure-5585b83-7439856","title":"Step 2: stageCheckoutSourceCode and Git Closure (<code>5585b83</code> ~ <code>7439856</code>)","text":"Commit Work <code>5585b83</code> stageCheckoutSourceCode.groovy checkpoint <code>9c44606</code> ~ <code>6dbf4e0</code> Fixed GIT_SHOW_CURRENT_BRANCH Closure (4 attempts) <code>7551ee8</code> ~ <code>c479cb6</code> pwd test, fixed sh step implementation <code>8dda64b</code> ~ <code>1858dcf</code> Final GIT_SHOW_CURRENT_BRANCH fix, Shell Script Label improvement <code>ca2cbb1</code> ~ <code>da273ac</code> returnStdout test, logging improvement <code>55a0fbe</code> Partial cloneOrUpdateRepo refactoring <code>9bf0779</code> Commented out returnStdout error log <code>3e84f96</code> Implemented Git checkout/sync logic: GIT_CHECK_ORIGIN_BRANCH_EXISTS, GIT_GET_ORIGIN_DEFAULT_BRANCH <code>9b13c46</code> Additional shell scripts: single quotes usage, GIT_CHECK_BRANCH_EXISTS <code>ae9c014</code> Renamed stageCheckoutSourceCode \u2192 stageProjectPrepare, added GIT_CHECK_UP_TO_DATE_WITH_REMOTE <code>ecf3e97</code> ~ <code>2bf21e7</code> Added unstaged changes, deleted unnecessary functions <code>89c1cca</code> ~ <code>c995312</code> Implemented GIT_CHECK_IS_REMOTE_BRANCH_ANCESTOR, GIT_MERGE_ORIGIN_BRANCH, GIT_LFS_FETCH_AND_CHECKOUT <code>432a130</code> ~ <code>7439856</code> Logging improvement, replaced COMMIT_HASH with GIT_COMMIT <p>Learning Points: - Closure for Shell command definition enables parameterized reuse - Need to trim results when using <code>returnStdout: true</code></p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#35-phase-5-gitlibraryshelllibrary-separation-and-bitbucketapiservice","title":"3.5 Phase 5: GitLibrary/ShellLibrary Separation and BitbucketApiService","text":"View Details <p>Duration: 2025-05-04 (16 commits)</p> <p>Goal: Separate Shell Scripts into GitLibrary/ShellLibrary and implement BitbucketApiService</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#step-1-library-separation-8d6a236-9702e3f","title":"Step 1: Library Separation (<code>8d6a236</code> ~ <code>9702e3f</code>)","text":"Commit Work <code>8d6a236</code> Deleted previous Stage and refactored <code>aeeef99</code> Separated ShellScripts \u2192 GitLibrary + ShellLibrary, applied to stageProjectPrepare/stageInitialization <code>9702e3f</code> Fixed incorrect class name"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#step-2-bitbucketapiservice-implementation-c637009-efa5c44","title":"Step 2: BitbucketApiService Implementation (<code>c637009</code> ~ <code>efa5c44</code>)","text":"Commit Attempt Problem Solution <code>c637009</code> Created BitbucketApiService, bitbucketApiHelper - Initial implementation <code>504cbdd</code> Missing Class declaration Compile Error Added <code>551c40d</code> Implemented without BitbucketApiLibrary - Simplified <code>3b38c6b</code> ~ <code>91ef0c6</code> Package import issue Compile Error Fixed/deleted import <code>f1c0a8e</code> ~ <code>c8cd439</code> Fixed API function Not working Attempted <code>97dd803</code> createBuildStatusForCommit - Function implementation <code>2dda24f</code> Fixed variables - Attempted <code>94ba7ec</code> Fixed method name Wrong method call Fixed <code>b6d8f82</code> Fixed Method Exception Exception occurred Fixed <code>efa5c44</code> Improved HTTP request logic and logging - Final cleanup <p>Architecture Change: <pre><code>Before:  src/utils/ShellScripts.groovy (all Shell commands)\nAfter:   src/utils/GitLibrary.groovy\n         src/utils/ShellLibrary.groovy\n         src/service/general/BitbucketApiService.groovy\n</code></pre></p> <p>Learning Points: - Domain-based Library separation improves management/testing - Encapsulate business logic (API calls) in Service layer</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#36-phase-6-shell-library-cleanup-and-completion","title":"3.6 Phase 6: Shell Library Cleanup and Completion","text":"View Details <p>Duration: 2025-05-05 (6 commits)</p> <p>Goal: Unify Shell Library naming convention and implement additional scripts</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#work-by-commit","title":"Work by Commit","text":"Commit Work <code>3278c38</code> Unified all Shell Library Closure naming convention <code>341252c</code> Added DOCKER_INFO shellscript <code>26c2199</code> Added package import to PipelineForJenkins Jenkinsfile <code>2c5eb16</code> Implemented GROOVY_LINT ShellScript <code>99387da</code> Added missing GroovyLint Property <code>48f4295</code> Removed unnecessary log message <p>Learning Points: - Consistent naming convention (<code>VERB_NOUN</code>) improves code readability - When adding Closure to Library, manage related properties together</p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#4-new-files","title":"4. New Files","text":""},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#41-layer-3-service-business-logic","title":"4.1 Layer 3: Service (Business Logic)","text":""},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#sharedlibrariessrcservicegeneralbitbucketapiservicegroovy-155-lines","title":"<code>sharedLibraries/src/service/general/BitbucketApiService.groovy</code> (155 lines)","text":"<p>Bitbucket Cloud REST API client <pre><code>class BitbucketApiService {\n    def pipeline\n\n    BitbucketApiService(pipeline) {\n        this.pipeline = pipeline\n    }\n\n    void sendBuildStatusForCommit(String commitHash, String state, String key, String url, String description) {\n        // HTTP POST to Bitbucket Cloud API\n        // /2.0/repositories/{workspace}/{repo}/commit/{commit}/statuses/build\n    }\n}\n</code></pre></p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#42-layer-4-utils-libraries","title":"4.2 Layer 4: Utils (Libraries)","text":""},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#sharedlibrariessrcutilsgitlibrarygroovy-258-lines","title":"<code>sharedLibraries/src/utils/GitLibrary.groovy</code> (258 lines)","text":"<p>Git command library <pre><code>class GitLibrary {\n    // Check branch existence\n    static Closure GIT_CHECK_ORIGIN_BRANCH_EXISTS = { branchName -&gt;\n        \"git ls-remote --heads origin ${branchName} | grep -q ${branchName}\"\n    }\n\n    // Get default branch\n    static Closure GIT_GET_ORIGIN_DEFAULT_BRANCH = {\n        \"git remote show origin | grep 'HEAD branch' | cut -d' ' -f5\"\n    }\n\n    // Check if remote branch is ancestor\n    static Closure GIT_CHECK_IS_REMOTE_BRANCH_ANCESTOR = { baseBranch, targetBranch -&gt;\n        \"git merge-base --is-ancestor origin/${baseBranch} origin/${targetBranch}\"\n    }\n\n    // Merge remote branch\n    static Closure GIT_MERGE_ORIGIN_BRANCH = { branchName -&gt;\n        \"git merge origin/${branchName} --no-edit\"\n    }\n\n    // Git LFS fetch and checkout\n    static Closure GIT_LFS_FETCH_AND_CHECKOUT = {\n        \"git lfs fetch --all &amp;&amp; git lfs checkout\"\n    }\n\n    // Check if local branch is synced with remote\n    static Closure GIT_CHECK_UP_TO_DATE_WITH_REMOTE = { branchName -&gt;\n        '''\n        LOCAL=$(git rev-parse HEAD)\n        REMOTE=$(git rev-parse origin/${branchName})\n        [ \"$LOCAL\" = \"$REMOTE\" ]\n        '''\n    }\n}\n</code></pre></p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#sharedlibrariessrcutilsshelllibrarygroovy-210-lines","title":"<code>sharedLibraries/src/utils/ShellLibrary.groovy</code> (210 lines)","text":"<p>General Shell command library <pre><code>class ShellLibrary {\n    // Get Docker info\n    static Closure DOCKER_INFO = {\n        \"docker info\"\n    }\n\n    // Execute Groovy Lint\n    static Closure GROOVY_LINT = { targetPath, configPath -&gt;\n        \"npm-groovy-lint --path ${targetPath} --config ${configPath}\"\n    }\n\n    // Copy file\n    static Closure COPY_FILE = { source, destination -&gt;\n        \"cp ${source} ${destination}\"\n    }\n\n    // Check directory existence\n    static Closure CHECK_DIR_EXISTS = { path -&gt;\n        \"[ -d ${path} ]\"\n    }\n}\n</code></pre></p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#43-layer-2-vars-entry-points","title":"4.3 Layer 2: vars/ (Entry Points)","text":""},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#sharedlibrariesvarsbitbucketapihelpergroovy-33-lines","title":"<code>sharedLibraries/vars/bitbucketApiHelper.groovy</code> (33 lines)","text":"<pre><code>def sendBuildStatus(String state, String description) {\n    BitbucketApiService service = new BitbucketApiService(this)\n    service.sendBuildStatusForCommit(\n        env.GIT_COMMIT,\n        state,\n        env.BUILD_TAG,\n        env.BUILD_URL,\n        description\n    )\n}\n</code></pre>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#sharedlibrariesvarsstageprojectpreparegroovy-84-lines","title":"<code>sharedLibraries/vars/stageProjectPrepare.groovy</code> (84 lines)","text":"<p>Git checkout and project preparation Stage <pre><code>def call(Map config = [:]) {\n    logger.stageStart(env.STAGE_NAME)\n\n    logger.stepsGroupStart('Git Repository Setup')\n    // Use GitLibrary functions\n    shellScriptHelper.execute(GitLibrary.GIT_CHECK_ORIGIN_BRANCH_EXISTS(env.PR_BRANCH))\n    // ...\n\n    logger.stepsGroupEnd('Git Repository Setup')\n    logger.stageEnd(env.STAGE_NAME)\n}\n</code></pre></p>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#5-4-layer-architecture-established","title":"5. 4-Layer Architecture Established","text":"<pre><code>devops-jenkins-linux/\n\u251c\u2500\u2500 */Jenkinsfile                      # Layer 1: Entry Point\n\u2502   \u251c\u2500\u2500 DLXJenkins/Jenkinsfile\n\u2502   \u251c\u2500\u2500 DLXJenkins/JenkinsfileDeployment\n\u2502   \u251c\u2500\u2500 JsJenkins/Jenkinsfile\n\u2502   \u251c\u2500\u2500 JsJenkins/JenkinsfileDeployment\n\u2502   \u2514\u2500\u2500 PipelineForJenkins/Jenkinsfile\n\u2502\n\u2514\u2500\u2500 sharedLibraries/\n    \u251c\u2500\u2500 vars/                          # Layer 2: Orchestration\n    \u2502   \u251c\u2500\u2500 stageInitialization.groovy\n    \u2502   \u251c\u2500\u2500 stageProjectPrepare.groovy\n    \u2502   \u251c\u2500\u2500 shellScriptHelper.groovy\n    \u2502   \u251c\u2500\u2500 bitbucketApiHelper.groovy\n    \u2502   \u2514\u2500\u2500 logger.groovy (Cross-Cutting)\n    \u2502\n    \u2514\u2500\u2500 src/\n        \u251c\u2500\u2500 service/                   # Layer 3: Services\n        \u2502   \u2514\u2500\u2500 general/\n        \u2502       \u2514\u2500\u2500 BitbucketApiService.groovy\n        \u2502\n        \u251c\u2500\u2500 utils/                     # Layer 4: Utilities\n        \u2502   \u251c\u2500\u2500 GitLibrary.groovy\n        \u2502   \u2514\u2500\u2500 ShellLibrary.groovy\n        \u2502\n        \u2514\u2500\u2500 resource/                  # Layer 4: Utilities (Constants)\n            \u2514\u2500\u2500 Status.groovy\n</code></pre>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#6-core-patterns","title":"6. Core Patterns","text":""},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#61-shell-command-abstraction-using-closure","title":"6.1 Shell Command Abstraction Using Closure","text":"<pre><code>// Definition (GitLibrary.groovy)\nstatic Closure GIT_FETCH_ORIGIN = { branchName -&gt;\n    \"git fetch origin ${branchName}\"\n}\n\n// Usage (stageProjectPrepare.groovy)\nshellScriptHelper.execute([\n    script: GitLibrary.GIT_FETCH_ORIGIN(env.PR_BRANCH),\n    label: 'Fetch PR branch from origin'\n])\n</code></pre>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#62-advantages","title":"6.2 Advantages","text":"<ol> <li>Type Safety: Clearly define parameters with Closure</li> <li>Reusability: Use same Git commands in multiple Stages</li> <li>Testability: Test Shell command string generation logic independently</li> <li>Documentation: Can add descriptions for each command</li> </ol>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#7-bitbucket-api-integration","title":"7. Bitbucket API Integration","text":""},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#71-build-status-reporting-flow","title":"7.1 Build Status Reporting Flow","text":"<pre><code>Pipeline Start\n    \u2193\nbitbucketApiHelper.sendBuildStatus('INPROGRESS', 'Build started')\n    \u2193\n... (build execution) ...\n    \u2193\nbitbucketApiHelper.sendBuildStatus('SUCCESSFUL', 'Build completed')\n    or\nbitbucketApiHelper.sendBuildStatus('FAILED', 'Build failed')\n</code></pre>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#72-verification-in-bitbucket-pr","title":"7.2 Verification in Bitbucket PR","text":"<ul> <li>Build status badge displayed on PR page</li> <li>Per-commit build result verification possible</li> </ul>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#8-benefits","title":"8. Benefits","text":"<ol> <li>Centralization: Git/Shell commands managed in one place</li> <li>Consistency: All pipelines use same commands</li> <li>Visibility: Real-time build status verification in Bitbucket</li> <li>Maintainability: Only modify library when changing commands</li> </ol>"},{"location":"problem-solving/phase-3-bitbucket-api-and-shell-library-integration/changelog/#9-next-steps","title":"9. Next Steps","text":"<p>\u2192 Phase 4: Full Pipeline Refactoring and Stage Modularization</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/","title":"Phase 4: Full Pipeline Refactoring &amp; Stage Modularization","text":""},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#basic-information","title":"Basic Information","text":"Item Value Start <code>48f4295</code> (2025-05-05, Phase 3 ended) Final <code>ff74ac8</code> (2025-05-12) Total Commits 128 Duration 2025-05-06 ~ 2025-05-12 (7 days)"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Goal</li> <li>Commit List (by Phase)</li> <li>Phase-by-Phase Detailed Analysis</li> <li>3.1 Phase 1: PipelineForJenkins Stage Modularization</li> <li>3.2 Phase 2: DLX Pipeline Webhook Trigger Configuration</li> <li>3.3 Phase 3: DLX-PR-Pipeline Stage Modularization</li> <li>3.4 Phase 4: DLX-Deployment Pipeline Refactoring</li> <li>3.5 Phase 5: Full Jenkinsfile Cleanup and Integration</li> <li>3.6 Phase 6: SSH Library and Deployment Feature Completion</li> <li>3.7 Phase 7: Finalization and Bug Fixes</li> <li>New Stage Files</li> <li>New Libraries</li> <li>Jenkinsfile Transformation Example</li> <li>Webhook Configuration Improvements</li> <li>Final Architecture</li> <li>Benefits</li> <li>Conclusion</li> </ol>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#1-goal","title":"1. Goal","text":"<p>Modularize all Stages of 5 pipelines so Jenkinsfiles consist only of Stage calls</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#2-commit-list-by-phase","title":"2. Commit List (by Phase)","text":"Phase Content Commit Count 1 PipelineForJenkins Stage Modularization (2025-05-05 ~ 2025-05-06 early) 8 2 DLX Pipeline Webhook Trigger Configuration (2025-05-06) 40 3 DLX-PR-Pipeline Stage Modularization (2025-05-07 first half) 24 4 DLX-Deployment Pipeline Refactoring (2025-05-07 middle) 22 5 Full Jenkinsfile Cleanup and Integration (2025-05-07 second half) 18 6 SSH Library and Deployment Feature Completion (2025-05-08) 12 7 Finalization and Bug Fixes (2025-05-09 ~ 2025-05-12) 4 Phase 1: PipelineForJenkins Stage Modularization (8 commits) Date Commit Message 2025-05-05 <code>8e96fb9</code> Improved shellScriptHelper logging 2025-05-06 <code>3ef978a</code> Refactored LintGrovyJenkinsfile Stage 2025-05-06 <code>9dcc23b</code> Added logging in stageLintGroovyJenkinsfile 2025-05-06 <code>6f4cf84</code> Modulized Static Analysis Stage 2025-05-06 <code>0e66b11</code> Test Modulized Static Analysis Stage 2025-05-06 <code>87e8a89</code> Replace the un-modularized bitbucket api function with the modularized one for post steps 2025-05-06 <code>2c2d821</code> Refactored SonarQube test 2025-05-06 <code>063955e</code> Added Missing the variable for importing package Phase 2: DLX Pipeline Webhook Trigger Configuration (40 commits) Date Commit Message 2025-05-06 <code>4c8509e</code> == Start DLX Pipeline Refactoring == : Refactored Prepare Workspace Stage 2025-05-06 <code>f25f136</code> Commented out regexpFilter for DLX Pipeline 2025-05-06 <code>c26d434</code> try to get full request body 2025-05-06 <code>19c71e9</code> Added getting BITBUCKET_EVENT_KEY 2025-05-06 <code>3ac83a5</code> Fixed how to import Http Header variables 2025-05-06 <code>163cff2</code> getting full request header 2025-05-06 <code>e2fe075</code> Test getting http request header 2025-05-06 <code>f09fcc9</code> quick teset 2025-05-06 <code>1fff356</code> modified logging for getting http request body and header 2025-05-06 <code>d5eab38</code> Added Request Body and Header trigger 2025-05-06 <code>79f6155</code> One more time webhoob trigger for implmenting GenericTrigger configuration fully 2025-05-06 <code>0c004ac</code> Try to retrieve x event key only 2025-05-06 <code>cbb805f</code> Try to not to use expression of JsonPath for Http header 2025-05-06 <code>b6f2c58</code> Try new way to retrieve http header 2025-05-06 <code>85b81c3</code> Try new way to retrieve http header 2025-05-06 <code>f948ddd</code> Try to retrieve lowcase and underscore for generic Header Variables 2025-05-06 <code>b558e24</code> Try one more time 2025-05-06 <code>58edeec</code> X-Event-Key 2025-05-06 <code>1811e1c</code> Added regexpFilter for HTTP Header 2025-05-06 <code>7e07e96</code> Print env first 2025-05-06 <code>943c40c</code> Try to use x_event_key 2025-05-06 <code>50ea98a</code> Push to check accessing x-event-key header 2025-05-06 <code>cb5a64a</code> Try to get Branch name 2025-05-06 <code>fcb920f</code> Test Http body Json retrieving 2025-05-06 <code>ac3bb52</code> Print Json Request body Jons 2025-05-06 <code>b1456e6</code> Try to use HTTP BODY JSON 2025-05-06 <code>374e775</code> Assigned all necessary Jenkins environment for repo push Bitbucket WebTrigger 2025-05-06 <code>76296e7</code> Same Implement repo push event trigger for DLX PR pipeline 2025-05-06 <code>ee741e8</code> Incorrect environment variable using for PR_BRANCH 2025-05-06 <code>c9220f4</code> Added missing package importing 2025-05-06 <code>f87e726</code> Switch better symbol for info log 2025-05-06 <code>9b173c0</code> DLX-PR-Pipeline-Linting Stage 2025-05-06 <code>a08e8e9</code> Test loading groovy file in Envrionment 2025-05-06 <code>39f37c1</code> Take loading groovy in environment braket off 2025-05-06 <code>c183faa</code> Fixed empty value for REPORT_DIR 2025-05-06 <code>6876f0b</code> Fixed Destination Branch Environment Assignment logic 2025-05-06 <code>d09288f</code> Add missing package importing 2025-05-06 <code>d9ed92e</code> Added More Missing Packge Importing 2025-05-06 <code>fc77459</code> Added More step to secure returning value from shellscript 2025-05-06 <code>27dcc7c</code> Implement DESTINATION_BRANCH environment value assignment in different way for every pipelines Phase 3: DLX-PR-Pipeline Stage Modularization (24 commits) Date Commit Message 2025-05-07 <code>d8aab9b</code> Refactored Unity Linting STage 2025-05-07 <code>27dd597</code> try to fix copy lint config file for unity linting 2025-05-07 <code>ebfd6fb</code> Correct unnecessary argument for CopyLintConfig ShellScripting 2025-05-07 <code>88f815b</code> Try to fix shellscript 2025-05-07 <code>ce58b16</code> Add sh inside shellScript 2025-05-07 <code>ed7f993</code> EditMode modulurized test 2025-05-07 <code>c01107f</code> EditMode stage test 2025-05-07 <code>59009e0</code> Fixed how to use goorvy file in vars 2025-05-07 <code>319d413</code> Refacted PlayMode and Coverage Stage 2025-05-07 <code>5b43e05</code> Refactored CopyWebGLBuilder file 2025-05-07 <code>173e352</code> Fixed wrong import package 2025-05-07 <code>6bd044f</code> Added Missing Reference 2025-05-07 <code>e9b7c70</code> Change logic for checking lighting and reflection Probe files 2025-05-07 <code>07f2646</code> Try to improve new logging style 2025-05-07 <code>e2f47d3</code> Refactored Build Project Stage for DLX PR pipeline 2025-05-07 <code>f2828b3</code> Improve logging and detatched stripIndent functions for error issue 2025-05-07 <code>65878e3</code> Delete no need paranthesis in checkLightingAndReflectionFiles 2025-05-07 <code>4e0b1ff</code> Improved logger 2025-05-07 <code>e36d730</code> stiripIndent function test 2025-05-07 <code>591b815</code> stripIndent function test 2025-05-07 <code>703d90f</code> Implement stripIndent function 2025-05-07 <code>bb271db</code> Fixed incorrect argument to execute webgl build unity headless mode 2025-05-07 <code>85fea53</code> Complete DLX-PR-Pipeline Refactor 2025-05-07 <code>69357f0</code> Pointing Refactor-with-TDD global Trusted Shared Library Branch Phase 4: DLX-Deployment Pipeline Refactoring (22 commits) Date Commit Message 2025-05-07 <code>500ca0e</code> Delete Unnecessary function 2025-05-07 <code>d54d03e</code> Try to added regexpFilterExpression for not merged trigger for PR branch 2025-05-07 <code>83e8eaf</code> test webhook trigger filter for jenkins pipeline 2025-05-07 <code>8d0608a</code> Add getting http x-event-key header value for DLX-Deployment pipeline 2025-05-07 <code>4bf13d8</code> Deleted unnecessary try and catch 2025-05-07 <code>25187d9</code> Refactor Delete Merged Branch Stage 2025-05-07 <code>5e6acfc</code> Moved logger inside script bracket 2025-05-07 <code>0857b38</code> Debugging fileExist function 2025-05-07 <code>201d711</code> Refactoring Cleanup PR Branch Artifacts 2025-05-07 <code>c8ce9b3</code> refactor again 2025-05-07 <code>a8d7bcd</code> Try to fix directory finding 2025-05-07 <code>3e038c8</code> Use different configuration property to find PR path 2025-05-07 <code>9b2f802</code> Try to use wildcard 2025-05-07 <code>e1e312b</code> Implement Cleanup PR Branch Artifacts 2025-05-07 <code>970293e</code> Fixed not use trim 2025-05-07 <code>3234206</code> Fixed incorrect return value for FindPRJobDirectory 2025-05-07 <code>18dbce2</code> Modulurized the stage 2025-05-07 <code>7e5773d</code> Refactor stageProjectPrepare groovy for unify PR and Deployment Pipeline together 2025-05-07 <code>c209fc0</code> Refactored Prepare Workspace into Project Preparation 2025-05-07 <code>790c946</code> Fixed the delete PR artifacts file logic for CD pipeline 2025-05-07 <code>9878a06</code> Refactor Linting Stage 2025-05-07 <code>c31dd95</code> Test Refactor Unity Execution in Deployment Phase 5: Full Jenkinsfile Cleanup and Integration (18 commits) Date Commit Message 2025-05-07 <code>eef487b</code> Temparory test 2025-05-07 <code>c432015</code> Modulurized ssh shell scripting for Deploying WebGL to dlx-web hosting server 2025-05-07 <code>68626bb</code> Initial Refactor completed 2025-05-07 <code>5aa21ce</code> Initial Refactored jenkinsflies for DLX-PR, Deployment, and Pipeline Code 2025-05-07 <code>c5f85e8</code> Improved Linting logic for Unity 2025-05-07 <code>ec9a895</code> Polish ShellLibrary.groovy to improve readability 2025-05-07 <code>7a7f017</code> Fixed incorrect python calling 2025-05-07 <code>00c271e</code> git add . 2025-05-07 <code>7ae76ab</code> Improved catchError function 2025-05-07 <code>f469267</code> Refactored sendTestReport function in UnityHelper into ShellLibrary 2025-05-07 <code>3154ca8</code> Added getting PR_COMMIT for pullrequest event webhook 2025-05-07 <code>92ee76a</code> Updated stageInitialization groovy more readable 2025-05-07 <code>5e743b4</code> Modified ShellScripting Logging Message 2025-05-07 <code>922b4b2</code> Add dir function to get full commit hash 2025-05-07 <code>ce227c9</code> Added one more logging for shellscript result 2025-05-07 <code>432064f</code> Updated logging in stageInitialization 2025-05-07 <code>818100a</code> Changed shellscript type for ssh 2025-05-07 <code>02311c4</code> Added Connection check ssh Phase 6: SSH Library and Deployment Feature Completion (12 commits) Date Commit Message 2025-05-08 <code>7deca3e</code> Try to fix ssh command 2025-05-08 <code>02f76b7</code> Check SSH Connectivity Modulurized 2025-05-08 <code>b42f4b8</code> Added Network Connection Check 2025-05-08 <code>8ff97bc</code> EconestogaDLX connection check 2025-05-08 <code>c4c8da5</code> Added ConnectionAttempts for CheckSSHConnectivity 2025-05-08 <code>31950bd</code> Added stripIndent for ssh 2025-05-08 <code>7ce9794</code> Added stripIndent for every ssh shellscript 2025-05-08 <code>1e8e9dc</code> Improved logging 2025-05-08 <code>1e94b39</code> logging improved 2025-05-08 <code>7de89c2</code> Added stripIdent() and trim() for every shellscript 2025-05-08 <code>a0e53db</code> Fixed one git library 2025-05-08 <code>a381824</code> Fixed typo Phase 7: Finalization and Bug Fixes (4 commits) Date Commit Message 2025-05-09 <code>4db95fe</code> Added missing package in Gladle test configuration 2025-05-09 <code>c54feff</code> Delete artifact(dump file) of running test locally 2025-05-09 <code>10bec90</code> Added Error handling for bitbucket api communication 2025-05-12 <code>ff74ac8</code> Revert \"Temparory test\""},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#3-phase-by-phase-detailed-analysis","title":"3. Phase-by-Phase Detailed Analysis","text":""},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#31-phase-1-pipelineforjenkins-stage-modularization","title":"3.1 Phase 1: PipelineForJenkins Stage Modularization","text":"View Details <p>Duration: 2025-05-05 ~ 2025-05-06 early (8 commits)</p> <p>Goal: Stage modularization of first pipeline (PipelineForJenkins)</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#work-by-commit","title":"Work by Commit","text":"Commit Work <code>8e96fb9</code> Improved shellScriptHelper logging <code>3ef978a</code> Refactored LintGroovyJenkinsfile Stage <code>9dcc23b</code> Added logging to stageLintGroovyJenkinsfile <code>6f4cf84</code> Modularized Static Analysis Stage <code>0e66b11</code> Tested Static Analysis Stage <code>87e8a89</code> Replaced with modularized bitbucket api function in post steps <code>2c2d821</code> SonarQube refactoring test <code>063955e</code> Added missing package import variable <p>Learning Points: - Start refactoring with the simplest pipeline - Separate each Stage into independent files in vars/ folder</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#32-phase-2-dlx-pipeline-webhook-trigger-configuration","title":"3.2 Phase 2: DLX Pipeline Webhook Trigger Configuration","text":"View Details <p>Duration: 2025-05-06 (40 commits)</p> <p>Goal: Implement GenericTrigger-based Webhook for DLX pipeline</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-1-webhook-trigger-initial-configuration-4c8509e-79f6155","title":"Step 1: Webhook Trigger Initial Configuration (<code>4c8509e</code> ~ <code>79f6155</code>)","text":"Commit Work <code>4c8509e</code> Started DLX Pipeline refactoring, refactored Prepare Workspace Stage <code>f25f136</code> Commented out DLX Pipeline regexpFilter <code>c26d434</code> ~ <code>163cff2</code> Attempted to get HTTP request body/header <code>e2fe075</code> ~ <code>1fff356</code> HTTP request header test and logging modification <code>d5eab38</code> ~ <code>79f6155</code> Added Request Body/Header trigger, GenericTrigger configuration"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-2-http-header-processing-issue-resolution-0c004ac-50ea98a","title":"Step 2: HTTP Header Processing Issue Resolution (<code>0c004ac</code> ~ <code>50ea98a</code>)","text":"Commit Attempt Problem Solution <code>0c004ac</code> ~ <code>cbb805f</code> Get x-event-key JsonPath expression issue Tried removing expression <code>b6f2c58</code> ~ <code>b558e24</code> Changed header access method Tried lowercase/underscore Tested various methods <code>58edeec</code> X-Event-Key - Used exact header name <code>1811e1c</code> ~ <code>50ea98a</code> Added regexpFilter Environment variable access Tried x_event_key"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-3-webhook-completion-and-environment-variable-setup-cb5a64a-27dcc7c","title":"Step 3: Webhook Completion and Environment Variable Setup (<code>cb5a64a</code> ~ <code>27dcc7c</code>)","text":"Commit Work <code>cb5a64a</code> ~ <code>b1456e6</code> Tested getting Branch name, HTTP body JSON <code>374e775</code> Completed Jenkins environment variable assignment for repo:push event <code>76296e7</code> ~ <code>ee741e8</code> Applied same implementation to DLX PR pipeline, fixed PR_BRANCH environment variable <code>c9220f4</code> ~ <code>d9ed92e</code> Fixed missing package import <code>fc77459</code> ~ <code>27dcc7c</code> Handled shellscript return value, separated DESTINATION_BRANCH assignment logic <p>Learning Points: - GenericTrigger plugin handles Bitbucket Webhook - Access HTTP header variables with lowercase+underscore (x_event_key) - Separate PR events and Push events with regexpFilter</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#33-phase-3-dlx-pr-pipeline-stage-modularization","title":"3.3 Phase 3: DLX-PR-Pipeline Stage Modularization","text":"View Details <p>Duration: 2025-05-07 first half (24 commits)</p> <p>Goal: Modularize Unity-related Stages for DLX PR pipeline</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-1-unity-linting-stage-d8aab9b-ce58b16","title":"Step 1: Unity Linting Stage (<code>d8aab9b</code> ~ <code>ce58b16</code>)","text":"Commit Attempt Problem Solution <code>d8aab9b</code> Refactored Unity Linting Stage - Started <code>27dd597</code> ~ <code>88f815b</code> Copy lint config file shellscript issue Attempted fix <code>ce58b16</code> Added sh - Added sh inside shellscript"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-2-unity-test-stage-ed7f993-319d413","title":"Step 2: Unity Test Stage (<code>ed7f993</code> ~ <code>319d413</code>)","text":"Commit Work <code>ed7f993</code> ~ <code>c01107f</code> Modularized EditMode Stage test <code>59009e0</code> Fixed how to use groovy file in vars <code>319d413</code> Refactored PlayMode, Coverage Stage"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-3-build-stage-and-finalization-5b43e05-69357f0","title":"Step 3: Build Stage and Finalization (<code>5b43e05</code> ~ <code>69357f0</code>)","text":"Commit Work <code>5b43e05</code> ~ <code>6bd044f</code> Refactored CopyWebGLBuilder, fixed package <code>e9b7c70</code> Changed Lighting/ReflectionProbe file check logic <code>07f2646</code> ~ <code>4e0b1ff</code> Improved logging style <code>e2f47d3</code> Refactored Build Project Stage <code>f2828b3</code> ~ <code>703d90f</code> Implemented stripIndent function (3 attempts) <code>bb271db</code> Fixed Unity headless mode argument <code>85fea53</code> Completed DLX-PR-Pipeline refactoring <code>69357f0</code> Pointed Library to Refactor-with-TDD branch <p>Learning Points: - Parameterize Unity-related Stages for reuse (testType: 'EditMode'/'PlayMode') - stripIndent() function improves multiline script readability</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#34-phase-4-dlx-deployment-pipeline-refactoring","title":"3.4 Phase 4: DLX-Deployment Pipeline Refactoring","text":"View Details <p>Duration: 2025-05-07 middle (22 commits)</p> <p>Goal: Refactor DLX Deployment(CD) pipeline</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-1-webhook-and-basic-stage-500ca0e-4bf13d8","title":"Step 1: Webhook and Basic Stage (<code>500ca0e</code> ~ <code>4bf13d8</code>)","text":"Commit Work <code>500ca0e</code> Deleted unnecessary function <code>d54d03e</code> ~ <code>83e8eaf</code> Tested filter for unmerged PR branch trigger <code>8d0608a</code> Added x-event-key header value for DLX-Deployment pipeline <code>4bf13d8</code> Deleted unnecessary try-catch"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-2-cleanup-pr-branch-artifacts-stage-25187d9-790c946","title":"Step 2: Cleanup PR Branch Artifacts Stage (<code>25187d9</code> ~ <code>790c946</code>)","text":"Commit Attempt Problem Solution <code>25187d9</code> Refactored Delete Merged Branch Stage - Started <code>5e6acfc</code> ~ <code>0857b38</code> Moved logger location, debugged fileExists - Test <code>201d711</code> ~ <code>a8d7bcd</code> Refactored Cleanup PR Branch Artifacts Directory finding issue Attempted <code>3e038c8</code> ~ <code>9b2f802</code> Used different config property, tried wildcard - Test <code>e1e312b</code> Implementation complete - Final <code>970293e</code> ~ <code>3234206</code> Fixed unused trim, fixed FindPRJobDirectory return value - Bug fix <code>18dbce2</code> Stage modularization complete - Final <code>7e5773d</code> ~ <code>c209fc0</code> Integrated stageProjectPrepare (PR + Deployment) - Integration <code>790c946</code> Fixed PR artifacts delete logic for CD pipeline - Fix"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-3-remaining-stage-refactoring-9878a06-c31dd95","title":"Step 3: Remaining Stage Refactoring (<code>9878a06</code> ~ <code>c31dd95</code>)","text":"Commit Work <code>9878a06</code> Refactored Linting Stage <code>c31dd95</code> Tested Deployment Unity Execution refactoring <p>Learning Points: - Share stageProjectPrepare between PR and Deployment pipelines - PR artifact cleanup logic needs Jenkins workspace path handling</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#35-phase-5-full-jenkinsfile-cleanup-and-integration","title":"3.5 Phase 5: Full Jenkinsfile Cleanup and Integration","text":"View Details <p>Duration: 2025-05-07 second half (18 commits)</p> <p>Goal: Clean up all Jenkinsfiles and implement SSH deployment</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-1-ssh-deployment-and-initial-cleanup-eef487b-5aa21ce","title":"Step 1: SSH Deployment and Initial Cleanup (<code>eef487b</code> ~ <code>5aa21ce</code>)","text":"Commit Work <code>eef487b</code> Temporary test <code>c432015</code> Modularized WebGL deployment SSH shell scripting <code>68626bb</code> Initial refactoring complete <code>5aa21ce</code> Initial refactored Jenkinsfiles for DLX-PR, Deployment, and Pipeline Code"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-2-detailed-improvements-c5f85e8-432064f","title":"Step 2: Detailed Improvements (<code>c5f85e8</code> ~ <code>432064f</code>)","text":"Commit Work <code>c5f85e8</code> Improved Unity Linting logic <code>ec9a895</code> Improved ShellLibrary.groovy readability <code>7a7f017</code> Fixed Python call <code>00c271e</code> git add <code>7ae76ab</code> Improved catchError function <code>f469267</code> Moved UnityHelper sendTestReport to ShellLibrary <code>3154ca8</code> Added PR_COMMIT for pullrequest event <code>92ee76a</code> Improved stageInitialization readability <code>5e743b4</code> ~ <code>ce227c9</code> Modified ShellScripting logging message <code>432064f</code> Updated stageInitialization logging"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#step-3-ssh-finalization-818100a-02311c4","title":"Step 3: SSH Finalization (<code>818100a</code> ~ <code>02311c4</code>)","text":"Commit Work <code>818100a</code> Changed SSH shellscript type <code>02311c4</code> Added SSH connection check <p>Learning Points: - All pipelines use same Stage modules - Abstract SSH commands into Library</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#36-phase-6-ssh-library-and-deployment-feature-completion","title":"3.6 Phase 6: SSH Library and Deployment Feature Completion","text":"View Details <p>Duration: 2025-05-08 (12 commits)</p> <p>Goal: Complete SSHShellLibrary and stabilize deployment feature</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#problem-solving-process","title":"Problem Solving Process","text":"Commit Attempt Problem Solution <code>7deca3e</code> Fixed SSH command Not working Attempted <code>02f76b7</code> Modularized SSH Connectivity check - Implemented <code>b42f4b8</code> ~ <code>8ff97bc</code> Network connection check, EconestogaDLX connection - Added <code>c4c8da5</code> Added ConnectionAttempts Connection failure Retry logic <code>31950bd</code> ~ <code>7ce9794</code> Added stripIndent for SSH Multiline issue Applied to all SSH scripts <code>1e8e9dc</code> ~ <code>1e94b39</code> Improved logging - Improvement <code>7de89c2</code> Added stripIndent()/trim() to all shellscripts Whitespace issue Batch applied <code>a0e53db</code> ~ <code>a381824</code> Fixed Git library, fixed typo Bug Fixed <p>Learning Points: - stripIndent()/trim() required for SSH commands - Handle retry with ConnectionAttempts for remote server connection</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#37-phase-7-finalization-and-bug-fixes","title":"3.7 Phase 7: Finalization and Bug Fixes","text":"View Details <p>Duration: 2025-05-09 ~ 2025-05-12 (4 commits)</p> <p>Goal: Final bug fixes and cleanup</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#work-by-commit_1","title":"Work by Commit","text":"Commit Work <code>4db95fe</code> Added missing package to Gradle test configuration <code>c54feff</code> Deleted local test run artifact (dump file) <code>10bec90</code> Added Bitbucket API communication error handling <code>ff74ac8</code> Reverted \"Temporary test\" <p>Learning Points: - Test artifacts need to be added to .gitignore - API communication should always include error handling</p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#4-new-stage-files-vars","title":"4. New Stage Files (vars/)","text":"File Lines Purpose stageInitialization.groovy 102 Jenkins environment initialization, environment variable setup stageProjectPrepare.groovy 115 Git clone/checkout, branch synchronization, LFS stageLintGroovyJenkinsfile.groovy 96 Groovy/Jenkinsfile static analysis (npm-groovy-lint) stageLintUnity.groovy 67 Unity C# linting (Rider batch mode) stageStaticAnalysis.groovy 44 SonarQube static code analysis stageUnityExecution.groovy 98 Unity EditMode/PlayMode/Coverage tests stageDeployBuild.groovy 72 WebGL build and deployment stageCleanupPRBranchArtifacts.groovy 55 PR artifact cleanup after merge stageSendBuildResults.groovy 31 Send Bitbucket build status"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#5-new-libraries","title":"5. New Libraries","text":""},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#51-sharedlibrariessrcutilssshshelllibrarygroovy-99-lines","title":"5.1 <code>sharedLibraries/src/utils/SSHShellLibrary.groovy</code> (99 lines)","text":"<p>SSH command library (for WebGL deployment) <pre><code>class SSHShellLibrary {\n    // SSH connection check\n    static Closure CHECK_SSH_CONNECTIVITY = { host, user, keyPath -&gt;\n        \"ssh -o BatchMode=yes -o ConnectTimeout=5 -i ${keyPath} ${user}@${host} 'echo ok'\"\n    }\n\n    // Create remote directory\n    static Closure SSH_CREATE_REMOTE_DIR = { host, user, keyPath, remotePath -&gt;\n        \"ssh -i ${keyPath} ${user}@${host} 'mkdir -p ${remotePath}'\"\n    }\n\n    // SCP file transfer\n    static Closure SCP_COPY_TO_REMOTE = { localPath, host, user, keyPath, remotePath -&gt;\n        \"scp -r -i ${keyPath} ${localPath} ${user}@${host}:${remotePath}\"\n    }\n\n    // Delete remote directory\n    static Closure SSH_REMOVE_REMOTE_DIR = { host, user, keyPath, remotePath -&gt;\n        \"ssh -i ${keyPath} ${user}@${host} 'rm -rf ${remotePath}'\"\n    }\n}\n</code></pre></p>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#6-jenkinsfile-transformation-example","title":"6. Jenkinsfile Transformation Example","text":""},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#61-before-dlxjenkinsjenkinsfile","title":"6.1 Before (DLXJenkins/Jenkinsfile)","text":"<pre><code>pipeline {\n    stages {\n        stage('Prepare WORKSPACE') {\n            steps {\n                script {\n                    // 50 lines of Git checkout logic\n                    // 20 lines of environment variable setup\n                    // 30 lines of error handling\n                }\n            }\n        }\n        stage('Linting') {\n            steps {\n                script {\n                    // 40 lines of linting logic\n                }\n            }\n        }\n        // ... more stages\n    }\n}\n</code></pre>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#62-after-dlxjenkinsjenkinsfile","title":"6.2 After (DLXJenkins/Jenkinsfile)","text":"<pre><code>@Library('global-trusted-shared-library@main') _\n\npipeline {\n    stages {\n        stage('Initialization') {\n            steps {\n                stageInitialization()\n            }\n        }\n        stage('Project Preparation') {\n            steps {\n                stageProjectPrepare()\n            }\n        }\n        stage('Linting') {\n            steps {\n                stageLintUnity()\n            }\n        }\n        stage('EditMode Tests') {\n            steps {\n                stageUnityExecution(testType: 'EditMode')\n            }\n        }\n        stage('PlayMode Tests') {\n            steps {\n                stageUnityExecution(testType: 'PlayMode')\n            }\n        }\n        stage('Build WebGL') {\n            steps {\n                stageDeployBuild(buildType: 'WebGL')\n            }\n        }\n    }\n    post {\n        always {\n            stageSendBuildResults()\n        }\n    }\n}\n</code></pre>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#7-webhook-configuration-improvements","title":"7. Webhook Configuration Improvements","text":""},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#71-pullrequest-vs-repopush-event-separation","title":"7.1 PullRequest vs Repo:Push Event Separation","text":"<pre><code>triggers {\n    GenericTrigger(\n        genericVariables: [\n            [key: 'BITBUCKET_EVENT_KEY', value: '$.headers.x-event-key']\n        ],\n        regexpFilterExpression: '^pullrequest:.*',\n        regexpFilterText: '$BITBUCKET_EVENT_KEY'\n    )\n}\n</code></pre>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#72-dynamic-environment-variable-assignment","title":"7.2 Dynamic Environment Variable Assignment","text":"<pre><code>// PR event\nif (env.BITBUCKET_EVENT_KEY.startsWith('pullrequest:')) {\n    env.PR_BRANCH = env.BITBUCKET_SOURCE_BRANCH\n    env.DESTINATION_BRANCH = env.BITBUCKET_DESTINATION_BRANCH\n}\n// Push event\nelse if (env.BITBUCKET_EVENT_KEY == 'repo:push') {\n    env.PR_BRANCH = env.GIT_BRANCH.replaceFirst('origin/', '')\n    env.DESTINATION_BRANCH = 'main'\n}\n</code></pre>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#8-final-architecture","title":"8. Final Architecture","text":"<pre><code>devops-jenkins-linux/\n\u251c\u2500\u2500 */Jenkinsfile                          # Layer 1: Entry Point\n\u2502   \u251c\u2500\u2500 DLXJenkins/Jenkinsfile\n\u2502   \u251c\u2500\u2500 DLXJenkins/JenkinsfileDeployment\n\u2502   \u251c\u2500\u2500 JsJenkins/Jenkinsfile\n\u2502   \u251c\u2500\u2500 JsJenkins/JenkinsfileDeployment\n\u2502   \u2514\u2500\u2500 PipelineForJenkins/Jenkinsfile\n\u2502\n\u2514\u2500\u2500 sharedLibraries/\n    \u251c\u2500\u2500 vars/                              # Layer 2: Orchestration\n    \u2502   \u251c\u2500\u2500 stageInitialization.groovy     # Stage Modules\n    \u2502   \u251c\u2500\u2500 stageProjectPrepare.groovy\n    \u2502   \u251c\u2500\u2500 stageLintGroovyJenkinsfile.groovy\n    \u2502   \u251c\u2500\u2500 stageLintUnity.groovy\n    \u2502   \u251c\u2500\u2500 stageStaticAnalysis.groovy\n    \u2502   \u251c\u2500\u2500 stageUnityExecution.groovy\n    \u2502   \u251c\u2500\u2500 stageDeployBuild.groovy\n    \u2502   \u251c\u2500\u2500 stageCleanupPRBranchArtifacts.groovy\n    \u2502   \u251c\u2500\u2500 stageSendBuildResults.groovy\n    \u2502   \u251c\u2500\u2500 shellScriptHelper.groovy       # Helpers\n    \u2502   \u251c\u2500\u2500 bitbucketApiHelper.groovy\n    \u2502   \u2514\u2500\u2500 logger.groovy                  # Cross-Cutting\n    \u2502\n    \u2514\u2500\u2500 src/\n        \u251c\u2500\u2500 service/                       # Layer 3: Services\n        \u2502   \u2514\u2500\u2500 general/\n        \u2502       \u2514\u2500\u2500 BitbucketApiService.groovy\n        \u2502\n        \u251c\u2500\u2500 utils/                         # Layer 4: Utilities\n        \u2502   \u251c\u2500\u2500 GitLibrary.groovy\n        \u2502   \u251c\u2500\u2500 ShellLibrary.groovy\n        \u2502   \u2514\u2500\u2500 SSHShellLibrary.groovy\n        \u2502\n        \u2514\u2500\u2500 resource/                      # Layer 4: Utilities (Constants)\n            \u2514\u2500\u2500 Status.groovy\n</code></pre>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#9-benefits","title":"9. Benefits","text":""},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#91-code-reuse","title":"9.1 Code Reuse","text":"<ul> <li>5 pipelines use same Stage files</li> <li>Duplicate code removed</li> </ul>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#92-easy-maintenance","title":"9.2 Easy Maintenance","text":"<ul> <li>Modify only one file when changing Stage logic</li> <li>Jenkinsfile only defines pipeline structure</li> </ul>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#93-improved-readability","title":"9.3 Improved Readability","text":"<ul> <li>Jenkinsfile reads like a table of contents</li> <li>Clear role for each Stage</li> </ul>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#94-testability","title":"9.4 Testability","text":"<ul> <li>Each Stage file can be tested independently</li> <li>Library functions can be unit tested</li> </ul>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#95-consistent-logging","title":"9.5 Consistent Logging","text":"<ul> <li>All Stages use logger</li> <li>Standardized output format</li> </ul>"},{"location":"problem-solving/phase-4-full-pipeline-refactoring-and-stage-modularization/changelog/#10-conclusion","title":"10. Conclusion","text":"<p>5 monolithic pipelines \u2192 4-Layer Architecture + Centralized Library</p> <ul> <li>Jenkinsfile code volume reduced by approximately 70-78%</li> <li>12 reusable Stage modules created</li> <li>3 Shell libraries (Git, Shell, SSH)</li> <li>1 API service (Bitbucket)</li> <li>3-Level Logger standard interface</li> </ul>"}]}